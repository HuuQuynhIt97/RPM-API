!function(){function e(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,n=l(e);if(t){var o=l(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return a(this,i)}}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=r(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){c=!0,l=e},f:function(){try{o||null==i.return||i.return()}finally{if(c)throw l}}}}function r(e,t){if(e){if("string"==typeof e)return c(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,i){return t&&u(e.prototype,t),i&&u(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{F7Yq:function(i,a,l){"use strict";l.r(a),l.d(a,"HttpLoaderFactory",function(){return la}),l.d(a,"EstablishModule",function(){return ca});var r=l("xxV/"),c=l("SVse"),u=l("s7LF"),h=l("7g+E"),g=l("wTG2"),m=l("PDtH"),f=l("G0yt"),b=l("wpBH"),p=l("WWtw"),v=l("sWsm"),D=l("10VE"),I=l("Uc7L"),y=l("IheW"),C=l("TSSN"),N=l("k5Gf"),S=l("e7Im"),w=l("KeVr"),k=l("emFE"),P=l("4SUy"),B=l("BrIm"),A=l("4DqM"),x=l("pQl/"),U=l("OoJn"),E=l("bwdU"),V=l("iInd"),F=l("vpVc"),M=l("KCoQ"),L=l("qLS9"),G=l("HJFG"),T=l("h9f+"),O=l("AytR"),j=l("t0UR"),J=l("8Y7J"),R=l("vrRs"),K=l("H552"),Q=l("2zK7"),H=l("2Vo4"),_=l("lJxs");new y.e({Authorization:"Bearer "+localStorage.getItem("token")});var W,q,z,X,Y=((W=function(){function e(t){s(this,e),this.http=t,this.baseUrl=O.a.apiUrlEC,this.gueIngredientSource=new H.a({}),this.currentGlueIngredient=this.gueIngredientSource.asObservable(),this.flagSource=new H.a("0"),this.currentFlag=this.flagSource.asObservable()}return d(e,[{key:"getIngredients",value:function(e,t,i){var n=new Q.a;return this.http.get("".concat(this.baseUrl,"GlueIngredient/GetIngredientsByGlueID/").concat(e),{observe:"response"}).pipe(Object(_.a)(function(e){return n.result=e.body,null!=e.headers.get("Pagination")&&(n.pagination=JSON.parse(e.headers.get("Pagination"))),n}))}},{key:"getGlues",value:function(e,t){var i=new Q.a;return this.http.get("".concat(this.baseUrl,"GlueIngredient/getAllGlues/").concat(e,"/").concat(t),{observe:"response"}).pipe(Object(_.a)(function(e){return i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i}))}},{key:"mappGlueIngredient",value:function(e){return this.http.post("".concat(this.baseUrl,"GlueIngredient/MapGlueIngredient"),e)}},{key:"mapGlueIngredientByGlueID",value:function(e){return this.http.post("".concat(this.baseUrl,"GlueIngredient/MapGlueIngredientByGlueID"),e)}},{key:"mapGlueIngredient",value:function(e){return this.http.post("".concat(this.baseUrl,"GlueIngredient/MapGlueIngredients"),e)}},{key:"delete",value:function(e,t){return this.http.get("".concat(this.baseUrl,"GlueIngredient/").concat(e,"/").concat(t,"/delete"))}},{key:"editPercentage",value:function(e){return this.http.put("".concat(this.baseUrl,"GlueIngredient/editPercentage"),e)}},{key:"editAllow",value:function(e){return this.http.put("".concat(this.baseUrl,"GlueIngredient/editAllow"),e)}},{key:"getDetail",value:function(e){return this.http.get(this.baseUrl+"GlueIngredient/".concat(e,"/detail"))}}]),e}()).\u0275fac=function(e){return new(e||W)(J.cc(y.b))},W.\u0275prov=J.Lb({token:W,factory:W.\u0275fac,providedIn:"root"}),W),Z=l("xiVD"),ee=((q=function(){function e(t){s(this,e),this.http=t,this.baseUrl=O.a.apiUrlEC}return d(e,[{key:"getArticleNos",value:function(e,t){var i=new Q.a,n=new y.f;return null!=e&&null!=t&&(n=(n=n.append("pageNumber",e)).append("pageSize",t)),this.http.get(this.baseUrl+"ArticleNo/getArticleNos",{observe:"response",params:n}).pipe(Object(_.a)(function(e){return i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i}))}},{key:"getAlls",value:function(){return this.http.get(this.baseUrl+"ArticleNo/GetAll",{})}},{key:"getArticleNoByModelNameID",value:function(e){return this.http.get(this.baseUrl+"ArticleNo/getArticleNoByModelNameID/"+e,{})}},{key:"getArticleNoByModelNoID",value:function(e){return this.http.get(this.baseUrl+"ArticleNo/getArticleNoByModelNoID/"+e,{})}},{key:"create",value:function(e){return this.http.post(this.baseUrl+"ArticleNo/create",e)}},{key:"update",value:function(e){return this.http.put(this.baseUrl+"ArticleNo/update",e)}},{key:"delete",value:function(e){return this.http.delete(this.baseUrl+"ArticleNo/delete/"+e)}}]),e}()).\u0275fac=function(e){return new(e||q)(J.cc(y.b))},q.\u0275prov=J.Lb({token:q,factory:q.\u0275fac,providedIn:"root"}),q),te=l("j7qE"),ie=((X=function(){function e(t){s(this,e),this.http=t,this.baseUrl=O.a.apiUrlEC}return d(e,[{key:"getAll",value:function(){return this.http.get(this.baseUrl+"ModelNo/GetAll",{})}},{key:"getModelNoByModelNameID",value:function(e){return this.http.get(this.baseUrl+"ModelNo/getModelNoByModelNameID/"+e,{})}}]),e}()).\u0275fac=function(e){return new(e||X)(J.cc(y.b))},X.\u0275prov=J.Lb({token:X,factory:X.\u0275fac,providedIn:"root"}),X),ne=((z=function(){function e(t){s(this,e),this.http=t,this.baseUrl=O.a.apiUrlEC}return d(e,[{key:"getAll",value:function(){return this.http.get(this.baseUrl+"ArtProcess/GetAll",{})}},{key:"getArtProcessByArticleNoID",value:function(e){return this.http.get(this.baseUrl+"ArtProcess/getArtProcessByArticleNoID/"+e,{})}},{key:"GetAllProcess",value:function(){return this.http.get(this.baseUrl+"Process/GetAll",{})}}]),e}()).\u0275fac=function(e){return new(e||z)(J.cc(y.b))},z.\u0275prov=J.Lb({token:z,factory:z.\u0275fac,providedIn:"root"}),z),ae=l("CC+3"),le=l("MBJp"),oe=l("6U7I"),re=l("WAEy"),ce=["switch"],se=["grid"],ue=["gridglue"],de=["grid2"],he=["modelNameDropdownlist"],ge=["modelNoDropdownlist"],me=["chemicalDropdownlist"],fe=["positionDropdownlist"];function be(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",11),J.Vb(1,"button",25),J.fc("click",function(){J.Ec(i);var e=J.jc(),t=J.Bc(48);return e.openModal(t)}),J.Qb(2,"i",26),J.Ub(),J.Ub()}}function pe(e,t){if(1&e){var i=J.Wb();J.Tb(0),J.Vb(1,"ejs-radiobutton",27),J.fc("click",function(e){return J.Ec(i),J.jc().onClickProcess(e)}),J.Ub(),J.Sb()}if(2&e){var n=t.$implicit;J.Cb(1),J.pc("label",n.name)("value",n.id)}}function ve(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"GLUE")," ")}function De(e,t){if(1&e&&(J.Vb(0,"div",40),J.Lc(1),J.Ub()),2&e){var i=t.$implicit;J.qc("title",i.name),J.Cb(1),J.Nc(" ",i.name," ")}}function Ie(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"CONSUMPTION")," ")}function ye(e,t){if(1&e&&(J.Vb(0,"span"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changeConsumptionColor(i)),J.Cb(1),J.Mc(""===i.consumption?"0":i.consumption)}}function Ce(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"EXPIRED_TIME")," ")}function Ne(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"KIND")," ")}function Se(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",41,42),J.fc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangeKindEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.kinds)("ngModel",n.kindName)("fields",a.fieldsKindEdit)("allowFiltering",!0)}}function we(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"PART")," ")}function ke(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",43,44),J.fc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangePartEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.parts)("ngModel",n.partName)("fields",a.fieldsPartEdit)("allowFiltering",!0)}}function Pe(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"MATERIAL")," ")}function Be(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",43,44),J.fc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangeMaterialEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.materials)("ngModel",n.materialName)("fields",a.fieldsMaterialEdit)("allowFiltering",!0)}}function Ae(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",28),J.Vb(1,"ejs-grid",29,30),J.fc("rowDeselected",function(e){return J.Ec(i),J.jc().rowDeselected(e)})("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginGlue(e)})("rowSelected",function(e){return J.Ec(i),J.jc().rowSelected(e)})("created",function(){return J.Ec(i),J.jc().onCreatedGridGlue()})("toolbarClick",function(e){return J.Ec(i),J.jc().toolbarClick(e)})("dataBound",function(){return J.Ec(i),J.jc().dataBoundGlue()}),J.Vb(3,"e-columns"),J.Vb(4,"e-column",31),J.Jc(5,ve,2,3,"ng-template",null,32,J.Kc),J.Jc(7,De,2,2,"ng-template",null,33,J.Kc),J.Ub(),J.Vb(9,"e-column",34),J.Jc(10,Ie,2,3,"ng-template",null,32,J.Kc),J.Jc(12,ye,2,3,"ng-template",null,33,J.Kc),J.Ub(),J.Vb(14,"e-column",35),J.Jc(15,Ce,2,3,"ng-template",null,32,J.Kc),J.Ub(),J.Vb(17,"e-column",36),J.Jc(18,Ne,2,3,"ng-template",null,32,J.Kc),J.Jc(20,Se,2,4,"ng-template",null,37,J.Kc),J.Ub(),J.Vb(22,"e-column",38),J.Jc(23,we,2,3,"ng-template",null,32,J.Kc),J.Jc(25,ke,2,4,"ng-template",null,37,J.Kc),J.Ub(),J.Vb(27,"e-column",39),J.Jc(28,Pe,2,3,"ng-template",null,32,J.Kc),J.Jc(30,Be,2,4,"ng-template",null,37,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(1),J.pc("dataSource",n.glues)("editSettings",n.editSettings)("toolbar",n.toolbar)("allowSorting",!0)("selectedRowIndex",n.rowIndex)}}function xe(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-switch",52,53),J.fc("click",function(){return J.Ec(i),J.jc(2).done()})("ngModelChange",function(e){return J.Ec(i),J.jc(2).createdStatus=e}),J.kc(2,"translate"),J.kc(3,"translate"),J.Ub()}if(2&e){var n=J.jc(2);J.qc("onLabel",J.lc(2,5,"DONE")),J.qc("offLabel",J.lc(3,7,"UNDONE")),J.pc("disabled",n.approvalStatus)("ngModel",n.createdStatus)("checked",n.createdStatus)}}function Ue(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-switch",55),J.fc("click",function(){return J.Ec(i),J.jc(3).approval()})("ngModelChange",function(e){return J.Ec(i),J.jc(3).approvalStatus=e}),J.kc(1,"translate"),J.Ub()}if(2&e){var n=J.jc(3);J.qc("offLabel",J.lc(1,3,"NOT_APPROVED")),J.pc("ngModel",n.approvalStatus)("checked",n.approvalStatus)}}function Ee(e,t){if(1&e&&(J.Tb(0),J.Jc(1,Ue,2,5,"ejs-switch",54),J.Sb()),2&e){var i=J.jc(2);J.Cb(1),J.pc("ngIf",i.modelNameID>0)}}function Ve(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",56),J.fc("click",function(){return J.Ec(i),J.jc(2).finished()}),J.Qb(1,"i",57),J.Lc(2),J.kc(3,"translate"),J.Ub()}2&e&&(J.Cb(2),J.Nc(" ",J.lc(3,1,"FINISHED")," "))}function Fe(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",58),J.fc("click",function(){J.Ec(i);var e=J.jc(2),t=J.Bc(50);return e.openModalHistory(t)}),J.Qb(1,"i",59),J.Lc(2," History"),J.Ub()}}function Me(e,t){if(1&e&&(J.Vb(0,"div",45),J.Vb(1,"button",46),J.Qb(2,"i",47),J.Lc(3," Reset "),J.Ub(),J.Jc(4,xe,4,9,"ejs-switch",48),J.Jc(5,Ee,2,1,"ng-container",49),J.Jc(6,Ve,4,3,"button",50),J.Jc(7,Fe,3,0,"button",51),J.Ub()),2&e){var i=J.jc();J.Cb(4),J.pc("ngIf",i.modelNameID>0),J.Cb(1),J.pc("ngIf",3!==i.level&&4!==i.level),J.Cb(1),J.pc("ngIf",i.modelNameID>0),J.Cb(1),J.pc("ngIf",i.modelNameID>0)}}function Le(e,t){if(1&e&&(J.Vb(0,"li",76),J.Vb(1,"a"),J.Lc(2),J.Vb(3,"span",77),J.Lc(4),J.Ub(),J.Ub(),J.Ub()),2&e){var i=t.$implicit;J.Cb(2),J.Oc(" ",i.position,". ",i.ingredientName," "),J.Cb(2),J.Nc("(",i.percentage,"%)")}}function Ge(e,t){if(1&e&&(J.Vb(0,"ul"),J.Vb(1,"span",73),J.Lc(2),J.Ub(),J.Vb(3,"li",74),J.Lc(4),J.Vb(5,"ul"),J.Jc(6,Le,5,3,"li",75),J.Ub(),J.Ub(),J.Ub()),2&e){var i=J.jc(2);J.Cb(2),J.Mc(i.formulaTamp()),J.Cb(2),J.Nc(" ",i.formula()," "),J.Cb(2),J.pc("ngForOf",i.renderchemical())}}function Te(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",78),J.fc("click",function(){J.Ec(i);var e=t.$implicit;return J.jc(2).sortBySup(e.id)}),J.Qb(1,"i",79),J.Lc(2),J.Ub()}if(2&e){var n=t.$implicit;J.Cb(2),J.Nc(" ",n.name," ")}}function Oe(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"ITEM")," ")}function je(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",80,81),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(2).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function Je(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",80,81),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(2).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function Re(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"INGREDIENT_NAME")," ")}function Ke(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function $e(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function Qe(e,t){if(1&e&&(J.Vb(0,"div"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changePercentageColor(i)),J.Cb(1),J.Mc(i.percentage)}}function He(e,t){1&e&&(J.Vb(0,"div"),J.Qb(1,"i",82),J.Ub())}function _e(e,t){if(1&e&&(J.Vb(0,"div"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changeAllowColor(i)),J.Cb(1),J.Nc("\xb1 ",i.allow,"")}}function We(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"ITEM")," ")}function qe(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",80,81),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(2).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function ze(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",80,81),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(2).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function Xe(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"INGREDIENT_NAME")," ")}function Ye(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function Ze(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function et(e,t){1&e&&(J.Vb(0,"div"),J.Qb(1,"i",82),J.Ub())}function tt(e,t){if(1&e&&(J.Vb(0,"div"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changeAllowColor(i)),J.Cb(1),J.Nc("\xb1 ",i.allow,"")}}function it(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",60),J.Jc(1,Ge,7,3,"ul",49),J.Vb(2,"div",0),J.Vb(3,"div",61),J.Vb(4,"button",62),J.fc("click",function(){return J.Ec(i),J.jc().sortBySup(0)}),J.Lc(5),J.kc(6,"translate"),J.Ub(),J.Jc(7,Te,3,1,"button",63),J.Ub(),J.Ub(),J.Vb(8,"div",0),J.Vb(9,"div",64),J.Vb(10,"div",15),J.Vb(11,"div",28),J.Vb(12,"ejs-grid",65,66),J.fc("actionComplete",function(e){return J.Ec(i),J.jc().actionCompleteIngredient(e)})("recordDoubleClick",function(e){return J.Ec(i),J.jc().onDoubleClickIngredient(e)})("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginIngredient(e)})("toolbarClick",function(e){return J.Ec(i),J.jc().toolbarClickIngredient(e)})("rowSelected",function(e){return J.Ec(i),J.jc().rowSelectedIngredient(e)}),J.Vb(14,"e-columns"),J.Vb(15,"e-column",67),J.Jc(16,Oe,2,3,"ng-template",null,32,J.Kc),J.Jc(18,je,2,4,"ng-template",null,33,J.Kc),J.Jc(20,Je,2,4,"ng-template",null,37,J.Kc),J.Ub(),J.Vb(22,"e-column",68),J.Jc(23,Re,2,3,"ng-template",null,32,J.Kc),J.Jc(25,Ke,1,1,"ng-template",null,37,J.Kc),J.Jc(27,$e,1,1,"ng-template",null,33,J.Kc),J.Ub(),J.Vb(29,"e-column",69),J.Jc(30,Qe,2,3,"ng-template",null,33,J.Kc),J.Ub(),J.Vb(32,"e-column",70),J.Jc(33,He,2,0,"ng-template",null,32,J.Kc),J.Jc(35,_e,2,3,"ng-template",null,33,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(37,"div",64),J.Vb(38,"div",15),J.Vb(39,"div",28),J.Vb(40,"ejs-grid",71,72),J.fc("actionComplete",function(e){return J.Ec(i),J.jc().actionCompleteIngredient(e)})("recordDoubleClick",function(e){return J.Ec(i),J.jc().onDoubleClickIngredient(e)})("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginIngredient(e)})("toolbarClick",function(e){return J.Ec(i),J.jc().toolbarClickIngredient(e)})("rowSelected",function(e){return J.Ec(i),J.jc().rowSelectedIngredient(e)}),J.Vb(42,"e-columns"),J.Vb(43,"e-column",67),J.Jc(44,We,2,3,"ng-template",null,32,J.Kc),J.Jc(46,qe,2,4,"ng-template",null,33,J.Kc),J.Jc(48,ze,2,4,"ng-template",null,37,J.Kc),J.Ub(),J.Vb(50,"e-column",68),J.Jc(51,Xe,2,3,"ng-template",null,32,J.Kc),J.Jc(53,Ye,1,1,"ng-template",null,37,J.Kc),J.Jc(55,Ze,1,1,"ng-template",null,33,J.Kc),J.Ub(),J.Qb(57,"e-column",69),J.Vb(58,"e-column",70),J.Jc(59,et,2,0,"ng-template",null,32,J.Kc),J.Jc(61,tt,2,3,"ng-template",null,33,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(1),J.pc("ngIf",n.renderchemical().length>0),J.Cb(4),J.Nc(" ",J.lc(6,12,"DEFAULT")," "),J.Cb(2),J.pc("ngForOf",n.supplier),J.Cb(5),J.pc("dataSource",n.ingredients1)("allowSorting",!0)("allowSorting",!0)("editSettings",n.editSettings)("toolbar",n.toolbarOptions2),J.Cb(28),J.pc("dataSource",n.ingredients2)("allowSorting",!0)("editSettings",n.editSettings)("toolbar",n.toolbarOptions2)}}function nt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",83),J.Vb(1,"h4",84),J.Qb(2,"i",85),J.Lc(3," Clone Article "),J.Ub(),J.Vb(4,"button",86),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",87),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",88),J.Vb(8,"div",0),J.Vb(9,"div",89),J.Vb(10,"div",90),J.Vb(11,"label",91),J.Lc(12,"Article Name"),J.Ub(),J.Vb(13,"span",92),J.Lc(14,"(*)"),J.Ub(),J.Vb(15,"input",93),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc().articleName=e}),J.Ub(),J.Ub(),J.Ub(),J.Vb(16,"div",89),J.Vb(17,"div",90),J.Vb(18,"label",91),J.Lc(19,"Process"),J.Ub(),J.Vb(20,"ejs-dropdownlist",94,95),J.fc("change",function(e){return J.Ec(i),J.jc().onChangeProcessCloneModal(e)}),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(22,"div",96),J.Vb(23,"button",97),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(24,"Close"),J.Ub(),J.Vb(25,"button",98),J.fc("click",function(){return J.Ec(i),J.jc().cloneArticleModelname()}),J.Lc(26,"Clone"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(15),J.pc("ngModel",n.articleName),J.Cb(5),J.pc("value",n.valueProcess)("dataSource",n.processData)("allowFiltering",!0)("fields",n.processfields)}}function at(e,t){if(1&e){var i=J.Wb();J.Tb(0),J.Vb(1,"ejs-radiobutton",102),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc(2).artProcessIDClone=e}),J.Ub(),J.Sb()}if(2&e){var n=t.$implicit,a=J.jc(2);J.Cb(1),J.pc("label",n.name)("value",n.id)("ngModel",a.artProcessIDClone)}}function lt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",83),J.Vb(1,"h4",84),J.Qb(2,"i",85),J.Lc(3," Clone BPFC "),J.Ub(),J.Vb(4,"button",86),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",87),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",88),J.Vb(8,"div",0),J.Vb(9,"div",89),J.Vb(10,"div",90),J.Vb(11,"label",91),J.Lc(12,"Model Name"),J.Ub(),J.Vb(13,"span",92),J.Lc(14,"(*)"),J.Ub(),J.Vb(15,"ejs-dropdownlist",99,7),J.fc("open",function(){return J.Ec(i),J.jc().openPopupDropdownlist()})("filtering",function(e){return J.Ec(i),J.jc().onFilteringModelNameClone(e)})("select",function(e){return J.Ec(i),J.jc().onChangeModelNameClone(e)}),J.Ub(),J.Lc(17),J.Ub(),J.Ub(),J.Vb(18,"div",89),J.Vb(19,"div",90),J.Vb(20,"label",91),J.Lc(21,"Model NO"),J.Ub(),J.Vb(22,"span",92),J.Lc(23,"(*)"),J.Ub(),J.Vb(24,"ejs-dropdownlist",100,10),J.fc("dataBound",function(e){return J.Ec(i),J.jc().OndataBound(e)})("filtering",function(e){return J.Ec(i),J.jc().onFilteringModelNOClone(e)})("select",function(e){return J.Ec(i),J.jc().onChangeModelNoClone(e)}),J.Ub(),J.Lc(26),J.Ub(),J.Ub(),J.Vb(27,"div",89),J.Vb(28,"div",90),J.Vb(29,"label",91),J.Lc(30,"Article NO"),J.Ub(),J.Vb(31,"span",92),J.Lc(32,"(*)"),J.Ub(),J.Vb(33,"ejs-dropdownlist",101,7),J.fc("filtering",function(e){return J.Ec(i),J.jc().onFilteringArticleNOClone(e)})("ngModelChange",function(e){return J.Ec(i),J.jc().articleNOIDClone=e})("select",function(e){return J.Ec(i),J.jc().onChangeArticleNoClone(e)}),J.Ub(),J.Lc(35),J.Ub(),J.Ub(),J.Vb(36,"div",89),J.Vb(37,"div",90),J.Vb(38,"label",91),J.Lc(39,"Process"),J.Ub(),J.Vb(40,"span",92),J.Lc(41,"(*)"),J.Ub(),J.Vb(42,"div",13),J.Jc(43,at,2,3,"ng-container",14),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(44,"div",96),J.Vb(45,"button",97),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(46,"Close"),J.Ub(),J.Vb(47,"button",98),J.fc("click",function(){return J.Ec(i),J.jc().onClickClone()}),J.Lc(48,"Clone"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(15),J.pc("dataSource",n.modelNameDataClone)("fields",n.fieldsBPFCs)("allowFiltering",!0)("value",n.value),J.Cb(2),J.Nc(" ",n.modelNameIDClone," "),J.Cb(7),J.pc("dataSource",n.modelNOsDataClone)("fields",n.fieldsBPFCs)("allowFiltering",!0)("value",n.valuemodelNo),J.Cb(2),J.Nc(" ",n.modelNOIDClone," "),J.Cb(7),J.pc("dataSource",n.articleNosDataClone)("fields",n.fieldsBPFCs)("allowFiltering",!0)("ngModel",n.articleNOIDClone),J.Cb(2),J.Nc(" ",n.articleNOIDClone," "),J.Cb(8),J.pc("ngForOf",n.artProcessDataClone2)}}function ot(e,t){1&e&&(J.Lc(0),J.kc(1,"date")),2&e&&J.Nc(" ",J.mc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function rt(e,t){if(1&e&&(J.Tb(0),J.Qb(1,"input",115),J.Sb()),2&e){var i=J.jc().$implicit;J.Cb(1),J.pc("value",i.remark)}}function ct(e,t){if(1&e&&J.Qb(0,"input",116),2&e){var i=J.jc().$implicit;J.pc("value",i.remark)}}function st(e,t){if(1&e&&(J.Vb(0,"span",112),J.Jc(1,rt,2,1,"ng-container",113),J.Jc(2,ct,1,1,"ng-template",null,114,J.Kc),J.Ub()),2&e){var i=t.$implicit,n=J.Bc(3);J.pc("ngClass","Improve"==i.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),J.Cb(1),J.pc("ngIf","Improve"==i.action)("ngIfElse",n)}}function ut(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",83),J.Vb(1,"h4",84),J.Qb(2,"i",85),J.Lc(3," BPFC History "),J.Ub(),J.Vb(4,"button",86),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",87),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",88),J.Vb(8,"ejs-grid",103,104),J.fc("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginHistory(e)}),J.Vb(10,"e-columns"),J.Vb(11,"e-column",105),J.Jc(12,ot,2,4,"ng-template",null,33,J.Kc),J.Ub(),J.Qb(14,"e-column",106),J.Qb(15,"e-column",107),J.Qb(16,"e-column",108),J.Vb(17,"e-column",109),J.Jc(18,st,4,3,"ng-template",null,37,J.Kc),J.Ub(),J.Qb(20,"e-column",110),J.Ub(),J.Ub(),J.Ub(),J.Vb(21,"div",96),J.Vb(22,"button",111),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(23,"Close"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(8),J.pc("dataSource",n.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",n.editSettingsHis)("toolbar",n.toolbarOptionsHistory),J.Cb(9),J.pc("edit",n.editparamsHis)}}var dt,ht=((dt=function(){function e(t,i,n,a,l,o,r,c,u,d,h,g,m,f,b,p){var v=this;s(this,e),this.glueIngredientService=t,this.modalNameService=i,this.glueService=n,this.alertify=a,this.modalService=l,this.route=o,this.authService=r,this.bPFCEstablishService=c,this.modelNoService=u,this.articleNoService=d,this.kindService=h,this.partService=g,this.materialService=m,this.buildingUserService=f,this.artProcessService=b,this.ingredientService=p,this.data=[],this.modelNameData=[],this.modelNoData=[],this.positions=["B","C","D","E"],this.articleNoData=[],this.modelNameClone=[],this.modelNoClone=[],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={},this.ingredient={},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.ingredients1=[],this.ingredients2=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search","Add","Delete","Cancel"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.onFiltering=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(v.modelNameData,t)},this.onFilteringModelName=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(v.modelNameData,t)},this.onFilteringModelNO=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(v.modelNoData,t)},this.onFilteringArticleNO=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(v.articleNoData,t)},this.onFilteringModelNameClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(v.modelNameData,t)},this.onFilteringModelNOClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(v.modelNoData,t)},this.onFilteringArticleNOClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(v.articleNoData,t)},this.onFilteringArtProcessClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(v.artProcessDataClone,t)}}return d(e,[{key:"ngOnInit",value:function(){var e=this;this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(function(t){200===t&&e.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}},{key:"onChangeProcessCloneModal",value:function(e){e.itemData&&(this.processID=e.itemData.id)}},{key:"resetLifeCycleBPFC",value:function(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}},{key:"onCreatedGridGlue",value:function(){}},{key:"ngAfterViewInit",value:function(){$('[data-toggle="tooltip"]').tooltip();var e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}},{key:"onChangeKindEdit",value:function(e){this.kindEdit=e.value,this.kindID=e.itemData.id}},{key:"onChangePartEdit",value:function(e){this.partEdit=e.value,this.partID=e.itemData.id}},{key:"onChangeMaterialEdit",value:function(e){this.kindEdit=e.value,this.materialID=e.itemData.id}},{key:"dataBoundGlue",value:function(){$('[data-toggle="tooltip"]').tooltip(),this.selectedRow.length?(this.gridglue.selectRows(this.selectedRow),this.selectedRow=[]):this.gridglue.selectRows(this.selIndex)}},{key:"actionBeginGlue",value:function(e){var t=this;"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":"Consumption ".concat(e.rowData.consumption),this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After="Consumption ".concat(e.data.consumption),this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){t.getBPFCID({modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID})}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){t.glueService.delete(e.data[0].id).subscribe(function(){t.getAllGluesByBPFCID(t.BPFCID),t.detailGlue=!1,t.removeLocalStore("details"),t.glueIngredientDetail=[],t.oldDetail=[],t.grid.refresh(),t.grid2.refresh(),t.alertify.success("Glue has been deleted")},function(e){t.alertify.error("Failed to delete the Glue")})}))}},{key:"rowDeselected",value:function(e){var t=this,i=e.rowIndex,n=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,n)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(function(e){if(t.modified=!0,t.gridglue.getSelectedRowIndexes().length){var n=t.gridglue.dataSource[i];n.name=n.chemical.name,t.gridglue.refresh()}}).catch(function(e){t.gridglue.selectRows([i])})}},{key:"rowSelected",value:function(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);var t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}},{key:"onChangePosition",value:function(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;var n=e.value,a=this.getLocalStore("details");if(""===e.value);else{if(0!==a.length){var l="";switch(a[a.length-1].position){case"A":l="B";break;case"B":l="C";break;case"C":l="D";break;case"D":l="E"}if(n!==l)return this.alertify.warning("H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 ".concat(l),!0),this.grid.refresh(),this.grid2.refresh(),void(e.cancel=!0)}if(0===a.filter(function(t){return t.position===e.value}).length&&null!==e.value)if(a=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==a.filter(function(e){return e.ingredientName===t.name&&e.position===t.position}).length){var o=a.findIndex(function(e){return e.ingredientName===t.name});a[o].position=e.value,this.setLocalStore("details",a),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.refresh()}else{a=this.getLocalStore("details");var r={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(r.percentage=100,r.expiredTime=t.expiredTime),a.push(r),this.setLocalStore("details",a),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.refresh()}}}},{key:"recordDoubleClick",value:function(e){this.modifiedGlue=!0}},{key:"toolbarClickIngredient",value:function(e){switch(e.item.text){case"Add":e.cancel=!0,this.openIngredientModalComponent()}}},{key:"onDoubleClickIngredient",value:function(e){this.setFocus=e.column}},{key:"rowSelectedIngredient",value:function(e){this.ingridientID=e.data.id}},{key:"genaratorGlueCode",value:function(){this.glue.code=this.makeid(8)}},{key:"makeid",value:function(e){for(var t="",i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length,a=0;a<e;a++)t+=i.charAt(Math.floor(Math.random()*n));return t}},{key:"compareArray",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"setLocalStore",value:function(e,t){localStorage.removeItem(e);var i=JSON.stringify(t);localStorage.setItem(e,i)}},{key:"getLocalStore",value:function(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}},{key:"removeLocalStore",value:function(e){localStorage.removeItem(e)}},{key:"dynamicSort",value:function(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(i,n){return-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}}},{key:"checkColorCode",value:function(e){return!0===e.approvalStatus&&!0===e.finishedStatus}},{key:"checkDone",value:function(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}},{key:"checkStatus",value:function(e,t){return!0===e&&!0===t?"Done":"Undone"}},{key:"renderchemical",value:function(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}},{key:"makeFormula",value:function(){var e,t,i=this.getLocalStore("details").filter(function(e){return"A"===e.position})||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(function(e){return e.percentage}),this.percentageCountEdit=this.glueIngredientDetail.map(function(e){return e}),this.totalPercentage=this.percentageCount.reduce(function(e,t){return e+t},0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);var n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}},{key:"formula",value:function(){return this.B&&this.C&&this.D&&this.E?"{[ (".concat(this.nameGlue,"+ ").concat(this.B,") + ").concat(this.C," ] + ").concat(this.D,"}+ ").concat(this.E):this.B&&this.C&&this.D?"[(".concat(this.nameGlue," + ").concat(this.B,") + ").concat(this.C,"] + ").concat(this.D):this.B&&this.C?"(".concat(this.nameGlue," + ").concat(this.B,") + ").concat(this.C):this.B?"".concat(this.nameGlue," + ").concat(this.B):"".concat(this.nameGlue)}},{key:"formulaTamp",value:function(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName="{[ (".concat(this.nameGlues,"+ ").concat(this.BB,") + ").concat(this.CC," ] + ").concat(this.DD,"}+ ").concat(this.EE),"{[ (".concat(this.nameGlues,"+ ").concat(this.BB,") + ").concat(this.CC," ] + ").concat(this.DD,"}+ ").concat(this.EE)):this.BB&&this.CC&&this.DD?(this.glueNewName="[(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC,"] + ").concat(this.DD),"[(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC,"] + ").concat(this.DD)):this.BB&&this.CC?(this.glueNewName="(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC),"(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC)):this.BB?(this.glueNewName="".concat(this.nameGlues," + ").concat(this.BB),"".concat(this.nameGlues," + ").concat(this.BB)):"".concat(this.nameGlues)}},{key:"getDetail",value:function(e){var t=this;this.glueIngredientService.getDetail(e).subscribe(function(e){var i,n,a,l;t.glueIngredientDetail=e.glueIngredients,t.setLocalStore("details",t.glueIngredientDetail),t.setLocalStore("detailsTamp",t.glueIngredientDetail),t.glueIngredientDetail=t.renderchemical(),t.oldDetail=t.renderchemical();var o=t.glueIngredientDetail.filter(function(e){return"A"===e.position})||[];t.nameGlue=(null===(i=o[0])||void 0===i?void 0:i.ingredientName)||"",t.nameGlues=(null===(n=o[0])||void 0===n?void 0:n.ingredientName)+"^"+(null===(a=t.glueIngredientDetail[0])||void 0===a?void 0:a.allow)+"%"||!1,t.A=(null===(l=o[0])||void 0===l?void 0:l.ingredientName)||"",void 0===t.glueIngredientDetail[1]?t.B="":(t.B=t.glueIngredientDetail[1].percentage+"%"+t.glueIngredientDetail[1].ingredientName,t.BB=t.glueIngredientDetail[1].percentage+"%"+t.glueIngredientDetail[1].ingredientName+"^"+t.glueIngredientDetail[1].allow+"%"),void 0===t.glueIngredientDetail[2]?t.C="":(t.C=t.glueIngredientDetail[2].percentage+"%"+t.glueIngredientDetail[2].ingredientName,t.CC=t.glueIngredientDetail[2].percentage+"%"+t.glueIngredientDetail[2].ingredientName+"^"+t.glueIngredientDetail[2].allow+"%"),void 0===t.glueIngredientDetail[3]?t.D="":(t.D=t.glueIngredientDetail[3].percentage+"%"+t.glueIngredientDetail[3].ingredientName,t.DD=t.glueIngredientDetail[3].percentage+"%"+t.glueIngredientDetail[3].ingredientName+"^"+t.glueIngredientDetail[3].allow+"%"),void 0===t.glueIngredientDetail[4]?t.E="":(t.E=t.glueIngredientDetail[4].percentage+"%"+t.glueIngredientDetail[4].ingredientName,t.EE=t.glueIngredientDetail[4].percentage+"%"+t.glueIngredientDetail[4].ingredientName+"^"+t.glueIngredientDetail[4].allow+"%"),t.glueIngredientDetail.length>0?(t.percentageCount=t.glueIngredientDetail.map(function(e){return e.percentage}),t.percentageCount.join("+"),t.percentageCountEdit=t.glueIngredientDetail.map(function(e){return e}),t.totalPercentage=t.percentageCount.reduce(function(e,t){return e+t},0)):(t.percentageCount=[],t.percentageCountEdit=[],t.totalPercentage=0)})}},{key:"updateChemicalList",value:function(){var e,t=this,i=this.getLocalStore("details"),n=o(i);try{var a=function(){var i=e.value,n=t.ingredients1.findIndex(function(e){return e.name===i.ingredientName&&e.id===i.ingredientID});-1!==n&&(t.ingredients1[n].position=i.position,t.ingredients1[n].percentage=i.percentage,t.ingredients1[n].allow=i.allow)};for(n.s();!(e=n.n()).done;)a()}catch(s){n.e(s)}finally{n.f()}var l,r=o(i);try{var c=function(){var e=l.value,i=t.ingredients2.findIndex(function(t){return t.name===e.ingredientName&&t.id===e.ingredientID});-1!==i&&(t.ingredients2[i].position=e.position,t.ingredients2[i].percentage=e.percentage,t.ingredients2[i].allow=e.allow)};for(r.s();!(l=r.n()).done;)c()}catch(s){r.e(s)}finally{r.f()}}},{key:"actionBeginIngredient",value:function(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;var t=Number(this.percentageDefault)!==Number(this.percentageChange),i=Number(this.allowDefault)!==Number(this.allowChange);if(t){this.modified=!1;var n=this.getLocalStore("details"),a=n.findIndex(function(t){return t.ingredientName===e.data.name&&t.ingredientID===e.data.id});n[a].percentage=e.data.percentage,this.setLocalStore("details",n),this.updateChemicals()}if(i){var l=this.getLocalStore("details"),o=l.findIndex(function(t){return t.ingredientName===e.data.name&&t.ingredientID===e.data.id});l[o].allow=e.data.allow,this.setLocalStore("details",l),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicals()}}"delete"===e.requestType&&this.deleteIngredient()}},{key:"updateGlueIngredient",value:function(){}},{key:"loadPreview",value:function(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}},{key:"resolver",value:function(){var e=this;this.route.data.subscribe(function(t){e.glues=t.glues.result,e.paginationG=t.glues.pagination})}},{key:"onService",value:function(){var e=this;this.ingredientService.currentIngredient.subscribe(function(t){300===t&&(e.getIngredients(),e.updateChemicalList(),e.ingredientService.changeIngredient(0))})}},{key:"mapGlue",value:function(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}},{key:"getIngredients",value:function(){var e=this;this.glueIngredientService.getIngredients(this.glueid).subscribe(function(t){e.ingredients1=t.result.list1,e.ingredients2=t.result.list2},function(t){e.alertify.error(t)})}},{key:"getGlues",value:function(){var e=this;this.glueService.getAllGlue().subscribe(function(t){e.glues=t},function(t){e.alertify.error(t)})}},{key:"mapGlueIngredients",value:function(e){var t=this;this.glueIngredientService.mapGlueIngredient(e).subscribe(function(e){void 0===t.subID?(t.sortBySup(0),t.getDetail(t.glueid)):(t.sortBySup(t.subID),t.getDetail(t.glueid))})}},{key:"mapGlueIngredient",value:function(e){var t=this;this.glueIngredientService.mappGlueIngredient(e).subscribe(function(e){void 0===t.subID?(t.getAllGluesByBPFCID(t.BPFCID),t.sortBySup(0),t.getDetail(t.glueid)):(t.sortBySup(t.subID),t.getDetail(t.glueid),t.getAllGluesByBPFCID(t.BPFCID))})}},{key:"mapGlueIngredientByGlueID",value:function(e){var t=this;this.glueIngredientService.mapGlueIngredientByGlueID(e).subscribe(function(e){t.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),t.getAllGluesByBPFCID(t.BPFCID),t.detailGlue=!0,t.modified=!0,t.modified=!0,void 0===t.subID?(t.sortBySup(0),t.getDetail(t.glueid)):(t.sortBySup(t.subID),t.getDetail(t.glueid))})}},{key:"openIngredientModalComponent",value:function(){var e=this.modalService.open(re.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(function(e){},function(e){})}},{key:"actionCompleteIngredient",value:function(e){"beginEdit"===e.requestType&&"Item"!==this.setFocus.field&&(e.form.elements.namedItem(this.setFocus.field).focus(),e.form.elements.namedItem(this.setFocus.field).value="")}},{key:"openPopupDropdownlist",value:function(){$('[data-toggle="tooltip"]').tooltip()}},{key:"toolbarClick",value:function(e){var t=this;switch(e.item.text){case"Add New":var i=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,i)&&i.length>0&&this.oldDetail.length>0?this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(function(e){t.glue.id=0,t.glue.name="1",t.glue.BPFCEstablishID=t.BPFCID,t.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,t.saveGlue()}).catch(function(t){e.cancel=!0}):(this.glue.id=0,this.glue.name="1",this.glue.BPFCEstablishID=this.BPFCID,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.saveGlue())}}},{key:"openModal",value:function(e){this.getModelNamesClone(),this.getAllProcess(),this.modalReference=this.modalService.open(e)}},{key:"openModalHistory",value:function(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}},{key:"LoadHistoryBPFC",value:function(){var e=this;this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(function(t){e.historyData=t.map(function(t){return{id:t.id,glueID:t.glueID,createdTime:t.createdTime,bpfcEstablishID:t.bpfcEstablishID,before:t.before,after:t.after,action:t.action,remark:t.remark,userID:t.userID,createdBy:e.createdBy(t.userID)}})})}},{key:"actionBeginHistory",value:function(e){var t=this;"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(function(e){e&&t.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}},{key:"getAllUsers",value:function(){var e=this;this.buildingUserService.getAllUsers(1,1e3).subscribe(function(t){e.userData=t.result})}},{key:"createdBy",value:function(e){if(0===e)return"#N/A";var t=this.userData.filter(function(t){return t.ID===e})[0];return void 0!==t?t.Username:"#N/A"}},{key:"cloneModelname",value:function(){var e=this;this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",function(){e.modalNameService.cloneModelname(e.modelNameID,e.modelNameClone,e.modelNoClone,e.valueProcess).subscribe(function(t){e.alertify.success("the model name has been cloned"),e.modalReference.close(),e.modelNameDropdownlist.hidePopup()})})}},{key:"cloneArticleModelname",value:function(){var e=this;this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",function(){e.modalNameService.cloneArticleModelname(e.modelNameID,e.modelNameClone,e.modelNoClone,e.articleName,e.processID).subscribe(function(t){e.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),e.modalReference.close(),e.modelNameDropdownlist.hidePopup()})})}},{key:"delete",value:function(e,t){var i=this;this.glueIngredientService.delete(e,t).subscribe(function(t){i.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),i.getIngredients(),i.getDetail(e)})}},{key:"deleteGlue",value:function(e){var t=this;this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',function(){t.glueService.delete(e.id).subscribe(function(){t.getGlues(),t.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(e){t.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}},{key:"deleteIngridient",value:function(e){var t=this;this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',function(){t.ingredientService.delete(e.id).subscribe(function(){t.getIngredients(),t.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(e){t.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}},{key:"getAllGluesByBPFCID",value:function(e){var t=this;this.glueService.getAllGluesByBPFCID(e).subscribe(function(e){t.glues=e})}},{key:"getAllGluesByBPFCID2",value:function(e){var t=this;this.glueService.getAllGluesByBPFCID(e).subscribe(function(e){void 0===t.ingredientID?(t.glues=e,e.length>0&&(t.detailGlue=!0)):(t.glueid=e[0].id,t.glueIngredient2.ingredientID=t.ingredientID,t.glueIngredient2.percentage=100,t.glueIngredient2.glueID=t.glueid,t.glueIngredient2.position="A",t.mapGlueIngredient(t.glueIngredient2))})}},{key:"updateChemicals",value:function(){var e=this;this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(function(t){e.ingredients1=t.list1,e.ingredients2=t.list2;var i,n=e.getLocalStore("details"),a=o(n);try{var l=function(){var t=i.value,n=e.ingredients1.findIndex(function(e){return e.name===t.ingredientName&&e.id===t.ingredientID});-1!==n&&(e.ingredients1[n].position=t.position,e.ingredients1[n].percentage=t.percentage,e.ingredients1[n].allow=t.allow)};for(a.s();!(i=a.n()).done;)l()}catch(u){a.e(u)}finally{a.f()}var r,c=o(n);try{var s=function(){var t=r.value,i=e.ingredients2.findIndex(function(e){return e.name===t.ingredientName&&e.id===t.ingredientID});-1!==i&&(e.ingredients2[i].position=t.position,e.ingredients2[i].percentage=t.percentage,e.ingredients2[i].allow=t.allow)};for(c.s();!(r=c.n()).done;)s()}catch(u){c.e(u)}finally{c.f()}e.glueIngredientDetail=n,e.makeFormula()})}},{key:"sortBySup",value:function(e){var t=this;0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(function(i){if(t.ingredients1=i.list1,t.ingredients2=i.list2,0===e){var n=t.getLocalStore("details");t.ingredients1=n.map(function(e){return{id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,glueTypeID:0,cbd:e.cbd,replacementFrequency:0,prepareTime:0,partNO:"",standardCycle:0}}),t.glueIngredientDetail=n}else t.updateChemicalList()}))}},{key:"saveGlue",value:function(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}},{key:"getBuilding",value:function(){JSON.parse(localStorage.getItem("user"))}},{key:"getAllIngredient",value:function(){var e=this;this.ingredientService.getAllIngredient().subscribe(function(t){e.ingrediented=t})}},{key:"createGlue",value:function(){var e=this;this.glueService.create(this.glue).subscribe(function(){e.alertify.success("Add successfully!<br>\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.clearGlueForm(),e.genaratorGlueCode(),e.expiredTime=0},function(t){e.alertify.error(t),e.genaratorGlueCode()})}},{key:"finished",value:function(){var e=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=e,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){});var t=this.getLocalStore("details"),i=this.gridglue.getSelectedRecords()[0];i.expiredTime=t.filter(function(e){return"A"===e.position})[0].expiredTime,i.kindID=0===i.kindID?null:i.kindID,i.partID=0===i.partID?null:i.partID,i.materialID=0===i.materialID?null:i.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),t.length>0&&this.mapGlueIngredientByGlueID({glueName:i.name,glueID:i.id,glueIngredientForMapDto:t})}}},{key:"clearGlueForm",value:function(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}},{key:"update",value:function(){var e=this;this.glueService.update(this.glue).subscribe(function(t){e.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.detailGlue=!1,e.history.Action="Created",e.expiredTime=0})}},{key:"updateChemical",value:function(){var e=this;this.glueService.updateChemical(this.glue).subscribe(function(t){e.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.detailGlue=!1,e.onChangeChemical=!1,e.history.Action="Created"})}},{key:"deleteIngredient",value:function(){var e=this;this.ingredientService.delete(this.ingridientID).subscribe(function(){var t=e.getLocalStore("details").filter(function(t){return t.ingredientID!==e.ingridientID});e.setLocalStore("details",t),e.glueIngredientDetail=t,e.getIngredients(),e.makeFormula(),e.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(t){e.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}},{key:"approval",value:function(){var e=this,t=this.gridglue.dataSource;if(t){var i,n=o(t);try{for(n.s();!(i=n.n()).done;){var a=i.value;if("STF"===this.artProcess&&null===a.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.approvalStatus=!this.approvalStatus);if(a.glueIngredients.length>0){var l,r=o(a.glueIngredients.filter(function(e){return"A"!==e.position}));try{for(r.s();!(l=r.n()).done;){var c=l.value;if(c.allow<=0&&"A"!==c.position)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The allowance of checmical name ".concat(c.ingredient.name," must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ").concat(c.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(a.name," <br>\n              "),!0);if(c.percentage<=0&&"A"!==c.position)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The percentage of checmical name ".concat(c.ingredient.name," must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ").concat(c.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(a.name," <br>\n              "),!0)}}catch(u){r.e(u)}finally{r.f()}}if(+a.consumption<=0)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The consumption of glue name ".concat(a.name," must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ").concat(a.name," ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ").concat(a.name," <br>\n          "),!0)}}catch(u){n.e(u)}finally{n.f()}var s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(function(t){e.alertify.success("The BPFC has been approved!"),e.createdStatus=e.approvalStatus;var i=e.modelNameDropdownlist.getDataByValue(e.modelNameDropdownlist.value);e.modelNameDropdownlist.valueTemplate="(".concat(e.checkStatus(e.approvalStatus,e.createdStatus),") ").concat(i.name)})}}},{key:"done",value:function(){var e=this,t=this.gridglue.dataSource,i=!1,n=!1,a=!1;if(t){var l,r=o(t);try{for(r.s();!(l=r.n()).done;){var c=l.value;if("STF"===this.artProcess&&null===c.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.createdStatus=!this.createdStatus);if(c.glueIngredients.length>0){var s,u=c.glueIngredients.filter(function(e){return"A"!==e.position}),d=o(u);try{for(d.s();!(s=d.n()).done;){var h=s.value;if(h.allow<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The allow of checmical name ".concat(h.ingredient.name," is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ").concat(h.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(c.name," <br>\n              "),!0);if(h.percentage<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The percentage of checmical name ".concat(h.ingredient.name," is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ").concat(h.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(c.name," <br>\n              "),!0);i=!0,n=!0}}catch(m){d.e(m)}finally{d.f()}0===u.length&&(i=!0,n=!0)}if(c.consumption<=0)return a=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The consumption of glue name ".concat(c.name," is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ").concat(c.name," ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ").concat(c.name," <br>\n          "),!0);a=!0}}catch(m){r.e(m)}finally{r.f()}if(i&&n&&a){var g=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,g).subscribe(function(t){!0===t.status?(e.alertify.success(t.message),e.createdStatus=e.createdStatus):e.alertify.success(t.message)})}}}},{key:"getModelNames",value:function(){var e=this;this.modalNameService.getAllModalName().subscribe(function(t){e.modelNameData=t.map(function(e){return{id:e.id,name:e.name}})})}},{key:"getArticleNoByModelNameID",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNoData=e})}},{key:"getModelNoByModelNameID",value:function(e){var t=this;this.modelNoService.getModelNoByModelNameID(e).subscribe(function(e){t.modelNoData=e})}},{key:"getArtProcessByArticleNoID",value:function(e){var t=this;this.artProcessService.getArtProcessByArticleNoID(e).subscribe(function(e){t.artProcessData=e.map(function(e){return{id:e.id,name:1===e.processID?"ASY":"STF"}})})}},{key:"getAllProcess",value:function(){var e=this;this.artProcessService.GetAllProcess().subscribe(function(t){e.artProcessDataClone2=t})}},{key:"getAllKind",value:function(){var e=this;this.kindService.getAllKind().subscribe(function(t){e.kinds=t})}},{key:"getAllPart",value:function(){var e=this;this.partService.getAllPart().subscribe(function(t){e.parts=t})}},{key:"getAllMaterial",value:function(){var e=this;this.materialService.getAllMaterial().subscribe(function(t){e.materials=t})}},{key:"getIngredientsByGlueID",value:function(){var e=this;this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(function(t){e.ingredients1=t.list1,e.ingredients2=t.list2})}},{key:"getAllSupllier",value:function(){var e=this;this.ingredientService.getAllSupplier().subscribe(function(t){e.supplier=t})}},{key:"getArticleNoByModelNoID",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNosData=e})}},{key:"getBPFCID",value:function(e){var t=this;this.bPFCEstablishService.getBPFCID(e).subscribe(function(e){t.resetLifeCycleBPFC(),t.BPFCID=null==e?void 0:e.id,t.approvalStatus=e.approvalStatus,t.createdStatus=e.finishedStatus,t.artProcess=e.artProcess,t.glue.BPFCEstablishID=t.BPFCID,t.getAllGluesByBPFCID(t.BPFCID),t.getAllPart(),t.getAllKind(),t.getAllMaterial(),t.getAllIngredient(),t.existGlue=!0,t.modified=!0})}},{key:"OndataBound",value:function(e){this.modelNoDropdownlist.value=this.value}},{key:"getModelNamesClone",value:function(){var e=this;this.modalNameService.getAllModalName().subscribe(function(t){e.modelNameDataClone=t.map(function(e){return{id:e.id,name:e.name}}),e.getModelNoByModelNameIDClone(e.modelNameIDClone),e.articleNosDataClone=[],e.artProcessDataClone=[]})}},{key:"getArticleNoByModelNameIDClone",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNosDataClone=e})}},{key:"getModelNoByModelNameIDClone",value:function(e){var t=this;this.modelNoService.getModelNoByModelNameID(e||0).subscribe(function(e){t.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}},{key:"getArtProcessByArticleNoIDClone",value:function(e){var t=this;this.artProcessService.getArtProcessByArticleNoID(e).subscribe(function(e){t.artProcessDataClone=e.map(function(e){return{id:e.id,name:1===e.ProcessID?"ASY":"STF"}})})}},{key:"clone",value:function(e){var t=this;this.modalNameService.clone(e).subscribe(function(e){!0===e.status?(t.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),t.modalService.dismissAll(),t.getArtProcessByArticleNoID(t.articleNoID),t.clearFormClone()):t.alertify.error(e.message)})}},{key:"onChangeModelName",value:function(e){this.resetLifeCycleBPFC(),this.modelNameID=e.itemData.id,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}},{key:"onChangeModelNo",value:function(e){e.isInteracted&&(this.modelNoID=e.itemData.id,this.valuemodelNo=e.itemData.id,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}},{key:"onChangeArticleNo",value:function(e){e.isInteracted&&(this.articleNoID=e.itemData.id,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}},{key:"onClickProcess",value:function(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue),this.getBPFCID({modelNameID:this.modelNameID,modelNoID:this.modelNoID,articleNoID:this.articleNoID,artProcessID:this.artProcessID}))}},{key:"ClickProcessData",value:function(e){}},{key:"clearFormClone",value:function(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}},{key:"onClickClone",value:function(){var e={modelNameID:this.modelNameIDClone,modelNOID:this.modelNOIDClone,articleNOID:this.articleNOIDClone,artProcessID:Number(this.artProcessIDClone),bpfcID:this.BPFCID,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}},{key:"onChangeModelNameClone",value:function(e){this.value!==e.itemData.id&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.itemData.id,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.itemData.id,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}},{key:"onChangeModelNoClone",value:function(e){this.modelNOIDClone=e.itemData.id,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}},{key:"onChangeArticleNoClone",value:function(e){e.isInteracted&&(this.articleNOIDClone=e.itemData.id,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}},{key:"onChangeProcessClone",value:function(e){e.isInteracted&&(this.artProcessIDClone=e.itemData.id)}},{key:"changeAllowColor",value:function(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}},{key:"changePercentageColor",value:function(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}},{key:"changeConsumptionColor",value:function(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}]),e}()).\u0275fac=function(e){return new(e||dt)(J.Pb(Y),J.Pb(L.a),J.Pb(Z.a),J.Pb(G.a),J.Pb(f.b),J.Pb(V.a),J.Pb(te.a),J.Pb(j.a),J.Pb(ie),J.Pb(ee),J.Pb(ae.a),J.Pb(le.a),J.Pb(oe.a),J.Pb(T.a),J.Pb(ne),J.Pb(R.a))},dt.\u0275cmp=J.Jb({type:dt,selectors:[["app-glue-ingredient"]],viewQuery:function(e,t){var i;1&e&&(J.Rc(ce,1),J.Rc(se,1),J.Rc(ue,1),J.Rc(de,1),J.Rc(he,1),J.Rc(ge,1),J.Rc(me,1),J.Rc(fe,1)),2&e&&(J.Ac(i=J.gc())&&(t.switch=i.first),J.Ac(i=J.gc())&&(t.grid=i.first),J.Ac(i=J.gc())&&(t.gridglue=i.first),J.Ac(i=J.gc())&&(t.grid2=i.first),J.Ac(i=J.gc())&&(t.modelNameDropdownlist=i.first),J.Ac(i=J.gc())&&(t.modelNoDropdownlist=i.first),J.Ac(i=J.gc())&&(t.chemicalDropdownlist=i.first),J.Ac(i=J.gc())&&(t.positionDropdownlist=i))},features:[J.Bb([k.n,k.f,k.k])],decls:51,vars:20,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["placeholder","Select a Model Name",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],["modelNameDropdownlist",""],["class","col-md-1 mt-2",4,"ngIf"],["placeholder","Select a Model NO",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],["modelNoDropdownlist",""],[1,"col-md-1","mt-2"],["placeholder","Select article NO   ",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],[1,"col-md-9","mt-2"],[4,"ngFor","ngForOf"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],[1,"card-title"],["class","card-tools",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["cloneModal",""],["HistoryModal",""],["ejs-button","","cssClass","e-info",1,"float-right","ml-1",3,"click"],[1,"fa","fa-clone"],["name","process",3,"label","value","click"],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["kindDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],[1,"card-tools"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],["style","width: 100px; margin-right: 10px;",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click",4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click",4,"ngIf"],[2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange"],["switch",""],["onLabel","Approved","style","width: 120px;",3,"offLabel","ngModel","checked","click","ngModelChange",4,"ngIf"],["onLabel","Approved",2,"width","120px",3,"offLabel","ngModel","checked","click","ngModelChange"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","btn-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],["height","675px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid2",""],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["placeholder","Select a Model Name",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","value","open","filtering","select"],["placeholder","Select a Model NO",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","value","dataBound","filtering","select"],["placeholder","Select article NO   ",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","filtering","ngModelChange","select"],["name","process2",3,"label","value","ngModel","ngModelChange"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"]],template:function(e,t){1&e&&(J.Vb(0,"div",0),J.Vb(1,"div",1),J.Vb(2,"div",2),J.Vb(3,"div",3),J.Vb(4,"div",0),J.Vb(5,"div",4),J.Vb(6,"label"),J.Lc(7,"Model Name: "),J.Ub(),J.Ub(),J.Vb(8,"div",5),J.Vb(9,"ejs-dropdownlist",6,7),J.fc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.modelNameID=e})("filtering",function(e){return t.onFilteringModelName(e)})("select",function(e){return t.onChangeModelName(e)}),J.Ub(),J.Ub(),J.Jc(11,be,3,0,"div",8),J.Ub(),J.Vb(12,"div",0),J.Vb(13,"div",4),J.Vb(14,"label"),J.Lc(15,"Model NO: "),J.Ub(),J.Ub(),J.Vb(16,"div",5),J.Vb(17,"ejs-dropdownlist",9,10),J.fc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.modelNoID=e})("filtering",function(e){return t.onFilteringModelNO(e)})("select",function(e){return t.onChangeModelNo(e)}),J.Ub(),J.Ub(),J.Qb(19,"div",11),J.Ub(),J.Vb(20,"div",0),J.Vb(21,"div",4),J.Vb(22,"label"),J.Lc(23,"Article NO: "),J.Ub(),J.Ub(),J.Vb(24,"div",5),J.Vb(25,"ejs-dropdownlist",12,7),J.fc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.articleNoID=e})("filtering",function(e){return t.onFilteringArticleNO(e)})("select",function(e){return t.onChangeArticleNo(e)}),J.Ub(),J.Ub(),J.Qb(27,"div",11),J.Ub(),J.Vb(28,"div",0),J.Vb(29,"div",4),J.Vb(30,"label"),J.Lc(31,"Process: "),J.Ub(),J.Ub(),J.Vb(32,"div",13),J.Jc(33,pe,2,2,"ng-container",14),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(34,"div",2),J.Vb(35,"div",15),J.Jc(36,Ae,32,5,"div",16),J.Ub(),J.Ub(),J.Ub(),J.Vb(37,"div",17),J.Vb(38,"div",2),J.Vb(39,"div",18),J.Vb(40,"h3",19),J.Lc(41),J.kc(42,"translate"),J.Ub(),J.Jc(43,Me,8,4,"div",20),J.Ub(),J.Jc(44,it,63,14,"div",21),J.Ub(),J.Ub(),J.Jc(45,nt,27,5,"ng-template",null,22,J.Kc),J.Jc(47,lt,49,16,"ng-template",null,23,J.Kc),J.Jc(49,ut,24,6,"ng-template",null,24,J.Kc),J.Ub()),2&e&&(J.Cb(9),J.pc("dataSource",t.modelNameData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.modelNameID),J.Cb(2),J.pc("ngIf",t.modelNameSelect&&t.modelNoSelect&&t.modelArtSelect&&t.modelProcessSelect),J.Cb(6),J.pc("dataSource",t.modelNoData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.modelNoID),J.Cb(8),J.pc("dataSource",t.articleNosData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.articleNoID),J.Cb(8),J.pc("ngForOf",t.artProcessData),J.Cb(3),J.pc("ngIf",t.existGlue),J.Cb(5),J.Nc("",J.lc(42,18,"PREVIEW")," "),J.Cb(2),J.pc("ngIf",t.existGlue),J.Cb(1),J.pc("ngIf",t.existGlue))},directives:[m.c,u.f,u.i,c.n,c.m,v.b,v.h,k.j,p.d,A.d,A.b,k.e,k.b,p.c,A.c,A.a,k.d,k.a,v.k,u.a,c.l],pipes:[C.c,c.e],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{animation:warning-frames .5s infinite;color:#000}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),dt),gt=["switch"],mt=["grid"],ft=["gridglue"],bt=["grid2"],pt=["modelNameDropdownlist"],vt=["modelNoDropdownlist"],Dt=["chemicalDropdownlist"],It=["positionDropdownlist"];function yt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"GLUE")," ")}function Ct(e,t){if(1&e&&(J.Vb(0,"div",31),J.Lc(1),J.Ub()),2&e){var i=t.$implicit;J.qc("title",i.name),J.Cb(1),J.Nc(" ",i.name," ")}}function Nt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"CONSUMPTION")," ")}function St(e,t){if(1&e&&(J.Vb(0,"span"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changeConsumptionColor(i)),J.Cb(1),J.Mc(""===i.consumption?"0":i.consumption)}}function wt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"EXPIRED_TIME")," ")}function kt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"KIND")," ")}function Pt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",32,33),J.fc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangeKindEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.kinds)("ngModel",n.kindName)("fields",a.fieldsKindEdit)("allowFiltering",!0)}}function Bt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"PART")," ")}function At(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",34,33),J.fc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangePartEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.parts)("ngModel",n.partName)("fields",a.fieldsPartEdit)("allowFiltering",!0)}}function xt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"MATERIAL")," ")}function Ut(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",34,33),J.fc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangeMaterialEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.materials)("ngModel",n.materialName)("fields",a.fieldsMaterialEdit)("allowFiltering",!0)}}function Et(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",19),J.Vb(1,"ejs-grid",20,21),J.fc("rowDeselected",function(e){return J.Ec(i),J.jc().rowDeselected(e)})("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginGlue(e)})("rowSelected",function(e){return J.Ec(i),J.jc().rowSelected(e)})("created",function(){return J.Ec(i),J.jc().onCreatedGridGlue()})("toolbarClick",function(e){return J.Ec(i),J.jc().toolbarClick(e)})("dataBound",function(){return J.Ec(i),J.jc().dataBoundGlue()}),J.Vb(3,"e-columns"),J.Vb(4,"e-column",22),J.Jc(5,yt,2,3,"ng-template",null,23,J.Kc),J.Jc(7,Ct,2,2,"ng-template",null,24,J.Kc),J.Ub(),J.Vb(9,"e-column",25),J.Jc(10,Nt,2,3,"ng-template",null,23,J.Kc),J.Jc(12,St,2,3,"ng-template",null,24,J.Kc),J.Ub(),J.Vb(14,"e-column",26),J.Jc(15,wt,2,3,"ng-template",null,23,J.Kc),J.Ub(),J.Vb(17,"e-column",27),J.Jc(18,kt,2,3,"ng-template",null,23,J.Kc),J.Jc(20,Pt,2,4,"ng-template",null,28,J.Kc),J.Ub(),J.Vb(22,"e-column",29),J.Jc(23,Bt,2,3,"ng-template",null,23,J.Kc),J.Jc(25,At,2,4,"ng-template",null,28,J.Kc),J.Ub(),J.Vb(27,"e-column",30),J.Jc(28,xt,2,3,"ng-template",null,23,J.Kc),J.Jc(30,Ut,2,4,"ng-template",null,28,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(1),J.pc("dataSource",n.glues)("editSettings",n.editSettings)("toolbar",n.toolbar)("allowSorting",!0)("selectedRowIndex",n.rowIndex)}}function Vt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-switch",42,43),J.fc("click",function(){return J.Ec(i),J.jc(2).done()})("ngModelChange",function(e){return J.Ec(i),J.jc(2).createdStatus=e}),J.kc(2,"translate"),J.kc(3,"translate"),J.Ub()}if(2&e){var n=J.jc(2);J.qc("onLabel",J.lc(2,5,"DONE")),J.qc("offLabel",J.lc(3,7,"UNDONE")),J.pc("disabled",n.approvalStatus)("ngModel",n.createdStatus)("checked",n.createdStatus)}}function Ft(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-switch",45),J.fc("click",function(){return J.Ec(i),J.jc(3).approval()})("ngModelChange",function(e){return J.Ec(i),J.jc(3).approvalStatus=e}),J.kc(1,"translate"),J.Ub()}if(2&e){var n=J.jc(3);J.qc("offLabel",J.lc(1,3,"NOT_APPROVED")),J.pc("ngModel",n.approvalStatus)("checked",n.approvalStatus)}}function Mt(e,t){if(1&e&&(J.Tb(0),J.Jc(1,Ft,2,5,"ejs-switch",44),J.Sb()),2&e){var i=J.jc(2);J.Cb(1),J.pc("ngIf",i.modelNameID>0)}}function Lt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",46),J.fc("click",function(){return J.Ec(i),J.jc(2).finished()}),J.Qb(1,"i",47),J.Lc(2),J.kc(3,"translate"),J.Ub()}2&e&&(J.Cb(2),J.Nc(" ",J.lc(3,1,"FINISHED")," "))}function Gt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",48),J.fc("click",function(){J.Ec(i);var e=J.jc(2),t=J.Bc(45);return e.openModalHistory(t)}),J.Qb(1,"i",49),J.Lc(2," History"),J.Ub()}}function Tt(e,t){if(1&e&&(J.Vb(0,"div",35),J.Vb(1,"button",36),J.Qb(2,"i",37),J.Lc(3," Reset "),J.Ub(),J.Jc(4,Vt,4,9,"ejs-switch",38),J.Jc(5,Mt,2,1,"ng-container",39),J.Jc(6,Lt,4,3,"button",40),J.Jc(7,Gt,3,0,"button",41),J.Ub()),2&e){var i=J.jc();J.Cb(4),J.pc("ngIf",i.modelNameID>0),J.Cb(1),J.pc("ngIf",3!==i.level&&4!==i.level),J.Cb(1),J.pc("ngIf",i.modelNameID>0),J.Cb(1),J.pc("ngIf",i.modelNameID>0)}}function Ot(e,t){if(1&e&&(J.Vb(0,"li",66),J.Vb(1,"a"),J.Lc(2),J.Vb(3,"span",67),J.Lc(4),J.Ub(),J.Ub(),J.Ub()),2&e){var i=t.$implicit;J.Cb(2),J.Oc(" ",i.position,". ",i.ingredientName," "),J.Cb(2),J.Nc("(",i.percentage,"%)")}}function jt(e,t){if(1&e&&(J.Vb(0,"ul"),J.Vb(1,"span",63),J.Lc(2),J.Ub(),J.Vb(3,"li",64),J.Lc(4),J.Vb(5,"ul"),J.Jc(6,Ot,5,3,"li",65),J.Ub(),J.Ub(),J.Ub()),2&e){var i=J.jc(2);J.Cb(2),J.Mc(i.formulaTamp()),J.Cb(2),J.Nc(" ",i.formula()," "),J.Cb(2),J.pc("ngForOf",i.renderchemical())}}function Jt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",68),J.fc("click",function(){J.Ec(i);var e=t.$implicit;return J.jc(2).sortBySup(e.id)}),J.Qb(1,"i",69),J.Lc(2),J.Ub()}if(2&e){var n=t.$implicit;J.Cb(2),J.Nc(" ",n.name," ")}}function Rt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"ITEM")," ")}function Kt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",70,71),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(2).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function $t(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",70,71),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(2).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function Qt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"INGREDIENT_NAME")," ")}function Ht(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function _t(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function Wt(e,t){if(1&e&&(J.Vb(0,"div"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changePercentageColor(i)),J.Cb(1),J.Mc(i.percentage)}}function qt(e,t){1&e&&(J.Vb(0,"div"),J.Qb(1,"i",72),J.Ub())}function zt(e,t){if(1&e&&(J.Vb(0,"div"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changeAllowColor(i)),J.Cb(1),J.Nc("\xb1 ",i.allow,"")}}function Xt(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"ITEM")," ")}function Yt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",70,71),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(2).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function Zt(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",70,71),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(2).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function ei(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"INGREDIENT_NAME")," ")}function ti(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function ii(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function ni(e,t){1&e&&(J.Vb(0,"div"),J.Qb(1,"i",72),J.Ub())}function ai(e,t){if(1&e&&(J.Vb(0,"div"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changeAllowColor(i)),J.Cb(1),J.Nc("\xb1 ",i.allow,"")}}function li(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",50),J.Jc(1,jt,7,3,"ul",39),J.Vb(2,"div",0),J.Vb(3,"div",51),J.Vb(4,"button",52),J.fc("click",function(){return J.Ec(i),J.jc().sortBySup(0)}),J.Lc(5),J.kc(6,"translate"),J.Ub(),J.Jc(7,Jt,3,1,"button",53),J.Ub(),J.Ub(),J.Vb(8,"div",0),J.Vb(9,"div",54),J.Vb(10,"div",9),J.Vb(11,"div",19),J.Vb(12,"ejs-grid",55,56),J.fc("actionComplete",function(e){return J.Ec(i),J.jc().actionCompleteIngredient(e)})("recordDoubleClick",function(e){return J.Ec(i),J.jc().onDoubleClickIngredient(e)})("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginIngredient(e)})("toolbarClick",function(e){return J.Ec(i),J.jc().toolbarClickIngredient(e)})("rowSelected",function(e){return J.Ec(i),J.jc().rowSelectedIngredient(e)}),J.Vb(14,"e-columns"),J.Vb(15,"e-column",57),J.Jc(16,Rt,2,3,"ng-template",null,23,J.Kc),J.Jc(18,Kt,2,4,"ng-template",null,24,J.Kc),J.Jc(20,$t,2,4,"ng-template",null,28,J.Kc),J.Ub(),J.Vb(22,"e-column",58),J.Jc(23,Qt,2,3,"ng-template",null,23,J.Kc),J.Jc(25,Ht,1,1,"ng-template",null,28,J.Kc),J.Jc(27,_t,1,1,"ng-template",null,24,J.Kc),J.Ub(),J.Vb(29,"e-column",59),J.Jc(30,Wt,2,3,"ng-template",null,24,J.Kc),J.Ub(),J.Vb(32,"e-column",60),J.Jc(33,qt,2,0,"ng-template",null,23,J.Kc),J.Jc(35,zt,2,3,"ng-template",null,24,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(37,"div",54),J.Vb(38,"div",9),J.Vb(39,"div",19),J.Vb(40,"ejs-grid",61,62),J.fc("actionComplete",function(e){return J.Ec(i),J.jc().actionCompleteIngredient(e)})("recordDoubleClick",function(e){return J.Ec(i),J.jc().onDoubleClickIngredient(e)})("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginIngredient(e)})("toolbarClick",function(e){return J.Ec(i),J.jc().toolbarClickIngredient(e)})("rowSelected",function(e){return J.Ec(i),J.jc().rowSelectedIngredient(e)}),J.Vb(42,"e-columns"),J.Vb(43,"e-column",57),J.Jc(44,Xt,2,3,"ng-template",null,23,J.Kc),J.Jc(46,Yt,2,4,"ng-template",null,24,J.Kc),J.Jc(48,Zt,2,4,"ng-template",null,28,J.Kc),J.Ub(),J.Vb(50,"e-column",58),J.Jc(51,ei,2,3,"ng-template",null,23,J.Kc),J.Jc(53,ti,1,1,"ng-template",null,28,J.Kc),J.Jc(55,ii,1,1,"ng-template",null,24,J.Kc),J.Ub(),J.Qb(57,"e-column",59),J.Vb(58,"e-column",60),J.Jc(59,ni,2,0,"ng-template",null,23,J.Kc),J.Jc(61,ai,2,3,"ng-template",null,24,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(1),J.pc("ngIf",n.renderchemical().length>0),J.Cb(4),J.Nc(" ",J.lc(6,12,"DEFAULT")," "),J.Cb(2),J.pc("ngForOf",n.supplier),J.Cb(5),J.pc("dataSource",n.ingredients1)("allowSorting",!0)("allowSorting",!0)("editSettings",n.editSettings)("toolbar",n.toolbarOptions2),J.Cb(28),J.pc("dataSource",n.ingredients2)("allowSorting",!0)("editSettings",n.editSettings)("toolbar",n.toolbarOptions2)}}function oi(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",73),J.Vb(1,"h4",74),J.Qb(2,"i",75),J.Lc(3," Clone Article "),J.Ub(),J.Vb(4,"button",76),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",77),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",78),J.Vb(8,"div",0),J.Vb(9,"div",79),J.Vb(10,"div",80),J.Vb(11,"label",81),J.Lc(12,"Article Name"),J.Ub(),J.Vb(13,"span",82),J.Lc(14,"(*)"),J.Ub(),J.Vb(15,"input",83),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc().articleName=e}),J.Ub(),J.Ub(),J.Ub(),J.Vb(16,"div",79),J.Vb(17,"div",80),J.Vb(18,"label",81),J.Lc(19,"Process"),J.Ub(),J.Vb(20,"ejs-dropdownlist",84,85),J.fc("change",function(e){return J.Ec(i),J.jc().onChangeProcessCloneModal(e)}),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(22,"div",86),J.Vb(23,"button",87),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(24,"Close"),J.Ub(),J.Vb(25,"button",88),J.fc("click",function(){return J.Ec(i),J.jc().cloneArticleModelname()}),J.Lc(26,"Clone"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(15),J.pc("ngModel",n.articleName),J.Cb(5),J.pc("value",n.valueProcess)("dataSource",n.processData)("allowFiltering",!0)("fields",n.processfields)}}function ri(e,t){1&e&&(J.Lc(0),J.kc(1,"date")),2&e&&J.Nc(" ",J.mc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function ci(e,t){if(1&e&&(J.Tb(0),J.Qb(1,"input",101),J.Sb()),2&e){var i=J.jc().$implicit;J.Cb(1),J.pc("value",i.remark)}}function si(e,t){if(1&e&&J.Qb(0,"input",102),2&e){var i=J.jc().$implicit;J.pc("value",i.remark)}}function ui(e,t){if(1&e&&(J.Vb(0,"span",98),J.Jc(1,ci,2,1,"ng-container",99),J.Jc(2,si,1,1,"ng-template",null,100,J.Kc),J.Ub()),2&e){var i=t.$implicit,n=J.Bc(3);J.pc("ngClass","Improve"==i.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),J.Cb(1),J.pc("ngIf","Improve"==i.action)("ngIfElse",n)}}function di(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",73),J.Vb(1,"h4",74),J.Qb(2,"i",75),J.Lc(3," BPFC History "),J.Ub(),J.Vb(4,"button",76),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",77),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",78),J.Vb(8,"ejs-grid",89,90),J.fc("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginHistory(e)}),J.Vb(10,"e-columns"),J.Vb(11,"e-column",91),J.Jc(12,ri,2,4,"ng-template",null,24,J.Kc),J.Ub(),J.Qb(14,"e-column",92),J.Qb(15,"e-column",93),J.Qb(16,"e-column",94),J.Vb(17,"e-column",95),J.Jc(18,ui,4,3,"ng-template",null,28,J.Kc),J.Ub(),J.Qb(20,"e-column",96),J.Ub(),J.Ub(),J.Ub(),J.Vb(21,"div",86),J.Vb(22,"button",97),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(23,"Close"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(8),J.pc("dataSource",n.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",n.editSettingsHis)("toolbar",n.toolbarOptionsHistory),J.Cb(9),J.pc("edit",n.editparamsHis)}}function hi(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",73),J.Vb(1,"h4",74),J.Qb(2,"i",75),J.Lc(3," Clone BPFC "),J.Ub(),J.Vb(4,"button",76),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",77),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",78),J.Vb(8,"div",0),J.Vb(9,"div",79),J.Vb(10,"div",80),J.Vb(11,"label",81),J.Lc(12,"Model Name"),J.Ub(),J.Vb(13,"span",82),J.Lc(14,"(*)"),J.Ub(),J.Qb(15,"input",6),J.Ub(),J.Ub(),J.Vb(16,"div",79),J.Vb(17,"div",80),J.Vb(18,"label",81),J.Lc(19,"Model NO"),J.Ub(),J.Vb(20,"span",82),J.Lc(21,"(*)"),J.Ub(),J.Qb(22,"input",6),J.Ub(),J.Ub(),J.Vb(23,"div",79),J.Vb(24,"div",80),J.Vb(25,"label",81),J.Lc(26,"Article NO"),J.Ub(),J.Vb(27,"span",82),J.Lc(28,"(*)"),J.Ub(),J.Vb(29,"input",103),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc().articleNoNewLeo=e}),J.Ub(),J.Ub(),J.Ub(),J.Vb(30,"div",79),J.Vb(31,"div",80),J.Vb(32,"label",81),J.Lc(33,"Process"),J.Ub(),J.Vb(34,"span",82),J.Lc(35,"(*)"),J.Ub(),J.Qb(36,"input",6),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(37,"div",86),J.Vb(38,"button",87),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(39,"Close"),J.Ub(),J.Vb(40,"button",88),J.fc("click",function(){return J.Ec(i),J.jc().onClickClone()}),J.Lc(41,"Clone"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(15),J.pc("value",n.modelNameLeo),J.Cb(7),J.pc("value",n.modelNoLeo),J.Cb(7),J.pc("ngModel",n.articleNoNewLeo)("value",n.articleNoLeo),J.Cb(7),J.pc("value",n.artProcessLeo)}}var gi,mi=((gi=function(){function e(t,i,n,a,l,o,r,c,u,d,h,g,m,f,b,p,v){var D=this;s(this,e),this.glueIngredientService=t,this.modalNameService=i,this.glueService=n,this.alertify=a,this.modalService=l,this.route=o,this.authService=r,this.bPFCEstablishService=c,this.modelNoService=u,this.articleNoService=d,this.kindService=h,this.partService=g,this.materialService=m,this.buildingUserService=f,this.artProcessService=b,this.ingredientService=p,this.dataService=v,this.positions=["B","C","D","E"],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={id:0,name:"",gluename:"",code:"",createdDate:"",partID:0,kindID:0,materialID:0,BPFCEstablishID:0,consumption:"",expiredTime:0,createdBy:0,glueNameID:0,glueIngredients:[]},this.ingredient={id:0,name:"",code:"",percentage:0,createdDate:new Date,supplierID:0,position:0,allow:0,voc:0,expiredTime:0,daysToExpiration:0,materialNO:"",unit:0,real:0,cbd:0},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search","Add","Delete","Cancel"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.modelNameLeo=null,this.modelNoLeo=null,this.articleNoLeo=null,this.articleNoNewLeo=null,this.artProcessLeo=null,this.modelNameIDLeo=0,this.modelNoIDLeo=0,this.articleNoIDLeo=0,this.artProcessIDLeo=0,this.BPFCIDLeo=0,this.textSearch=null,this.onFiltering=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(D.modelNameData,t)},this.onFilteringModelName=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(D.modelNameData,t)},this.onFilteringModelNO=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(D.modelNoData,t)},this.onFilteringArticleNO=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(D.articleNoData,t)},this.onFilteringModelNameClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(D.modelNameData,t)},this.onFilteringModelNOClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(D.modelNoData,t)},this.onFilteringArticleNOClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(D.articleNoData,t)},this.onFilteringArtProcessClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(D.artProcessDataClone,t)},this.dataSearch=this.dataService.currentMessage.subscribe(function(e){D.textSearch=e})}return d(e,[{key:"ngOnInit",value:function(){var e=this;this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.GetDetailBPFC(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(function(t){200===t&&e.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}},{key:"ngOnDestroy",value:function(){this.dataService.changeMessages(this.textSearch),this.dataSearch.unsubscribe()}},{key:"GetDetailBPFC",value:function(){var e=this;this.BPFCID=this.route.snapshot.params.id,this.bPFCEstablishService.getDetailBPFC(this.BPFCID).subscribe(function(t){var i,n=t[0];e.BPFCIDLeo=n.id,e.modelNameLeo=n.modelName,e.modelNoLeo=n.modelNo,e.articleNoLeo=n.articleNo,e.artProcessLeo=n.artProcess,e.articleNoNewLeo=n.articleNo,e.modelNameID=n.modelNameID,e.modelNoID=n.modelNoID,e.articleNoID=n.articleNoID,e.artProcessIDLeo="ASY"===n.artProcess?1:2,e.modelNameDetail=t[0].modelName,e.modelNameID=t[0].modelNameID,e.modelNoDetail=t[0].modelNo,e.articleNoDetail=t[0].articleNo,e.artProcessDetail=t[0].artProcess,e.modelNameIDClone=t[0].modelNameID,e.value=t[0].modelNameID,e.valuemodelNo=t[0].modelNoID,e.articleNoID=t[0].articleNoID,e.resetLifeCycleBPFC(),e.BPFCID=null===(i=t[0])||void 0===i?void 0:i.id,e.approvalStatus=t[0].approvalStatus,e.createdStatus=t[0].finishedStatus,localStorage.removeItem("details"),e.glue.BPFCEstablishID=e.BPFCID,e.getAllGluesByBPFCID(e.BPFCID),e.getAllPart(),e.getAllKind(),e.getAllMaterial(),e.getAllIngredient(),e.existGlue=!0,e.modified=!0})}},{key:"onChangeProcessCloneModal",value:function(e){e.itemData&&(this.processID=e.itemData.id)}},{key:"resetLifeCycleBPFC",value:function(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}},{key:"onCreatedGridGlue",value:function(){}},{key:"ngAfterViewInit",value:function(){$('[data-toggle="tooltip"]').tooltip();var e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}},{key:"onChangeKindEdit",value:function(e){this.kindEdit=e.value,this.kindID=e.itemData.id}},{key:"onChangePartEdit",value:function(e){this.partEdit=e.value,this.partID=e.itemData.id}},{key:"onChangeMaterialEdit",value:function(e){this.kindEdit=e.value,this.materialID=e.itemData.id}},{key:"dataBoundGlue",value:function(){this.gridglue.selectRows(this.selectedRow.length?this.selectedRow:this.selIndex)}},{key:"actionBeginGlue",value:function(e){var t=this;"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":"Consumption ".concat(e.rowData.consumption),this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After="Consumption ".concat(e.data.consumption),this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){t.glueService.delete(e.data[0].id).subscribe(function(){t.getAllGluesByBPFCID(t.BPFCID),t.detailGlue=!1,t.removeLocalStore("details"),t.glueIngredientDetail=[],t.oldDetail=[],t.alertify.success("Glue has been deleted")},function(e){t.alertify.error("Failed to delete the Glue")})}))}},{key:"rowDeselected",value:function(e){var t=this,i=e.rowIndex,n=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,n)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(function(e){if(t.modified=!0,t.gridglue.getSelectedRowIndexes().length){var n=t.gridglue.dataSource[i];n.name=n.chemical.name,t.gridglue.refresh()}}).catch(function(e){t.gridglue.selectRows([i])})}},{key:"rowSelected",value:function(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);var t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}},{key:"onChangePosition",value:function(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;var n=e.value,a=this.getLocalStore("details");if(""===e.value);else{if(0!==a.length){var l="";switch(a[a.length-1].position){case"A":l="B";break;case"B":l="C";break;case"C":l="D";break;case"D":l="E"}if(n!==l)return this.alertify.warning("H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 ".concat(l),!0),this.grid.refresh(),this.grid2.refresh(),void(e.cancel=!0)}if(0===a.filter(function(t){return t.position===e.value}).length&&null!==e.value)if(a=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==a.filter(function(e){return e.ingredientName===t.name&&e.position===t.position}).length){var o=a.findIndex(function(e){return e.ingredientName===t.name});a[o].position=e.value,this.setLocalStore("details",a),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.refresh()}else{a=this.getLocalStore("details");var r={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(r.percentage=100,r.expiredTime=t.expiredTime),a.push(r),this.setLocalStore("details",a),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.refresh()}}}},{key:"recordDoubleClick",value:function(e){this.modifiedGlue=!0}},{key:"toolbarClickIngredient",value:function(e){switch(e.item.text){case"Add":e.cancel=!0,this.openIngredientModalComponent()}}},{key:"onDoubleClickIngredient",value:function(e){this.setFocus=e.column}},{key:"rowSelectedIngredient",value:function(e){this.ingridientID=e.data.id}},{key:"genaratorGlueCode",value:function(){this.glue.code=this.makeid(8)}},{key:"makeid",value:function(e){for(var t="",i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length,a=0;a<e;a++)t+=i.charAt(Math.floor(Math.random()*n));return t}},{key:"compareArray",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"setLocalStore",value:function(e,t){localStorage.removeItem(e);var i=JSON.stringify(t);localStorage.setItem(e,i)}},{key:"getLocalStore",value:function(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}},{key:"removeLocalStore",value:function(e){localStorage.removeItem(e)}},{key:"dynamicSort",value:function(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(i,n){return-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}}},{key:"checkColorCode",value:function(e){return!0===e.approvalStatus&&!0===e.finishedStatus}},{key:"checkDone",value:function(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}},{key:"checkStatus",value:function(e,t){return!0===e&&!0===t?"Done":"Undone"}},{key:"renderchemical",value:function(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}},{key:"makeFormula",value:function(){var e,t,i=this.getLocalStore("details").filter(function(e){return"A"===e.position})||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(function(e){return e.percentage}),this.percentageCountEdit=this.glueIngredientDetail.map(function(e){return e}),this.totalPercentage=this.percentageCount.reduce(function(e,t){return e+t},0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);var n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}},{key:"formula",value:function(){return this.B&&this.C&&this.D&&this.E?"{[ (".concat(this.nameGlue,"+ ").concat(this.B,") + ").concat(this.C," ] + ").concat(this.D,"}+ ").concat(this.E):this.B&&this.C&&this.D?"[(".concat(this.nameGlue," + ").concat(this.B,") + ").concat(this.C,"] + ").concat(this.D):this.B&&this.C?"(".concat(this.nameGlue," + ").concat(this.B,") + ").concat(this.C):this.B?"".concat(this.nameGlue," + ").concat(this.B):"".concat(this.nameGlue)}},{key:"formulaTamp",value:function(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName="{[ (".concat(this.nameGlues,"+ ").concat(this.BB,") + ").concat(this.CC," ] + ").concat(this.DD,"}+ ").concat(this.EE),"{[ (".concat(this.nameGlues,"+ ").concat(this.BB,") + ").concat(this.CC," ] + ").concat(this.DD,"}+ ").concat(this.EE)):this.BB&&this.CC&&this.DD?(this.glueNewName="[(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC,"] + ").concat(this.DD),"[(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC,"] + ").concat(this.DD)):this.BB&&this.CC?(this.glueNewName="(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC),"(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC)):this.BB?(this.glueNewName="".concat(this.nameGlues," + ").concat(this.BB),"".concat(this.nameGlues," + ").concat(this.BB)):"".concat(this.nameGlues)}},{key:"getDetail",value:function(e){var t=this;this.glueIngredientService.getDetail(e).subscribe(function(e){var i,n,a,l;t.glueIngredientDetail=e.glueIngredients,t.setLocalStore("details",t.glueIngredientDetail),t.setLocalStore("detailsTamp",t.glueIngredientDetail),t.glueIngredientDetail=t.renderchemical(),t.oldDetail=t.renderchemical();var o=t.glueIngredientDetail.filter(function(e){return"A"===e.position})||[];t.nameGlue=(null===(i=o[0])||void 0===i?void 0:i.ingredientName)||"",t.nameGlues=(null===(n=o[0])||void 0===n?void 0:n.ingredientName)+"^"+(null===(a=t.glueIngredientDetail[0])||void 0===a?void 0:a.allow)+"%"||!1,t.A=(null===(l=o[0])||void 0===l?void 0:l.ingredientName)||"",void 0===t.glueIngredientDetail[1]?t.B="":(t.B=t.glueIngredientDetail[1].percentage+"%"+t.glueIngredientDetail[1].ingredientName,t.BB=t.glueIngredientDetail[1].percentage+"%"+t.glueIngredientDetail[1].ingredientName+"^"+t.glueIngredientDetail[1].allow+"%"),void 0===t.glueIngredientDetail[2]?t.C="":(t.C=t.glueIngredientDetail[2].percentage+"%"+t.glueIngredientDetail[2].ingredientName,t.CC=t.glueIngredientDetail[2].percentage+"%"+t.glueIngredientDetail[2].ingredientName+"^"+t.glueIngredientDetail[2].allow+"%"),void 0===t.glueIngredientDetail[3]?t.D="":(t.D=t.glueIngredientDetail[3].percentage+"%"+t.glueIngredientDetail[3].ingredientName,t.DD=t.glueIngredientDetail[3].percentage+"%"+t.glueIngredientDetail[3].ingredientName+"^"+t.glueIngredientDetail[3].allow+"%"),void 0===t.glueIngredientDetail[4]?t.E="":(t.E=t.glueIngredientDetail[4].percentage+"%"+t.glueIngredientDetail[4].ingredientName,t.EE=t.glueIngredientDetail[4].percentage+"%"+t.glueIngredientDetail[4].ingredientName+"^"+t.glueIngredientDetail[4].allow+"%"),t.glueIngredientDetail.length>0?(t.percentageCount=t.glueIngredientDetail.map(function(e){return e.percentage}),t.percentageCount.join("+"),t.percentageCountEdit=t.glueIngredientDetail.map(function(e){return e}),t.totalPercentage=t.percentageCount.reduce(function(e,t){return e+t},0)):(t.percentageCount=[],t.percentageCountEdit=[],t.totalPercentage=0)})}},{key:"updateChemicalList",value:function(){var e,t=this,i=this.getLocalStore("details"),n=o(i);try{var a=function(){var i=e.value,n=t.ingredients1.findIndex(function(e){return e.name===i.ingredientName&&e.id===i.ingredientID});-1!==n&&(t.ingredients1[n].position=i.position,t.ingredients1[n].percentage=i.percentage,t.ingredients1[n].allow=i.allow)};for(n.s();!(e=n.n()).done;)a()}catch(s){n.e(s)}finally{n.f()}var l,r=o(i);try{var c=function(){var e=l.value,i=t.ingredients2.findIndex(function(t){return t.name===e.ingredientName&&t.id===e.ingredientID});-1!==i&&(t.ingredients2[i].position=e.position,t.ingredients2[i].percentage=e.percentage,t.ingredients2[i].allow=e.allow)};for(r.s();!(l=r.n()).done;)c()}catch(s){r.e(s)}finally{r.f()}}},{key:"actionBeginIngredient",value:function(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;var t=Number(this.percentageDefault)!==Number(this.percentageChange),i=Number(this.allowDefault)!==Number(this.allowChange);if(t){this.modified=!1;var n=this.getLocalStore("details"),a=n.findIndex(function(t){return t.ingredientName===e.data.name&&t.ingredientID===e.data.id});n[a].percentage=e.data.percentage,this.setLocalStore("details",n),this.updateChemicals()}if(i){var l=this.getLocalStore("details"),o=l.findIndex(function(t){return t.ingredientName===e.data.name&&t.ingredientID===e.data.id});l[o].allow=e.data.allow,this.setLocalStore("details",l),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicals()}}"delete"===e.requestType&&this.deleteIngredient()}},{key:"updateGlueIngredient",value:function(){}},{key:"loadPreview",value:function(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}},{key:"resolver",value:function(){var e=this;this.route.data.subscribe(function(t){e.glues=t.glues.result,e.paginationG=t.glues.pagination})}},{key:"onService",value:function(){var e=this;this.ingredientService.currentIngredient.subscribe(function(t){300===t&&(e.getIngredients(),e.updateChemicalList(),e.ingredientService.changeIngredient(0))})}},{key:"mapGlue",value:function(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}},{key:"getIngredients",value:function(){var e=this;this.glueIngredientService.getIngredients(this.glueid).subscribe(function(t){e.ingredients1=t.result.list1,e.ingredients2=t.result.list2},function(t){e.alertify.error(t)})}},{key:"getGlues",value:function(){var e=this;this.glueService.getAllGlue().subscribe(function(t){e.glues=t},function(t){e.alertify.error(t)})}},{key:"mapGlueIngredients",value:function(e){var t=this;this.glueIngredientService.mapGlueIngredient(e).subscribe(function(e){void 0===t.subID?(t.sortBySup(0),t.getDetail(t.glueid)):(t.sortBySup(t.subID),t.getDetail(t.glueid))})}},{key:"mapGlueIngredient",value:function(e){var t=this;this.glueIngredientService.mappGlueIngredient(e).subscribe(function(e){void 0===t.subID?(t.getAllGluesByBPFCID(t.BPFCID),t.sortBySup(0),t.getDetail(t.glueid)):(t.sortBySup(t.subID),t.getDetail(t.glueid),t.getAllGluesByBPFCID(t.BPFCID))})}},{key:"openIngredientModalComponent",value:function(){var e=this.modalService.open(re.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(function(e){},function(e){})}},{key:"actionCompleteIngredient",value:function(e){"beginEdit"===e.requestType&&"Item"!==this.setFocus.field&&(e.form.elements.namedItem(this.setFocus.field).focus(),e.form.elements.namedItem(this.setFocus.field).value="")}},{key:"openPopupDropdownlist",value:function(){$('[data-toggle="tooltip"]').tooltip()}},{key:"toolbarClick",value:function(e){var t=this;switch(e.item.text){case"Add New":var i=this.getLocalStore("details").sort(this.dynamicSort("position"));if(!1===this.compareArray(this.oldDetail,i)&&i.length>0&&this.oldDetail.length>0)this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(function(e){var i={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:t.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};t.glue=i,t.saveGlue()}).catch(function(t){e.cancel=!0});else{var n={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=n,this.saveGlue()}}}},{key:"openModal",value:function(e){this.modalReference=this.modalService.open(e)}},{key:"openModalHistory",value:function(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}},{key:"LoadHistoryBPFC",value:function(){var e=this;this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(function(t){e.historyData=t.map(function(t){return{id:t.id,glueID:t.glueID,createdTime:t.createdTime,bpfcEstablishID:t.bpfcEstablishID,before:t.before,after:t.after,action:t.action,remark:t.remark,userID:t.userID,createdBy:e.createdBy(t.userID)}})})}},{key:"actionBeginHistory",value:function(e){var t=this;"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(function(e){e&&t.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}},{key:"getAllUsers",value:function(){var e=this;this.buildingUserService.getAllUsers(1,1e3).subscribe(function(t){e.userData=t.result})}},{key:"createdBy",value:function(e){if(0===e)return"#N/A";var t=this.userData.filter(function(t){return t.ID===e})[0];return void 0!==t?t.Username:"#N/A"}},{key:"cloneModelname",value:function(){var e=this;this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",function(){e.modalNameService.cloneModelname(e.modelNameID,e.modelNameClone,e.modelNoClone,e.valueProcess).subscribe(function(t){e.alertify.success("the model name has been cloned"),e.modalReference.close(),e.modelNameDropdownlist.hidePopup()})})}},{key:"cloneArticleModelname",value:function(){var e=this;this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",function(){e.modalNameService.cloneArticleModelname(e.modelNameID,e.modelNameClone,e.modelNoClone,e.articleName,e.processID).subscribe(function(t){e.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),e.modalReference.close(),e.modelNameDropdownlist.hidePopup()})})}},{key:"delete",value:function(e,t){var i=this;this.glueIngredientService.delete(e,t).subscribe(function(t){i.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),i.getIngredients(),i.getDetail(e)})}},{key:"deleteGlue",value:function(e){var t=this;this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',function(){t.glueService.delete(e.id).subscribe(function(){t.getGlues(),t.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(e){t.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}},{key:"deleteIngridient",value:function(e){var t=this;this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',function(){t.ingredientService.delete(e.id).subscribe(function(){t.getIngredients(),t.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(e){t.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}},{key:"getAllGluesByBPFCID",value:function(e){var t=this;this.glueService.getAllGluesByBPFCID(e).subscribe(function(e){t.glues=e})}},{key:"getAllGluesByBPFCID2",value:function(e){var t=this;this.glueService.getAllGluesByBPFCID(e).subscribe(function(e){void 0===t.ingredientID?(t.glues=e,e.length>0&&(t.detailGlue=!0)):(t.glueid=e[0].id,t.glueIngredient2.ingredientID=t.ingredientID,t.glueIngredient2.percentage=100,t.glueIngredient2.glueID=t.glueid,t.glueIngredient2.position="A",t.mapGlueIngredient(t.glueIngredient2))})}},{key:"updateChemicals",value:function(){var e=this;this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(function(t){e.ingredients1=t.list1,e.ingredients2=t.list2;var i,n=e.getLocalStore("details"),a=o(n);try{var l=function(){var t=i.value,n=e.ingredients1.findIndex(function(e){return e.name===t.ingredientName&&e.id===t.ingredientID});-1!==n&&(e.ingredients1[n].position=t.position,e.ingredients1[n].percentage=t.percentage,e.ingredients1[n].allow=t.allow)};for(a.s();!(i=a.n()).done;)l()}catch(u){a.e(u)}finally{a.f()}var r,c=o(n);try{var s=function(){var t=r.value,i=e.ingredients2.findIndex(function(e){return e.name===t.ingredientName&&e.id===t.ingredientID});-1!==i&&(e.ingredients2[i].position=t.position,e.ingredients2[i].percentage=t.percentage,e.ingredients2[i].allow=t.allow)};for(c.s();!(r=c.n()).done;)s()}catch(u){c.e(u)}finally{c.f()}e.glueIngredientDetail=n,e.makeFormula()})}},{key:"sortBySup",value:function(e){var t=this;0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(function(i){if(t.ingredients1=i.list1,t.ingredients2=i.list2,0===e){var n=t.getLocalStore("details");t.ingredients1=n.map(function(e){return{id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,cbd:e.cbd}}),t.glueIngredientDetail=n}else t.updateChemicalList()}))}},{key:"saveGlue",value:function(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}},{key:"getBuilding",value:function(){JSON.parse(localStorage.getItem("user"))}},{key:"getAllIngredient",value:function(){var e=this;this.ingredientService.getAllIngredient().subscribe(function(t){e.ingrediented=t})}},{key:"createGlue",value:function(){var e=this;this.glueService.create(this.glue).subscribe(function(){e.alertify.success("\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.clearGlueForm(),e.genaratorGlueCode(),e.expiredTime=0},function(t){e.alertify.error(t),e.genaratorGlueCode()})}},{key:"finished",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=t,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){});var i=this.getLocalStore("details"),n=this.gridglue.getSelectedRecords()[0];n.expiredTime=i.filter(function(e){return"A"===e.position})[0].expiredTime,n.kindID=0===n.kindID?null:n.kindID,n.partID=0===n.partID?null:n.partID,n.materialID=0===n.materialID?null:n.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),this.glueService.update(n).subscribe(function(t){e.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.detailGlue=!0,e.modified=!0}),i.length>0&&(this.mapGlueIngredients(i),this.modified=!0)}}},{key:"clearGlueForm",value:function(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}},{key:"update",value:function(){var e=this;this.glueService.update(this.glue).subscribe(function(t){e.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.detailGlue=!1,e.history.Action="Created",e.expiredTime=0})}},{key:"updateChemical",value:function(){var e=this;this.glueService.updateChemical(this.glue).subscribe(function(t){e.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.detailGlue=!1,e.onChangeChemical=!1,e.history.Action="Created"})}},{key:"deleteIngredient",value:function(){var e=this;this.ingredientService.delete(this.ingridientID).subscribe(function(){var t=e.getLocalStore("details").filter(function(t){return t.ingredientID!==e.ingridientID});e.setLocalStore("details",t),e.glueIngredientDetail=t,e.getIngredients(),e.makeFormula(),e.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(t){e.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}},{key:"approval",value:function(){var e=this,t=this.gridglue.dataSource;if(t){var i,n=o(t);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.glueIngredients.length>0){var l,r=o(a.glueIngredients.filter(function(e){return"A"!==e.position}));try{for(r.s();!(l=r.n()).done;){var c=l.value;if(c.allow<=0&&"A"!==c.position)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The allowance of checmical name ".concat(c.ingredient.name," must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ").concat(c.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(a.name," <br>\n              "),!0);if(c.percentage<=0&&"A"!==c.position)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The percentage of checmical name ".concat(c.ingredient.name," must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ").concat(c.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(a.name," <br>\n              "),!0)}}catch(u){r.e(u)}finally{r.f()}}if(+a.consumption<=0)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The consumption of glue name ".concat(a.name," must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ").concat(a.name," ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ").concat(a.name," <br>\n          "),!0)}}catch(u){n.e(u)}finally{n.f()}var s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(function(t){e.alertify.success("The BPFC has been approved!"),e.createdStatus=e.approvalStatus;var i=e.modelNameDropdownlist.getDataByValue(e.modelNameDropdownlist.value);e.modelNameDropdownlist.valueTemplate="(".concat(e.checkStatus(e.approvalStatus,e.createdStatus),") ").concat(i.name)})}}},{key:"done",value:function(){var e=this,t=this.gridglue.dataSource,i=!1,n=!1,a=!1;if(t){var l,r=o(t);try{for(r.s();!(l=r.n()).done;){var c=l.value;if(c.glueIngredients.length>0){var s,u=c.glueIngredients.filter(function(e){return"A"!==e.position}),d=o(u);try{for(d.s();!(s=d.n()).done;){var h=s.value;if(h.allow<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The allow of checmical name ".concat(h.ingredient.name," is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ").concat(h.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(c.name," <br>\n              "),!0);if(h.percentage<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The percentage of checmical name ".concat(h.ingredient.name," is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ").concat(h.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(c.name," <br>\n              "),!0);i=!0,n=!0}}catch(m){d.e(m)}finally{d.f()}0===u.length&&(i=!0,n=!0)}if(+c.consumption<=0)return a=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The consumption of glue name ".concat(c.name," is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ").concat(c.name," ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ").concat(c.name," <br>\n          "),!0);a=!0}}catch(m){r.e(m)}finally{r.f()}if(i&&n&&a){var g=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,g).subscribe(function(t){!0===t.status?(e.alertify.success(t.message),e.createdStatus=e.createdStatus):e.alertify.success(t.message)})}}}},{key:"getModelNames",value:function(){var e=this;this.modalNameService.getAllModalName().subscribe(function(t){e.modelNameData=t.map(function(e){return{id:e.id,name:e.name}})})}},{key:"getArticleNoByModelNameID",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNoData=e})}},{key:"getModelNoByModelNameID",value:function(e){var t=this;this.modelNoService.getModelNoByModelNameID(e).subscribe(function(e){t.modelNoData=e})}},{key:"getArtProcessByArticleNoID",value:function(e){var t=this;this.artProcessService.getArtProcessByArticleNoID(e).subscribe(function(e){t.artProcessData=e.map(function(e){return{id:e.id,name:1===e.processID?"ASY":"STF"}})})}},{key:"getAllProcess",value:function(){var e=this;this.artProcessService.GetAllProcess().subscribe(function(t){e.artProcessDataClone2=t})}},{key:"getAllKind",value:function(){var e=this;this.kindService.getAllKind().subscribe(function(t){e.kinds=t})}},{key:"getAllPart",value:function(){var e=this;this.partService.getAllPart().subscribe(function(t){e.parts=t})}},{key:"getAllMaterial",value:function(){var e=this;this.materialService.getAllMaterial().subscribe(function(t){e.materials=t})}},{key:"getIngredientsByGlueID",value:function(){var e=this;this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(function(t){e.ingredients1=t.list1,e.ingredients2=t.list2})}},{key:"getAllSupllier",value:function(){var e=this;this.ingredientService.getAllSupplier().subscribe(function(t){e.supplier=t})}},{key:"getArticleNoByModelNoID",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNosData=e})}},{key:"getBPFCID",value:function(e){var t=this;this.bPFCEstablishService.getBPFCID(e).subscribe(function(e){t.resetLifeCycleBPFC(),t.BPFCID=null==e?void 0:e.id,t.approvalStatus=e.approvalStatus,t.createdStatus=e.finishedStatus,t.glue.BPFCEstablishID=t.BPFCID,t.getAllGluesByBPFCID(t.BPFCID),t.getAllPart(),t.getAllKind(),t.getAllMaterial(),t.getAllIngredient(),t.existGlue=!0,t.modified=!0})}},{key:"OndataBound",value:function(e){}},{key:"getModelNamesClone",value:function(){var e=this;this.modalNameService.getAllModalName().subscribe(function(t){e.modelNameDataClone=t.map(function(e){return{id:e.id,name:e.name}}),e.getModelNoByModelNameIDClone(e.modelNameIDClone),e.articleNosDataClone=[],e.artProcessDataClone=[]})}},{key:"getArticleNoByModelNameIDClone",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNosDataClone=e})}},{key:"getModelNoByModelNameIDClone",value:function(e){var t=this;this.modelNoService.getModelNoByModelNameID(e).subscribe(function(e){t.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}},{key:"getArtProcessByArticleNoIDClone",value:function(e){var t=this;this.artProcessService.getArtProcessByArticleNoID(e).subscribe(function(e){t.artProcessDataClone=e.map(function(e){return{id:e.id,name:1===e.ProcessID?"ASY":"STF"}})})}},{key:"onChangeModelName",value:function(e){this.resetLifeCycleBPFC(),this.modelNameID=e.value,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}},{key:"onChangeModelNo",value:function(e){e.isInteracted&&(this.modelNoID=e.value,this.valuemodelNo=e.value,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}},{key:"onChangeArticleNo",value:function(e){e.isInteracted&&(this.articleNoID=e.value,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}},{key:"onClickProcess",value:function(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue))}},{key:"ClickProcessData",value:function(e){}},{key:"clearFormClone",value:function(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}},{key:"onClickClone",value:function(){var e={modelNameID:this.modelNameIDLeo,modelNOID:this.modelNoIDLeo,articleNOID:this.articleNoIDLeo,artProcessID:Number(this.artProcessIDLeo),bpfcID:this.BPFCIDLeo,name:this.articleNoNewLeo,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}},{key:"clone",value:function(e){var t=this;this.articleNoNewLeo!==this.articleNoLeo?this.modalNameService.cloneBPFC(e).subscribe(function(e){!0===e.status?(t.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),t.modalService.dismissAll(),t.getAllUsers()):t.alertify.error("The BPFC exists!")}):this.alertify.error("The BPFC exists!")}},{key:"onChangeModelNameClone",value:function(e){this.value!==e.value&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}},{key:"onChangeModelNoClone",value:function(e){this.modelNOIDClone=e.value,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}},{key:"onChangeArticleNoClone",value:function(e){e.isInteracted&&(this.articleNOIDClone=e.value,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}},{key:"onChangeProcessClone",value:function(e){e.isInteracted&&(this.artProcessIDClone=e.value)}},{key:"changeAllowColor",value:function(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}},{key:"changePercentageColor",value:function(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}},{key:"changeConsumptionColor",value:function(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}]),e}()).\u0275fac=function(e){return new(e||gi)(J.Pb(Y),J.Pb(L.a),J.Pb(Z.a),J.Pb(G.a),J.Pb(f.b),J.Pb(V.a),J.Pb(te.a),J.Pb(j.a),J.Pb(ie),J.Pb(ee),J.Pb(ae.a),J.Pb(le.a),J.Pb(oe.a),J.Pb(T.a),J.Pb(ne),J.Pb(R.a),J.Pb(M.a))},gi.\u0275cmp=J.Jb({type:gi,selectors:[["app-bpfc-detail"]],viewQuery:function(e,t){var i;1&e&&(J.Rc(gt,1),J.Rc(mt,1),J.Rc(ft,1),J.Rc(bt,1),J.Rc(pt,1),J.Rc(vt,1),J.Rc(Dt,1),J.Rc(It,1)),2&e&&(J.Ac(i=J.gc())&&(t.switch=i.first),J.Ac(i=J.gc())&&(t.grid=i.first),J.Ac(i=J.gc())&&(t.gridglue=i.first),J.Ac(i=J.gc())&&(t.grid2=i.first),J.Ac(i=J.gc())&&(t.modelNameDropdownlist=i.first),J.Ac(i=J.gc())&&(t.modelNoDropdownlist=i.first),J.Ac(i=J.gc())&&(t.chemicalDropdownlist=i.first),J.Ac(i=J.gc())&&(t.positionDropdownlist=i))},features:[J.Bb([k.n,k.f,k.k])],decls:48,vars:10,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["type","text","name","","disabled","","title","",1,"form-control",3,"value"],[1,"col-md-1","mt-2"],["type","button",1,"btn","btn-danger","rounded-pill"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],[1,"card-title"],["class","card-tools",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["HistoryModal",""],["cloneModal",""],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],[1,"card-tools"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],["style","width: 100px; margin-right: 10px;",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click",4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click",4,"ngIf"],[2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange"],["switch",""],["onLabel","Approved","style","width: 120px;",3,"offLabel","ngModel","checked","click","ngModelChange",4,"ngIf"],["onLabel","Approved",2,"width","120px",3,"offLabel","ngModel","checked","click","ngModelChange"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","bg-gradient-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],["height","675px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid2",""],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","","title","",1,"form-control",3,"ngModel","value","ngModelChange"]],template:function(e,t){1&e&&(J.Vb(0,"div",0),J.Vb(1,"div",1),J.Vb(2,"div",2),J.Vb(3,"div",3),J.Vb(4,"div",0),J.Vb(5,"div",4),J.Vb(6,"label"),J.Lc(7,"Model Name: "),J.Ub(),J.Ub(),J.Vb(8,"div",5),J.Qb(9,"input",6),J.Ub(),J.Ub(),J.Vb(10,"div",0),J.Vb(11,"div",4),J.Vb(12,"label"),J.Lc(13,"Model NO: "),J.Ub(),J.Ub(),J.Vb(14,"div",5),J.Qb(15,"input",6),J.Ub(),J.Ub(),J.Vb(16,"div",0),J.Vb(17,"div",4),J.Vb(18,"label"),J.Lc(19,"Article NO: "),J.Ub(),J.Ub(),J.Vb(20,"div",5),J.Qb(21,"input",6),J.Ub(),J.Qb(22,"div",7),J.Ub(),J.Vb(23,"div",0),J.Vb(24,"div",4),J.Vb(25,"label"),J.Lc(26,"Process: "),J.Ub(),J.Ub(),J.Vb(27,"div",5),J.Vb(28,"button",8),J.Lc(29),J.Ub(),J.Ub(),J.Qb(30,"div",7),J.Ub(),J.Ub(),J.Ub(),J.Vb(31,"div",2),J.Vb(32,"div",9),J.Jc(33,Et,32,5,"div",10),J.Ub(),J.Ub(),J.Ub(),J.Vb(34,"div",11),J.Vb(35,"div",2),J.Vb(36,"div",12),J.Vb(37,"h3",13),J.Lc(38),J.kc(39,"translate"),J.Ub(),J.Jc(40,Tt,8,4,"div",14),J.Ub(),J.Jc(41,li,63,14,"div",15),J.Ub(),J.Ub(),J.Jc(42,oi,27,5,"ng-template",null,16,J.Kc),J.Jc(44,di,24,6,"ng-template",null,17,J.Kc),J.Ub(),J.Jc(46,hi,42,5,"ng-template",null,18,J.Kc)),2&e&&(J.Cb(9),J.pc("value",t.modelNameDetail),J.Cb(6),J.pc("value",t.modelNoDetail),J.Cb(6),J.pc("value",t.articleNoDetail),J.Cb(8),J.Mc(t.artProcessDetail),J.Cb(4),J.pc("ngIf",t.existGlue),J.Cb(5),J.Nc("",J.lc(39,8,"PREVIEW")," "),J.Cb(2),J.pc("ngIf",t.existGlue),J.Cb(1),J.pc("ngIf",t.existGlue))},directives:[c.n,k.j,p.d,A.d,A.b,k.e,k.b,p.c,A.c,A.a,k.d,k.a,m.c,u.f,u.i,v.k,v.b,c.m,u.a,c.l],pipes:[C.c,c.e],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{animation:warning-frames .5s infinite;color:#000}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),gi),fi=l("dQqK"),bi=l("MAxt"),pi=l("quSY"),vi=l("iStF"),Di=l("NkNT"),Ii=["grid"],yi=["importModal"],Ci=["tooltip"];function Ni(e,t){if(1&e&&J.Lc(0),2&e){var i=t.$implicit,n=J.jc();J.Mc(n.NO(i.index))}}function Si(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-tooltip",24,25),J.fc("beforeRender",function(e){J.Ec(i);var n=t.$implicit;return J.jc().onBeforeRender(e,n,n.index)}),J.Lc(2),J.Ub()}if(2&e){var n=t.$implicit;J.Cb(2),J.Nc(" ",n.modelName," ")}}function wi(e,t){if(1&e&&(J.Lc(0),J.kc(1,"date")),2&e){var i=t.$implicit;J.Nc(" ","ASY"===i.artProcess?"N/A":J.mc(1,1,i.dueDate,"d MMM, yyyy")," ")}}function ki(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div"),J.Vb(1,"ejs-datepicker",28),J.fc("change",function(e){return J.Ec(i),J.jc(2).onChangeDueDate(e)}),J.Ub(),J.Ub()}if(2&e){var n=J.jc().$implicit;J.Cb(1),J.pc("value",n.dueDate)}}function Pi(e,t){if(1&e&&(J.Lc(0),J.kc(1,"date")),2&e){var i=J.jc().$implicit;J.Nc(" ","ASY"===i.artProcess?"N/A":J.mc(1,1,i.dueDate,"d MMM, yyyy")," ")}}function Bi(e,t){if(1&e&&(J.Jc(0,ki,2,1,"div",26),J.Jc(1,Pi,2,4,"ng-template",null,27,J.Kc)),2&e){var i=t.$implicit,n=J.Bc(2);J.pc("ngIf","STF"===i.artProcess)("ngIfElse",n)}}function Ai(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",35),J.fc("click",function(){J.Ec(i);var e=J.jc().$implicit,t=J.jc(),n=J.Bc(34);return t.openModal(n,e)}),J.Qb(1,"i",36),J.Ub()}}function xi(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",37),J.fc("click",function(){J.Ec(i);var e=J.jc().$implicit,t=J.jc(),n=J.Bc(36);return t.openModalClone(n,e)}),J.Qb(1,"i",38),J.Ub()}}function Ui(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",29),J.fc("click",function(){J.Ec(i);var e=t.$implicit;return J.jc().detail(e)}),J.Qb(1,"i",30),J.Ub(),J.Jc(2,Ai,2,0,"button",31),J.Jc(3,xi,2,0,"button",32),J.Vb(4,"button",33),J.fc("click",function(){J.Ec(i);var e=t.$implicit;return J.jc().delete(e.id)}),J.Qb(5,"i",34),J.Ub()}if(2&e){var n=t.$implicit;J.Cb(2),J.pc("ngIf",!0===n.finishedStatus),J.Cb(1),J.pc("ngIf",!1===n.finishedStatus)}}function Ei(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",39),J.Vb(1,"h4",40),J.Qb(2,"i",41),J.Lc(3," Import Excel "),J.Ub(),J.Vb(4,"button",42),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",43),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",44),J.Vb(8,"div",4),J.Vb(9,"div",45),J.Vb(10,"div",46),J.Vb(11,"label",47),J.Lc(12,"Select File (*Notice: Excel file must be followed a system template. If you do not have a template, please "),J.Vb(13,"a",48),J.Lc(14,"click here"),J.Ub(),J.Lc(15," to download. Thank you!)"),J.Ub(),J.Vb(16,"input",49),J.fc("change",function(e){return J.Ec(i),J.jc().fileProgress(e)}),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(17,"div",50),J.Vb(18,"button",51),J.fc("click",function(){return J.Ec(i),J.jc().uploadFile()}),J.Lc(19,"Upload File"),J.Ub(),J.Vb(20,"button",52),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(21,"Close"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(13),J.pc("href",n.excelDownloadUrl,J.Gc)}}function Vi(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",39),J.Vb(1,"h4",40),J.Qb(2,"i",41),J.Lc(3," New Version BPFC "),J.Ub(),J.Vb(4,"button",42),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",43),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",44),J.Vb(8,"div",4),J.Vb(9,"div",5),J.Vb(10,"div",46),J.Vb(11,"label",47),J.Lc(12,"Model Name"),J.Ub(),J.Qb(13,"input",53),J.Ub(),J.Ub(),J.Vb(14,"div",5),J.Vb(15,"div",46),J.Vb(16,"label",47),J.Lc(17,"Model NO"),J.Ub(),J.Qb(18,"input",53),J.Ub(),J.Ub(),J.Vb(19,"div",5),J.Vb(20,"div",46),J.Vb(21,"label",47),J.Lc(22,"Article NO"),J.Ub(),J.Vb(23,"span",54),J.Lc(24,"(*)"),J.Ub(),J.Vb(25,"div",55),J.Vb(26,"div",56),J.Vb(27,"span",57),J.Lc(28),J.Ub(),J.Ub(),J.Vb(29,"input",58),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc().value=e}),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(30,"div",5),J.Vb(31,"div",46),J.Vb(32,"label",47),J.Lc(33,"Process"),J.Ub(),J.Qb(34,"input",53),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(35,"div",50),J.Vb(36,"button",59),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(37,"Close"),J.Ub(),J.Vb(38,"button",60),J.fc("click",function(){return J.Ec(i),J.jc().onClickCloneNewVersion()}),J.Lc(39,"Copy"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(13),J.pc("value",n.modelName),J.Cb(5),J.pc("value",n.modelNo),J.Cb(10),J.Mc(n.articleNoDefault),J.Cb(1),J.pc("ngModel",n.value),J.Cb(5),J.pc("value",n.artProcess)}}function Fi(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",39),J.Vb(1,"h4",40),J.Qb(2,"i",41),J.Lc(3," Clone BPFC "),J.Ub(),J.Vb(4,"button",42),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",43),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",44),J.Vb(8,"div",4),J.Vb(9,"div",5),J.Vb(10,"div",46),J.Vb(11,"ejs-dropdownlist",61,62),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc().changebpfcID=e})("filtering",function(e){return J.Ec(i),J.jc().onFilteringChangeBPFCModal(e)})("created",function(){return J.Ec(i),J.jc().created()})("select",function(e){return J.Ec(i),J.jc().onChangeBPFCModal(e)}),J.kc(13,"translate"),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(14,"div",50),J.Vb(15,"button",59),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(16,"Close"),J.Ub(),J.Vb(17,"button",60),J.fc("click",function(){return J.Ec(i),J.jc().onClickClone()}),J.Lc(18,"Copy"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(11),J.pc("dataSource",n.BPFCsForChangeModal)("ngModel",n.changebpfcID)("placeholder",J.lc(13,5,"Select a model"))("fields",n.fieldsBPFC)("allowFiltering",!0)}}new y.e({Accept:"application/json"});var Mi,Li=((Mi=function(i){t(l,i);var a=n(l);function l(e,t,i,n,o,r,c,u,d,h,g,f){var b;return s(this,l),(b=a.call(this)).modalNameService=e,b.alertify=t,b.userService=i,b.bPFCEstablishService=n,b.modalService=o,b.router=r,b.datePipe=c,b.spinner=u,b.articleNoService=d,b.dataService=h,b.http=g,b.route=f,b.pageSettings={pageCount:20,pageSizes:[50,100,150,200,"All"],pageSize:50},b.gridHeight=screen.height-100,b.users=[],b.modelName=null,b.modelNo=null,b.articleNo=null,b.articleNoNew=null,b.articleNoDefault=null,b.artProcess=null,b.value=null,b.modelNameID=0,b.modelNoID=0,b.articleNoID=0,b.artProcessID=0,b.BPFCID=0,b.baseUrl=O.a.apiUrlEC,b.textSearch=null,b.textSearchs=null,b.fieldsBPFCs={text:"name",value:"id"},b.sortSettings={columns:[{field:"articleNo",direction:"Ascending"}]},b.subscriptions=new pi.a,b.checkCode=!1,b.styleBtn={background:"#6c757d",boxShadow:"0 0 0 3px rgba(130, 138, 145, 0.5)",border:"1px solid #6c757d",margin:"0",borderColor:"#6c757d",borderRadius:"4px",color:"#fff"},b.toolbar=["Search",{text:"Undone",tooltipText:"Undone",prefixIcon:"fa fa-remove",id:"Undone"},{text:"Done",tooltipText:"Done",prefixIcon:"fa fa-check",id:"Done"},{text:"All",tooltipText:"All",prefixIcon:"fa fa-list",id:"All"},{text:"% of done",tooltipText:"% of done",prefixIcon:"",id:"percentageOfDone"}],b.fieldsBPFC={text:"name",value:"name",tooltip:"name",itemCreated:function(e){Object(m.h)(e.item,b.queryString,!0,"Contains")}},b.onFilteringChangeBPFCModal=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(b.BPFCs,t)},b.onFilteringArticleNO=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(b.articleNosData,t)},b.onFilteringModelNOClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(b.modelNOsDataClone,t)},b.Permission(b.route),b}return d(l,[{key:"ngOnInit",value:function(){var e=this;this.getAllUsers(),this.tab=this.route.snapshot.params.tab||"undone",this.onRouteChange();var t=JSON.parse(localStorage.getItem("level"));this.role=t,this.excelDownloadUrl="".concat(O.a.apiUrlEC,"ModelName/ExcelExport"),this.filterSettings={type:"Excel"},this.dataText=this.dataService.currentMessages.subscribe(function(t){e.textSearch=t,0!==t&&(e.searchOptions={fields:["modelName","modelNo","articleNo","approvedBy","artProcess"],operator:"contains",key:t||"",ignoreCase:!0})})}},{key:"getAllBPFC",value:function(){var e=this;this.bPFCEstablishService.filterByApprovedStatus().subscribe(function(t){if(e.bpfcDataSource=t.map(function(e){return{id:e.id,artProcess:e.artProcess,glues:e.glues,kinds:e.kinds,name:"".concat(e.modelName," - ").concat(e.modelNo," - ").concat(e.articleNo," - ").concat(e.artProcess)}}),e.isSTF=JSON.parse(localStorage.getItem("isSTF")),e.isSTF){var i=t.filter(function(e){return"STF"===e.artProcess}).map(function(e){return{id:e.id,artProcess:e.artProcess,glues:e.glues,kinds:e.kinds,name:"".concat(e.modelName," - ").concat(e.modelNo," - ").concat(e.articleNo," - ").concat(e.artProcess)}});e.BPFCs=Object.assign([],i),e.BPFCsForChangeModal=Object.assign([],i)}else{var n=t.filter(function(e){return"STF"!==e.artProcess}).map(function(e){return{id:e.id,artProcess:e.artProcess,glues:e.glues,kinds:e.kinds,name:"".concat(e.modelName," - ").concat(e.modelNo," - ").concat(e.articleNo," - ").concat(e.artProcess)}});e.BPFCs=Object.assign([],n),e.BPFCsForChangeModal=Object.assign([],n)}})}},{key:"created",value:function(){this.getAllBPFCForChangeModal()}},{key:"getAllBPFCForChangeModal",value:function(){}},{key:"onRouteChange",value:function(){var e=this;this.route.data.subscribe(function(t){void 0!==e.route.snapshot.params.keySearch&&(e.keySearch=e.route.snapshot.params.keySearch,e.tab=e.route.snapshot.params.tab,e.loadData())})}},{key:"ngOnDestroy",value:function(){this.dataText.unsubscribe()}},{key:"Permission",value:function(t){var i=t.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var n,a=o(this.functions);try{for(a.s();!(n=a.n()).done;){var l,r=n.value,c=[],s=o(r.childrens);try{for(s.s();!(l=s.n()).done;){var u=l.value,d=this.makeAction(u.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(g){s.e(g)}finally{s.f()}c.push.apply(c,e(this.toolbar));var h=c.filter(function(e,t,i){return t===i.indexOf(e)});this.toolbarOptions=h}}catch(g){a.e(g)}finally{a.f()}}},{key:"makeAction",value:function(e){switch(e){case vi.a.EXCEL_EXPORT:return["ExcelExport"];case vi.a.EXCEL_IMPORT:return["Excel Import"];default:return[void 0]}}},{key:"detail",value:function(e){return this.dataService.changeMessage(this.textSearch),this.router.navigate(["/ec/establish/bpfc-schedule/".concat(this.tab,"/detailv2/").concat(e.id)])}},{key:"onChangeArticleNo",value:function(e){e.isInteracted&&(this.articleNoID=e.itemData.id)}},{key:"onChangeDueDate",value:function(e){this.dueDate=e.value}},{key:"createdSearch",value:function(e){this.loadData();var t=this.gridObj.element,i=document.createElement("span");i.className="e-clear-icon",i.id=t.id+"clear",i.onclick=this.cancelBtnClick.bind(this),t.querySelector(".e-toolbar-item .e-input-group").appendChild(i),this.percentageOfDone=new v.a({cssClass:"e-tbar-btn e-tbtn-txt e-control e-lib",iconCss:""}),this.percentageOfDone.appendTo("#percentageOfDone"),this.keySearch&&(this.gridObj.searchSettings.key=this.keySearch)}},{key:"cancelBtnClick",value:function(e){this.gridObj.searchSettings.key="",this.gridObj.element.querySelector(".e-input-group.e-search .e-input").value=""}},{key:"getSearchText",value:function(){}},{key:"getArticleNoByModelNoID",value:function(e,t){var i=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){i.articleNosData=e.filter(function(e){return e.name!==t})})}},{key:"openPopupDropdownlist",value:function(){}},{key:"onBeforeRender",value:function(e,t,i){var n=this.tooltip.filter(function(e,t){return t===+i})[0];n.content="Loading...",n.dataBind(),this.bPFCEstablishService.getGlueByBPFCID(t.id).subscribe(function(e){n.content=e.join("<br>"),n.dataBind()})}},{key:"onClickCloneNewVersion",value:function(){null!==this.value&&(this.articleNoNew=this.articleNoDefault+this.value);var e={modelNameID:this.modelNameID,modelNOID:this.modelNoID,articleNOID:this.articleNoID,artProcessID:Number(this.artProcessID),bpfcID:this.BPFCID,name:this.articleNoNew,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.cloneNewVersion(e)}},{key:"cloneNewVersion",value:function(e){var t=this;this.findArticleNo(this.articleNoNew),null!==this.value?this.checkCode?this.modalNameService.cloneBPFC(e).subscribe(function(e){!0===e.status?(t.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng! <br> Copy succeeded!"),t.modalService.dismissAll(),t.getUndone(),t.gridObj.search(t.articleNoNew),t.value=null):(t.alertify.error("The BPFC exists!"),t.value=null)}):(this.alertify.error("The BPFC exists!"),this.value=null):(this.alertify.error("Version can not be Empty!"),this.value=null)}},{key:"findArticleNo",value:function(e){var t,i=o(this.data);try{for(i.s();!(t=i.n()).done;){if(t.value.articleNo===e){this.checkCode=!1;break}this.checkCode=!0}}catch(n){i.e(n)}finally{i.f()}}},{key:"onChangeBPFCModal",value:function(e){this.BPFCID=e.itemData.id}},{key:"onClickClone",value:function(){var e={modelNameID:this.modelNameID,modelNOID:this.modelNoID,articleNOID:this.articleNoID,artProcessID:Number(this.artProcessID),bpfcID:this.BPFCID,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}},{key:"clone",value:function(e){var t=this;this.alertify.confirm("Clone BPFC <br> Sao ch\xe9p BPFC","Are you sure you want to copy from this BPFC ?<br> B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p BPFC n\xe0y kh\xf4ng?",function(){t.modalNameService.cloneModelNameForBPFCShcedule(e).subscribe(function(e){!0===e.status?(t.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng! <br> Copy succeeded!"),t.getUndone(),t.gridObj.search(t.articleNoNew),t.modalService.dismissAll()):t.alertify.error("The BPFC exists!")})})}},{key:"openModalClone",value:function(e,t){this.modalReference=this.modalService.open(e,{size:"lg"}),this.getAllBPFC(),this.modelName=t.modelName,this.modelNo=t.modelNo,this.artProcess=t.artProcess,this.articleNo=t.articleNo,this.modelNameID=t.modelNameID,this.modelNoID=t.modelNoID,console.log(t),this.articleNoID=t.articleNoID,this.getArticleNoByModelNoID(this.modelNoID,t.articleNo),this.artProcessID="ASY"===t.artProcess?1:2}},{key:"openModal",value:function(e,t){this.modalReference=this.modalService.open(e,{size:"md",backdrop:"static",keyboard:!1}),this.BPFCID=t.id,this.modelName=t.modelName,this.modelNo=t.modelNo,this.articleNo=t.articleNo,this.artProcess=t.artProcess,this.articleNoNew=t.articleNo.split("-")[0]+"-T",this.articleNoDefault=t.articleNo.split("-")[0]+"-T",this.modelNameID=t.modelNameID,this.modelNoID=t.modelNoID,this.articleNoID=0,this.artProcessID="ASY"===t.artProcess?1:2}},{key:"actionBegin",value:function(e){var t=this;if("searching"===e.requestType&&(this.textSearch=e.searchString),"save"===e.requestType){var i={id:e.data.id,season:e.data.season},n=e.previousData.season;(null!==n||""!==n&&n!==e.data.season)&&this.bPFCEstablishService.updateSeason(i).subscribe(function(){t.alertify.success("Update season successfully"),t.getAllUsers()});var a={id:e.data.id,dueDate:this.dueDate},l=e.previousData.dueDate;"STF"===e.data.artProcess&&this.dueDate.toDateString()!==l&&null!=l&&this.bPFCEstablishService.updateDueDate(a).subscribe(function(){t.getAllUsers(),t.alertify.success("Update due date successfully")})}}},{key:"dataBound",value:function(e){}},{key:"toolbarClick",value:function(e){var t=this;switch(e.item.id){case"grid_Excel Import":this.showModal(this.importModal);break;case"Done":this.gridObj.searchSettings.key="",this.tab="done",this.router.navigate(["/ec/establish/bpfc-schedule/".concat(this.tab)]),this.getDone();break;case"Undone":this.gridObj.searchSettings.key="",this.tab="undone",this.router.navigate(["/ec/establish/bpfc-schedule/".concat(this.tab)]),this.getUndone();break;case"All":this.gridObj.searchSettings.key="",this.tab="all",this.router.navigate(["/ec/establish/bpfc-schedule/".concat(this.tab)]),this.getAll();break;case"grid_Excel Export":var i=this.data.map(function(e){return{approvedBy:e.approvedBy,approvalStatus:e.approvalStatus,createdBy:e.createdBy,articleNo:e.articleNo,createdDate:t.datePipe.transform(e.createdDate,"d MMM, yyyy HH:mm"),artProcess:e.artProcess,finishedStatus:!0===e.finishedStatus?"Yes":"No",modelName:e.modelName,modelNo:e.modelNo,season:e.season}});this.gridObj.excelExport({dataSource:i})}}},{key:"fileProgress",value:function(e){this.file=e.target.files[0]}},{key:"uploadFile",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.import(this.file,t).subscribe(function(t){e.getAll(),e.modalReference.close(),e.alertify.success("The excel has been imported into system!")})}},{key:"loadData",value:function(){switch(this.tab){case"undone":this.getUndone();break;case"done":this.getDone();break;case"all":this.getAll()}}},{key:"getAllUsers",value:function(){var e=this;this.userService.getAllUserInfo().subscribe(function(t){e.users=t,console.log("getAllUsers",e.users)})}},{key:"delete",value:function(e){var t=this;this.alertify.confirm("Delete BPFC",'Are you sure you want to delete this BPFC "'+e+'" ?',function(){t.bPFCEstablishService.delete(e).subscribe(function(e){t.alertify.success("Success"),t.getUndone()},function(e){t.alertify.warning(e)})})}},{key:"rowDB",value:function(e){e.data.dueDateStatus&&e.row.classList.add("bgcolor")}},{key:"editTextOfBtn",value:function(){var e=document.getElementById("All"),t=document.getElementById("Undone"),i=document.getElementById("Done");!0===this.isDone?(this.setAttrBtn(i),this.resetAttrBtn(t),this.resetAttrBtn(e)):!1===this.isDone?(this.setAttrBtn(t),this.resetAttrBtn(i),this.resetAttrBtn(e)):null===this.isDone&&(this.setAttrBtn(e),this.resetAttrBtn(i),this.resetAttrBtn(t))}},{key:"getAll",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.getAll().subscribe(function(t){e.data=t.map(function(t){var i;return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,createdDate:new Date(t.createdDate),articleNo:t.articleNo,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,dueDate:t.dueDate,dueDateStatus:t.dueDateStatus,approvedBy:null===(i=e.users.filter(function(e){return e.id===t.approvalBy})[0])||void 0===i?void 0:i.username,createdBy:t.createdBy,artProcess:t.artProcess,season:t.season}}),e.spinner.hide(),e.isDone=null,e.editTextOfBtn()})}},{key:"getDone",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.getDoneBPFC().subscribe(function(t){e.data=t.data.map(function(t){var i;return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,createdDate:new Date(t.createdDate),articleNo:t.articleNo,dueDate:t.dueDate,dueDateStatus:t.dueDateStatus,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,approvedBy:null===(i=e.users.filter(function(e){return e.id===t.approvalBy})[0])||void 0===i?void 0:i.username,createdBy:t.createdBy,artProcess:t.artProcess,season:t.season}}),e.percentageOfDoneData=t.percentageOfDone,e.percentageOfDone.element.innerHTML=e.percentageOfDoneData,e.doneText="Done (".concat(t.doneTotal,")"),e.undoneText="Undone (".concat(t.undoneTotal,")"),e.isDone=!0,e.editTextOfBtn(),e.spinner.hide()})}},{key:"getUndone",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.getUndoneBPFC().subscribe(function(t){e.data=t.data.map(function(t){var i;return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,createdDate:new Date(t.createdDate),articleNo:t.articleNo,dueDate:t.dueDate,dueDateStatus:t.dueDateStatus,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,approvedBy:null===(i=e.users.filter(function(e){return e.id===t.approvalBy})[0])||void 0===i?void 0:i.username,createdBy:t.createdBy,artProcess:t.artProcess,season:t.season}}),e.percentageOfDoneData=t.percentageOfDone,e.percentageOfDone.element.innerHTML=e.percentageOfDoneData,e.doneText="Done (".concat(t.doneTotal,")"),e.undoneText="Undone (".concat(t.undoneTotal,")"),e.isDone=!1,e.editTextOfBtn(),e.spinner.hide()})}},{key:"showModal",value:function(e){this.modalReference=this.modalService.open(e,{size:"xl"})}},{key:"NO",value:function(e){return(this.gridObj.pageSettings.currentPage-1)*this.gridObj.pageSettings.pageSize+Number(e)+1}},{key:"setAttrBtn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{background:"#6c757d",boxShadow:"0 0 0 3px rgba(130, 138, 145, 0.5)",border:"1px solid #6c757d",margin:"0",borderColor:"#6c757d",borderRadius:"4px",color:"#fff"};e.style.background=t.background,e.style.boxShadow=t.boxShadow,e.style.border=t.border,e.style.margin=t.margin,e.style.borderColor=t.borderColor,e.style.borderRadius=t.borderRadius,e.style.color=t.color}},{key:"resetAttrBtn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{background:"#f8f9fa",boxShadow:"none",border:"none",margin:"0",borderColor:"#f8f9fa",borderRadius:"none",color:"#495057"};e.style.background=t.background,e.style.boxShadow=t.boxShadow,e.style.border=t.border,e.style.margin=t.margin,e.style.borderColor=t.borderColor,e.style.borderRadius=t.borderRadius,e.style.color=t.color}}]),l}(fi.a)).\u0275fac=function(e){return new(e||Mi)(J.Pb(L.a),J.Pb(G.a),J.Pb(bi.a),J.Pb(j.a),J.Pb(f.b),J.Pb(V.c),J.Pb(c.e),J.Pb(h.c),J.Pb(ee),J.Pb(M.a),J.Pb(y.b),J.Pb(V.a))},Mi.\u0275cmp=J.Jb({type:Mi,selectors:[["app-BPFCSchedule"]],viewQuery:function(e,t){var i;1&e&&(J.Rc(Ii,1),J.Rc(yi,3),J.Rc(Ci,1)),2&e&&(J.Ac(i=J.gc())&&(t.gridObj=i.first),J.Ac(i=J.gc())&&(t.importModal=i.first),J.Ac(i=J.gc())&&(t.tooltip=i))},features:[J.Bb([c.e]),J.zb],decls:37,vars:10,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"card"],[1,"card-body","p-0"],[1,"row"],[1,"col-md-12"],["id","grid","allowSorting","true","allowResizing","true","allowPaging","true","allowFiltering","true","allowResizing","true","gridLines","Both","showColumnMenu","true",3,"dataSource","pageSettings","filterSettings","sortSettings","editSettings","toolbar","enablePersistence","allowExcelExport","searchSettings","rowDataBound","created","dataBound","toolbarClick","actionBegin"],["grid",""],["field","#","isPrimaryKey","true","textAlign","Center","headerText","#","width","40"],["template",""],["field","modelName","isPrimaryKey","true","textAlign","Left","headerText","Model Name"],["field","modelNo","isPrimaryKey","true","textAlign","Center","width","100","headerText","Model NO"],["field","articleNo","isPrimaryKey","true","textAlign","Center","width","150","headerText","Article NO"],["field","artProcess","isPrimaryKey","true","textAlign","Center","width","100","headerText","Process"],["field","dueDate","textAlign","Center","editType","datepickeredit","type","date","format","d MMM, yyyy","width","150","headerText","STF Date"],["editTemplate",""],["field","createdDate","isPrimaryKey","true","type","date","format","d MMM, yyyy HH:mm","headerText","Update Time","textAlign","Center"],["field","approvedBy","isPrimaryKey","true","textAlign","Center","width","150","headerText","Approval By Supervisor"],["field","season","textAlign","Center","width","100","headerText","Season"],["field","option","textAlign","Center","headerText","-- Option --","width","170"],[1,"card-footer"],["importModal",""],["newVersionModal",""],["cloneModal",""],["position","RightCenter","content","loading...",1,"fix-css",3,"beforeRender"],["tooltip",""],[4,"ngIf","ngIfElse"],["stf",""],["placeholder","Enter date",3,"value","change"],["ejs-button","","cssClass","e-info mr-2","appPermission","","appFunction","BPFC Schedule","appAction","EDIT",3,"click"],[1,"far","fa-edit"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CREATE","cssClass","e-primary mr-2",3,"click",4,"ngIf"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CLONE","cssClass","e-success mr-2",3,"click",4,"ngIf"],["ejs-button","","cssClass","e-danger","appPermission","","appFunction","BPFC Schedule","appAction","DELETE",3,"click"],[1,"fa","fa-trash"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CREATE","cssClass","e-primary mr-2",3,"click"],[1,"fa","fa-plus"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CLONE","cssClass","e-success mr-2",3,"click"],[1,"fa","fa-clone"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],[1,"form-group"],["for","Name"],[3,"href"],["name","file","type","file",1,"form-control",3,"change"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["type","text","name","","disabled","","required","required","title","",1,"form-control",3,"value"],[2,"color","red"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["id","basic-addon3",1,"input-group-text"],["type","text","id","basic-url","placeholder","Enter Version Ex: 1","aria-describedby","basic-addon3",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["popupHeight","300px","popupWidth","450px",3,"dataSource","ngModel","placeholder","fields","allowFiltering","ngModelChange","filtering","created","select"],["changeBPFCDroupdownlist",""]],template:function(e,t){1&e&&(J.Vb(0,"ngx-spinner",0),J.Vb(1,"p",1),J.Lc(2,"Loading data..."),J.Ub(),J.Ub(),J.Vb(3,"div",2),J.Vb(4,"div",3),J.Vb(5,"div",4),J.Vb(6,"div",5),J.Vb(7,"ejs-grid",6,7),J.fc("rowDataBound",function(e){return t.rowDB(e)})("created",function(e){return t.createdSearch(e)})("dataBound",function(e){return t.dataBound(e)})("toolbarClick",function(e){return t.toolbarClick(e)})("actionBegin",function(e){return t.actionBegin(e)}),J.Vb(9,"e-columns"),J.Vb(10,"e-column",8),J.Jc(11,Ni,1,1,"ng-template",null,9,J.Kc),J.Ub(),J.Vb(13,"e-column",10),J.Jc(14,Si,3,1,"ng-template",null,9,J.Kc),J.Ub(),J.Qb(16,"e-column",11),J.Qb(17,"e-column",12),J.Qb(18,"e-column",13),J.Vb(19,"e-column",14),J.Jc(20,wi,2,4,"ng-template",null,9,J.Kc),J.Jc(22,Bi,3,2,"ng-template",null,15,J.Kc),J.Ub(),J.Qb(24,"e-column",16),J.Qb(25,"e-column",17),J.Qb(26,"e-column",18),J.Vb(27,"e-column",19),J.Jc(28,Ui,6,2,"ng-template",null,9,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Qb(30,"div",20),J.Ub(),J.Jc(31,Ei,22,1,"ng-template",null,21,J.Kc),J.Jc(33,Vi,40,5,"ng-template",null,22,J.Kc),J.Jc(35,Fi,19,7,"ng-template",null,23,J.Kc)),2&e&&(J.pc("fullScreen",!0),J.Cb(7),J.pc("dataSource",t.data)("pageSettings",t.pageSettings)("filterSettings",t.filterSettings)("sortSettings",t.sortSettings)("editSettings",t.editSettings)("toolbar",t.toolbarOptions)("enablePersistence",!0)("allowExcelExport",!0)("searchSettings",t.searchOptions))},directives:[h.a,k.j,p.d,A.d,A.b,k.e,k.b,p.c,A.c,A.a,k.d,k.a,S.c,c.n,D.a,v.b,Di.a,u.a,u.f,u.i,m.c],pipes:[c.e,C.c],styles:[".active-btn[_ngcontent-%COMP%]{background-color:#00000073!important;color:#fff!important}.bgcolor[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fa7c7c}"]}),Mi);new y.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});var Gi,Ti=((Gi=function(){function e(t){s(this,e),this.http=t,this.baseUrl=O.a.apiUrlEC,this.messageSource=new H.a(0),this.currentMessage=this.messageSource.asObservable()}return d(e,[{key:"changeMessage",value:function(e){this.messageSource.next(e)}},{key:"getAllComments",value:function(){return this.http.get(this.baseUrl+"Comment/GetAll",{})}},{key:"getAllCommentByBPFCEstablishID",value:function(e){return this.http.get("".concat(this.baseUrl,"Comment/GetAllCommentByBPFCEstablishID/").concat(e),{})}},{key:"create",value:function(e){return this.http.post(this.baseUrl+"Comment/Create",e)}},{key:"update",value:function(e){return this.http.put(this.baseUrl+"Comment/Update",e)}},{key:"delete",value:function(e){return this.http.delete(this.baseUrl+"Comment/Delete/"+e)}}]),e}()).\u0275fac=function(e){return new(e||Gi)(J.cc(y.b))},Gi.\u0275prov=J.Lb({token:Gi,factory:Gi.\u0275fac,providedIn:"root"}),Gi),Oi=l("7FIR"),ji=["gridModel"];function Ji(e,t){if(1&e&&J.Lc(0),2&e){var i=t.$implicit,n=J.jc();J.Nc(" ",n.no(i)," ")}}function Ri(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"CREATED_DATETIME_LABEL")," ")}function Ki(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"PIC_LABEL")," ")}function $i(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"FINISH_LABEL")," ")}function Qi(e,t){1&e&&(J.Vb(0,"span",23),J.Lc(1,"YES"),J.Ub())}function Hi(e,t){1&e&&(J.Vb(0,"span",24),J.Lc(1,"No"),J.Ub())}function _i(e,t){if(1&e&&(J.Jc(0,Qi,2,0,"span",21),J.Jc(1,Hi,2,0,"span",22)),2&e){var i=t.$implicit;J.pc("ngIf",1==i.finishedStatus),J.Cb(1),J.pc("ngIf",0==i.finishedStatus)}}function Wi(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"APPROVAL_STATUS_LABEL")," ")}function qi(e,t){1&e&&(J.Vb(0,"span",24),J.Lc(1,"YET"),J.Ub())}function zi(e,t){1&e&&(J.Vb(0,"span",26),J.Lc(1,"NG"),J.Ub())}function Xi(e,t){1&e&&(J.Vb(0,"span",23),J.Lc(1,"OK"),J.Ub())}function Yi(e,t){if(1&e&&(J.Jc(0,qi,2,0,"span",22),J.Jc(1,zi,2,0,"span",25),J.Jc(2,Xi,2,0,"span",21)),2&e){var i=t.$implicit;J.pc("ngIf",0==i.approvalStatus&&"#N/A"===i.approvalBy),J.Cb(1),J.pc("ngIf",0==i.finishedStatus&&0==i.approvalStatus&&"#N/A"!==i.approvalBy),J.Cb(1),J.pc("ngIf",1==i.approvalStatus&&"#N/A"!==i.approvalBy)}}function Zi(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"APPROVAL_BY_LABEL")," ")}function en(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"DETAIL_LABEL")," ")}function tn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",27),J.fc("click",function(){J.Ec(i);var e=t.$implicit,n=J.jc(),a=J.Bc(41);return n.openModalDetail(a,e.id)}),J.Qb(1,"i",28),J.Ub()}}function nn(e,t){if(1&e&&(J.Vb(0,"div",65),J.Lc(1),J.Ub()),2&e){var i=t.$implicit;J.qc("title",i.name),J.Cb(1),J.Nc(" ",i.name," ")}}function an(e,t){1&e&&(J.Vb(0,"div"),J.Qb(1,"i",66),J.Ub())}function ln(e,t){if(1&e&&(J.Vb(0,"span"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit;J.Cb(1),J.Nc("\xb1 ",i.allow,"")}}function on(e,t){if(1&e&&(J.Vb(0,"li",67),J.Vb(1,"a",68),J.Qb(2,"img",69),J.Ub(),J.Vb(3,"div",70),J.Vb(4,"span",71),J.Vb(5,"small",72),J.Lc(6),J.Ub(),J.Ub(),J.Vb(7,"strong",73),J.Lc(8),J.Ub(),J.Vb(9,"p"),J.Lc(10),J.Ub(),J.Ub(),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Cb(6),J.Nc(" ",n.datetime(i.createdDate),""),J.Cb(2),J.Nc(" ",n.username(i.createdBy),""),J.Cb(2),J.Nc(" ",i.content," ")}}function rn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",29),J.Vb(1,"h4",30),J.Qb(2,"i",31),J.Lc(3," BPFC Detail "),J.Ub(),J.Vb(4,"button",32),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",33),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",34),J.Vb(8,"div",2),J.Vb(9,"div",35),J.Vb(10,"ejs-grid",36,37),J.fc("rowSelected",function(e){return J.Ec(i),J.jc().rowSelected(e)}),J.Vb(12,"e-columns"),J.Vb(13,"e-column",38),J.Jc(14,nn,2,2,"ng-template",null,8,J.Kc),J.Ub(),J.Qb(16,"e-column",39),J.Qb(17,"e-column",40),J.Qb(18,"e-column",41),J.Qb(19,"e-column",42),J.Qb(20,"e-column",43),J.Qb(21,"e-column",44),J.Ub(),J.Ub(),J.Ub(),J.Vb(22,"div",35),J.Vb(23,"ejs-grid",45,46),J.Vb(25,"e-columns"),J.Qb(26,"e-column",47),J.Qb(27,"e-column",48),J.Qb(28,"e-column",49),J.Vb(29,"e-column",50),J.Jc(30,an,2,0,"ng-template",null,14,J.Kc),J.Jc(32,ln,2,1,"ng-template",null,8,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(34,"div",51),J.Vb(35,"button",52),J.fc("click",function(){return J.Ec(i),J.jc().release()}),J.Lc(36,"Release"),J.Ub(),J.Vb(37,"button",53),J.fc("click",function(){return J.Ec(i),J.jc().reject()}),J.Lc(38,"Reject"),J.Ub(),J.Vb(39,"button",54),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(40,"Close"),J.Ub(),J.Ub(),J.Vb(41,"div",34),J.Vb(42,"div",2),J.Vb(43,"div",3),J.Vb(44,"div",55),J.Vb(45,"div",56),J.Vb(46,"div",57),J.Vb(47,"div",58),J.Vb(48,"div",59),J.Vb(49,"textarea",60),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc().content=e}),J.Ub(),J.Qb(50,"br"),J.Vb(51,"button",61),J.fc("click",function(){return J.Ec(i),J.jc().createComment()}),J.Lc(52,"Post"),J.Ub(),J.Qb(53,"div",62),J.Qb(54,"hr"),J.Vb(55,"ul",63),J.Jc(56,on,11,3,"li",64),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(10),J.pc("dataSource",n.glues)("selectedRowIndex",0),J.Cb(13),J.pc("dataSource",n.ingredients)("allowSorting",!0),J.Cb(26),J.pc("ngModel",n.content),J.Cb(7),J.pc("ngForOf",n.comments)}}var cn,sn=((cn=function(i){t(l,i);var a=n(l);function l(e,t,i,n,o,r,c,u,d,h,g){var m;return s(this,l),(m=a.call(this)).modalNameService=e,m.bPFCEstablishService=t,m.modalService=i,m.alertify=n,m.ingredientService=o,m.glueService=r,m.commentService=c,m.calendarsService=u,m.userService=d,m.spinner=h,m.route=g,m.users=[],m.data=[],m.searchSettings={hierarchyMode:"Parent"},m.ingredients=[],m.glues=[],m.modalname={id:0,name:"",modelNo:"",createdBy:JSON.parse(localStorage.getItem("user")).user.id},m.toolbar=["Default",{text:"Rejected",tooltipText:"Rejected",prefixIcon:"fa fa-times",id:"Rejected"},{text:"Approved",tooltipText:"Approved",prefixIcon:"fa fa-check",id:"Approved"},"All","Search"],m}return d(l,[{key:"ngOnInit",value:function(){this.tab="Default",this.Permission(this.route),this.pageSettings={pageSizes:!0,currentPage:1,pageSize:10,pageCount:20},this.editparams={params:{popupHeight:"300px"}}}},{key:"Permission",value:function(t){var i=t.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var n,a=o(this.functions);try{for(a.s();!(n=a.n()).done;){var l,r=n.value,c=[],s=o(r.childrens);try{for(s.s();!(l=s.n()).done;){var u=l.value,d=this.makeAction(u.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(g){s.e(g)}finally{s.f()}c.push.apply(c,e(this.toolbar));var h=c.filter(function(e,t,i){return t===i.indexOf(e)});this.toolbarOptions=h}}catch(g){a.e(g)}finally{a.f()}}},{key:"makeAction",value:function(e){switch(e){case vi.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}},{key:"ngAfterViewInit",value:function(){var e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}},{key:"getBuilding",value:function(){JSON.parse(localStorage.getItem("user"))}},{key:"createdSearch",value:function(e){this.getAllUsers()}},{key:"loadData",value:function(){switch(this.tab){case"Approved":this.filterByApprovedStatus();break;case"Rejected":this.filterRejected();break;case"All":this.getAllBPFCStatus();break;case"Default":this.defaultFilter()}}},{key:"dataBound",value:function(){this.gridModel.autoFitColumns()}},{key:"no",value:function(e){return(this.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(e.index)+1}},{key:"actionBegin",value:function(e){"save"===e.requestType&&(this.modalname.id=e.data.id||0,this.modalname.name=e.data.name,this.modalname.modelNo=e.data.modelNo,e.data.id>0?this.update(this.modalname):this.add(this.modalname)),"delete"===e.requestType&&this.delete(e.data[0].id)}},{key:"actionComplete",value:function(e){"add"===e.requestType&&(e.form.elements.namedItem("name").focus(),e.form.elements.namedItem("id").disabled=!0,e.form.elements.namedItem("tool").disabled=!0)}},{key:"onDoubleClick",value:function(e){this.setFocus=e.column}},{key:"openaddModalName",value:function(e){this.modalReference=this.modalService.open(e)}},{key:"getAllBPFCStatus",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.getAllBPFCStatus().subscribe(function(t){e.data=t.map(function(t){return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,articleNo:t.articleNo,artProcess:t.artProcess,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,approvalBy:e.createdBy(t.approvalBy),createdBy:e.createdBy(t.createdBy),season:t.season,createdDate:t.createdDate,modifiedDate:t.modifiedDate,updateTime:t.updateTime,bpfcName:"".concat(t.modelName," - ").concat(t.modelNo," - ").concat(t.articleNo," - ").concat(t.artProcess)}}),e.editTextOfBtn(),e.spinner.hide()},function(){return e.spinner.hide()})}},{key:"filterRejected",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.rejectedFilter().subscribe(function(t){e.data=t.map(function(t){return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,articleNo:t.articleNo,artProcess:t.artProcess,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,approvalBy:e.createdBy(t.approvalBy),createdBy:e.createdBy(t.createdBy),season:t.season,createdDate:t.createdDate,modifiedDate:t.modifiedDate,updateTime:t.updateTime,bpfcName:"".concat(t.modelName," - ").concat(t.modelNo," - ").concat(t.articleNo," - ").concat(t.artProcess)}}),e.editTextOfBtn(),e.spinner.hide()},function(){return e.spinner.hide()})}},{key:"filterByApprovedStatus",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.filterByApprovedStatus().subscribe(function(t){e.data=t.map(function(t){return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,articleNo:t.articleNo,artProcess:t.artProcess,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,approvalBy:e.createdBy(t.approvalBy),createdBy:e.createdBy(t.createdBy),season:t.season,createdDate:t.createdDate,modifiedDate:t.modifiedDate,updateTime:t.updateTime,bpfcName:"".concat(t.modelName," - ").concat(t.modelNo," - ").concat(t.articleNo," - ").concat(t.artProcess)}}),e.editTextOfBtn(),e.spinner.hide()},function(){return e.spinner.hide()})}},{key:"filterByFinishedStatus",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.filterByFinishedStatus().subscribe(function(t){e.data=t.map(function(t){return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,articleNo:t.articleNo,artProcess:t.artProcess,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,approvalBy:e.createdBy(t.approvalBy),createdBy:e.createdBy(t.createdBy),season:t.season,createdDate:t.createdDate,modifiedDate:t.modifiedDate,updateTime:t.updateTime,bpfcName:"".concat(t.modelName," - ").concat(t.modelNo," - ").concat(t.articleNo," - ").concat(t.artProcess)}}),e.editTextOfBtn(),e.spinner.hide()},function(){return e.spinner.hide()})}},{key:"defaultFilter",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.defaultFilter().subscribe(function(t){e.data=t.map(function(t){return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,articleNo:t.articleNo,artProcess:t.artProcess,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,approvalBy:e.createdBy(t.approvalBy),createdBy:e.createdBy(t.createdBy),season:t.season,createdDate:t.createdDate,modifiedDate:t.modifiedDate,updateTime:t.updateTime,bpfcName:"".concat(t.modelName," - ").concat(t.modelNo," - ").concat(t.articleNo," - ").concat(t.artProcess)}}),e.editTextOfBtn(),e.spinner.hide()},function(){return e.spinner.hide()})}},{key:"filterByNotApprovedStatus",value:function(){var e=this;this.spinner.show(),this.bPFCEstablishService.filterByNotApprovedStatus().subscribe(function(t){e.data=t.map(function(t){return{id:t.id,modelNameID:t.modelNameID,modelNoID:t.modelNoID,articleNoID:t.articleNoID,artProcessID:t.artProcessID,modelName:t.modelName,modelNo:t.modelNo,articleNo:t.articleNo,artProcess:t.artProcess,approvalStatus:t.approvalStatus,finishedStatus:t.finishedStatus,approvalBy:e.createdBy(t.approvalBy),createdBy:e.createdBy(t.createdBy),season:t.season,createdDate:t.createdDate,modifiedDate:t.modifiedDate,updateTime:t.updateTime,bpfcName:"".concat(t.modelName," - ").concat(t.modelNo," - ").concat(t.articleNo," - ").concat(t.artProcess)}}),e.spinner.hide()},function(){return e.spinner.hide()})}},{key:"update",value:function(e){var t=this;this.modalNameService.update(e).subscribe(function(){t.alertify.success("Update Modal Name Successfully")})}},{key:"delete",value:function(e){var t=this;this.alertify.confirm("Delete Modal Name",'Are you sure you want to delete this ModalName ID "'+e+'" ?',function(){t.modalNameService.delete(e).subscribe(function(){t.getAllBPFCStatus(),t.alertify.success("Modal Name has been deleted")})})}},{key:"add",value:function(e){var t=this;this.modalNameService.create(e).subscribe(function(){t.alertify.success("Add Modal Name Successfully"),t.getAllBPFCStatus()})}},{key:"approval",value:function(e){var t=this,i=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(e,i).subscribe(function(){t.alertify.success("The model name - model no has been approved!"),t.getAllBPFCStatus()})}},{key:"done",value:function(e){var t=this,i=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(e,i).subscribe(function(){t.alertify.success("The model name - model no has been finished!"),t.getAllBPFCStatus()})}},{key:"release",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.release(this.BPFCEstablishID,t).subscribe(function(){e.alertify.success("The model name - model no has been released!"),e.filterByApprovedStatus(),e.modalReferenceDetail.close()})}},{key:"reject",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.reject(this.BPFCEstablishID,t).subscribe(function(t){if(!0===t.status){e.alertify.success(t.message),e.filterByNotApprovedStatus(),e.modalReferenceDetail.close();var i=e.users.filter(function(e){return e.ID===t.userId})[0].Email||"";e.bPFCEstablishService.sendMailForPIC(i).subscribe(function(){})}else e.alertify.error(t.message)})}},{key:"openModalDetail",value:function(e,t){var i=this;this.modalReferenceDetail=this.modalService.open(e,{size:"xxl"}),setTimeout(function(){i.getAllGluesByBPFCID(t)},300),this.BPFCEstablishID=t,this.getComments()}},{key:"sortBySup",value:function(e){var t=this;this.ingredientService.sortBySup(e,0).subscribe(function(e){t.ingredients=e.list1})}},{key:"getAllGluesByBPFCID",value:function(e){var t=this;this.glueService.getAllGluesByBPFCID(e).subscribe(function(e){t.glues=e.map(function(e){return{chemical:e.chemical,code:e.code,consumption:e.consumption,createdBy:t.createdBy(e.createdBy),createdDate:e.createdDate,expiredTime:e.expiredTime,glueID:e.glueID,glueName:e.glueName,id:e.id,ingredients:e.ingredients,materialName:e.materialName,materialNameID:e.materialNameID,modelNameID:e.modelNameID,modelNo:e.modelNo,modelNoID:e.modelNoID,name:e.name,partNameID:e.partNameID,pathName:e.pathName,bpfcName:"".concat(e.modelName," - ").concat(e.modelNo," - ").concat(e.articleNo," - ").concat(e.artProcess)}}),0===t.glues.length?t.glueid=0:(t.glueid=t.glues[0].id,t.sortBySup(t.glueid))})}},{key:"rowSelected",value:function(e){this.sortBySup(e.data.id)}},{key:"toolbarClick",value:function(e){switch(e.item.id){case"Approved":this.tab="Approved",this.filterByApprovedStatus();break;case"Rejected":this.tab="Rejected",this.filterRejected();break;case"grid_All":this.tab="All",this.getAllBPFCStatus();break;case"Excel Export":this.gridModel.excelExport();break;case"grid_Default":this.tab="Default",this.defaultFilter()}}},{key:"getAllUsers",value:function(){var e=this;this.userService.getAllUserInfo().subscribe(function(t){e.users=t,e.loadData()})}},{key:"createComment",value:function(){var e=this;this.comment={id:0,content:this.content,createdBy:JSON.parse(localStorage.getItem("user")).user.id,createdByName:"",BPFCEstablishID:this.BPFCEstablishID,createdDate:new Date},this.commentService.create(this.comment).subscribe(function(){e.alertify.success("The comment has been created!"),e.content="",e.getComments()})}},{key:"updateComment",value:function(){var e=this;this.commentService.update(this.comment).subscribe(function(){e.alertify.success("The comment has been updated!"),e.getComments()})}},{key:"deleteComment",value:function(){var e=this;this.commentService.delete(this.comment.id).subscribe(function(){e.alertify.success("The comment has been deleted!"),e.getComments()})}},{key:"getComments",value:function(){var e=this;this.commentService.getAllCommentByBPFCEstablishID(this.BPFCEstablishID).subscribe(function(t){e.comments=t})}},{key:"datetime",value:function(e){return this.calendarsService.JSONDateWithTime(e)}},{key:"username",value:function(e){return this.users.filter(function(t){return t.id===e})[0].username}},{key:"createdBy",value:function(e){if(0===e)return"#N/A";var t=this.users.filter(function(t){return t.id===e})[0];return void 0!==t?t.username:"#N/A"}},{key:"editTextOfBtn",value:function(){var e=document.getElementById("grid_All"),t=document.getElementById("grid_Default"),i=document.getElementById("Rejected"),n=document.getElementById("Approved");switch(this.tab){case"All":this.setAttrBtn(e),this.resetAttrBtn(t),this.resetAttrBtn(i),this.resetAttrBtn(n);break;case"Default":this.setAttrBtn(t),this.resetAttrBtn(e),this.resetAttrBtn(i),this.resetAttrBtn(n);break;case"Rejected":this.setAttrBtn(i),this.resetAttrBtn(t),this.resetAttrBtn(e),this.resetAttrBtn(n);break;case"Approved":this.setAttrBtn(n),this.resetAttrBtn(i),this.resetAttrBtn(t),this.resetAttrBtn(e)}}},{key:"setAttrBtn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{background:"#6c757d",boxShadow:"0 0 0 3px rgba(130, 138, 145, 0.5)",border:"1px solid #6c757d",margin:"0",borderColor:"#6c757d",borderRadius:"4px",color:"#fff"};e.style.background=t.background,e.style.boxShadow=t.boxShadow,e.style.border=t.border,e.style.margin=t.margin,e.style.borderColor=t.borderColor,e.style.borderRadius=t.borderRadius,e.style.color=t.color}},{key:"resetAttrBtn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{background:"#f8f9fa",boxShadow:"none",border:"none",margin:"0",borderColor:"#f8f9fa",borderRadius:"none",color:"#495057"};e.style.background=t.background,e.style.boxShadow=t.boxShadow,e.style.border=t.border,e.style.margin=t.margin,e.style.borderColor=t.borderColor,e.style.borderRadius=t.borderRadius,e.style.color=t.color}}]),l}(fi.a)).\u0275fac=function(e){return new(e||cn)(J.Pb(L.a),J.Pb(j.a),J.Pb(f.b),J.Pb(G.a),J.Pb(R.a),J.Pb(Z.a),J.Pb(Ti),J.Pb(Oi.a),J.Pb(bi.a),J.Pb(h.c),J.Pb(V.a))},cn.\u0275cmp=J.Jb({type:cn,selectors:[["app-bpfc-status"]],viewQuery:function(e,t){var i;1&e&&J.Rc(ji,1),2&e&&J.Ac(i=J.gc())&&(t.gridModel=i.first)},features:[J.zb],decls:42,vars:6,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row"],[1,"col-md-12"],[1,"card"],["id","grid","allowPaging","true","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"searchSettings","toolbar","dataSource","allowExcelExport","pageSettings","dataBound","toolbarClick","actionBegin","recordDoubleClick","actionComplete","created"],["gridModel",""],["field","","headerText","#","isPrimaryKey","true","width","40","textAlign","Center","isPrimaryKey","true"],["template",""],["field","modelName","isPrimaryKey","true","textAlign","Center","headerText","Model Name","width","130"],["field","modelNo","isPrimaryKey","true","textAlign","Center","headerText","Model No","width","104"],["field","articleNo","isPrimaryKey","true","textAlign","Center","headerText","Article #","width","97"],["field","artProcess","isPrimaryKey","true","textAlign","Center","headerText","Process","width","97"],["field","createdDate","headerText","Created Date Time","type","date","format","dd MMM, yyyy HH:mm","width","155","textAlign","Center"],["headerTemplate",""],["field","createdBy","headerText","PIC","width","90","textAlign","Center"],["field","finishedStatus","isPrimaryKey","true","headerText","Finished","width","130","textAlign","Center"],["field","approvalStatus","isPrimaryKey","true","headerText","Approval Status","width","130","textAlign","Center"],["field","approvalBy","headerText","Approval By","width","100","textAlign","Center"],["field","tool","isPrimaryKey","true","headerText","Detail","width","70","textAlign","Center"],["detailModal",""],["class","badge badge-success",4,"ngIf"],["class","badge badge-danger",4,"ngIf"],[1,"badge","badge-success"],[1,"badge","badge-danger"],["class","badge badge-warning",4,"ngIf"],[1,"badge","badge-warning"],["ejs-button","","cssClass","e-info",3,"click"],[1,"fa","fa-eye"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],["showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both","height","250px",3,"dataSource","selectedRowIndex","rowSelected"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","finishedDate","headerText","Created Date Time","type","date","format","d MMM, yyyy HH:mm","width","150","textAlign","Center"],["field","finishedBy","headerText","PIC","width","100","textAlign","Center"],["field","modelNo","headerText","Kind","textAlign","Center","width","150"],["field","pathName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both","height","250px",3,"dataSource","allowSorting"],["grid",""],["field","position","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","150","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","70"],["field","allow","headerText","Allow (%)","textAlign","Center","width","70"],[1,"modal-footer"],["type","submit","appPermission","","appFunction","BPFC Status","appAction","RELEASE",1,"btn","btn-success",3,"click"],["type","submit","appPermission","","appFunction","BPFC Status","appAction","REJECT",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"row","bootstrap","snippets"],[1,"col-md-12","col-md-offset-2","col-sm-12"],[1,"comment-wrapper"],[1,"panel","panel-info"],[1,"panel-body"],["placeholder","write a comment...","rows","3",1,"form-control",3,"ngModel","ngModelChange"],["type","button","appPermission","","appFunction","BPFC Status","appAction","POST",1,"btn","btn-info","pull-right",3,"click"],[1,"clearfix"],[1,"media-list",2,"padding","0"],["class","media",4,"ngFor","ngForOf"],["data-toggle","tooltip","data-placement","top",3,"title"],[1,"fas","fa-exclamation-circle"],[1,"media"],["href","#",1,"pull-left"],["src","../../../../assets/img/logo-1.png","alt","",1,"img-circle"],[1,"media-body","ml-1"],[1,"text-muted","pull-right"],[1,"text-muted"],[1,"text-success"]],template:function(e,t){1&e&&(J.Vb(0,"ngx-spinner",0),J.Vb(1,"p",1),J.Lc(2,"Loading data..."),J.Ub(),J.Ub(),J.Vb(3,"div",2),J.Vb(4,"div",3),J.Vb(5,"div",4),J.Vb(6,"ejs-grid",5,6),J.fc("dataBound",function(){return t.dataBound()})("toolbarClick",function(e){return t.toolbarClick(e)})("actionBegin",function(e){return t.actionBegin(e)})("recordDoubleClick",function(e){return t.onDoubleClick(e)})("actionComplete",function(e){return t.actionComplete(e)})("created",function(e){return t.createdSearch(e)}),J.Vb(8,"e-columns"),J.Vb(9,"e-column",7),J.Jc(10,Ji,1,1,"ng-template",null,8,J.Kc),J.Ub(),J.Qb(12,"e-column",9),J.Qb(13,"e-column",10),J.Qb(14,"e-column",11),J.Qb(15,"e-column",12),J.Vb(16,"e-column",13),J.Jc(17,Ri,2,3,"ng-template",null,14,J.Kc),J.Ub(),J.Vb(19,"e-column",15),J.Jc(20,Ki,2,3,"ng-template",null,14,J.Kc),J.Ub(),J.Vb(22,"e-column",16),J.Jc(23,$i,2,3,"ng-template",null,14,J.Kc),J.Jc(25,_i,2,2,"ng-template",null,8,J.Kc),J.Ub(),J.Vb(27,"e-column",17),J.Jc(28,Wi,2,3,"ng-template",null,14,J.Kc),J.Jc(30,Yi,3,3,"ng-template",null,8,J.Kc),J.Ub(),J.Vb(32,"e-column",18),J.Jc(33,Zi,2,3,"ng-template",null,14,J.Kc),J.Ub(),J.Vb(35,"e-column",19),J.Jc(36,en,2,3,"ng-template",null,14,J.Kc),J.Jc(38,tn,2,0,"ng-template",null,8,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Jc(40,rn,57,6,"ng-template",null,20,J.Kc),J.Ub()),2&e&&(J.pc("fullScreen",!0),J.Cb(6),J.pc("searchSettings",t.searchSettings)("toolbar",t.toolbar)("dataSource",t.data)("allowExcelExport",!0)("pageSettings",t.pageSettings))},directives:[h.a,k.j,p.d,A.d,A.b,k.e,k.b,p.c,A.c,A.a,k.d,k.a,c.n,v.b,Di.a,u.a,u.f,u.i,c.m],pipes:[C.c],styles:["body[_ngcontent-%COMP%]{margin-top:20px}.comment-wrapper[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{max-height:650px;overflow:auto}.comment-wrapper[_ngcontent-%COMP%]   .media-list[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;border:2px solid #e5e7e8}.comment-wrapper[_ngcontent-%COMP%]   .media-list[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]{border-bottom:1px dashed #efefef;margin-bottom:25px}.e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}"]}),cn),un=["doneSwitch"],dn=["approvalSwitch"],hn=["gridglue"],gn=["grid2"],mn=["modelNameDropdownlist"],fn=["modelNoDropdownlist"],bn=["chemicalDropdownlist"],pn=["grid"],vn=["positionDropdownlist"];function Dn(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"GLUE")," ")}function In(e,t){if(1&e&&(J.Vb(0,"div",30),J.Lc(1),J.Ub()),2&e){var i=t.$implicit;J.qc("title",i.name),J.Cb(1),J.Nc(" ",i.name," ")}}function yn(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"CONSUMPTION")," ")}function Cn(e,t){if(1&e&&(J.Vb(0,"span"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(2);J.Eb(n.changeConsumptionColor(i)),J.Cb(1),J.Mc(""===i.consumption?"0":i.consumption)}}function Nn(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"EXPIRED_TIME")," ")}function Sn(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"KIND")," ")}function wn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",31,32),J.fc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangeKindEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.kinds)("ngModel",n.kindName)("fields",a.fieldsKindEdit)("allowFiltering",!0)}}function kn(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"PART")," ")}function Pn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",33,32),J.fc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangePartEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.parts)("ngModel",n.partName)("fields",a.fieldsPartEdit)("allowFiltering",!0)}}function Bn(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"MATERIAL")," ")}function An(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",33,32),J.fc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(e){return J.Ec(i),J.jc(2).onChangeMaterialEdit(e)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.pc("dataSource",a.materials)("ngModel",n.materialName)("fields",a.fieldsMaterialEdit)("allowFiltering",!0)}}function xn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",18),J.Vb(1,"ejs-grid",19,20),J.fc("rowDeselected",function(e){return J.Ec(i),J.jc().rowDeselected(e)})("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginGlue(e)})("rowSelected",function(e){return J.Ec(i),J.jc().rowSelected(e)})("created",function(){return J.Ec(i),J.jc().onCreatedGridGlue()})("toolbarClick",function(e){return J.Ec(i),J.jc().toolbarClick(e)})("dataBound",function(){return J.Ec(i),J.jc().dataBoundGlue()}),J.Vb(3,"e-columns"),J.Vb(4,"e-column",21),J.Jc(5,Dn,2,3,"ng-template",null,22,J.Kc),J.Jc(7,In,2,2,"ng-template",null,23,J.Kc),J.Ub(),J.Vb(9,"e-column",24),J.Jc(10,yn,2,3,"ng-template",null,22,J.Kc),J.Jc(12,Cn,2,3,"ng-template",null,23,J.Kc),J.Ub(),J.Vb(14,"e-column",25),J.Jc(15,Nn,2,3,"ng-template",null,22,J.Kc),J.Ub(),J.Vb(17,"e-column",26),J.Jc(18,Sn,2,3,"ng-template",null,22,J.Kc),J.Jc(20,wn,2,4,"ng-template",null,27,J.Kc),J.Ub(),J.Vb(22,"e-column",28),J.Jc(23,kn,2,3,"ng-template",null,22,J.Kc),J.Jc(25,Pn,2,4,"ng-template",null,27,J.Kc),J.Ub(),J.Vb(27,"e-column",29),J.Jc(28,Bn,2,3,"ng-template",null,22,J.Kc),J.Jc(30,An,2,4,"ng-template",null,27,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(1),J.pc("dataSource",n.glues)("editSettings",n.editSettings)("toolbar",n.toolbar)("allowSorting",!0)("selectedRowIndex",n.rowIndex)}}function Un(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",34),J.Vb(1,"button",35),J.fc("click",function(){return J.Ec(i),J.jc().back()}),J.Qb(2,"i",36),J.Lc(3),J.kc(4,"translate"),J.Ub(),J.Vb(5,"button",37),J.Qb(6,"i",38),J.Lc(7," Reset "),J.Ub(),J.Vb(8,"ejs-switch",39,40),J.fc("click",function(){return J.Ec(i),J.jc().done()})("checkedChange",function(e){return J.Ec(i),J.jc().createdStatus=e}),J.kc(10,"translate"),J.kc(11,"translate"),J.Ub(),J.Vb(12,"ejs-switch",41,42),J.fc("click",function(){return J.Ec(i),J.jc().approval()})("checkedChange",function(e){return J.Ec(i),J.jc().approvalStatus=e}),J.kc(14,"translate"),J.Ub(),J.Vb(15,"button",43),J.fc("click",function(){return J.Ec(i),J.jc().finished()}),J.Qb(16,"i",44),J.Lc(17),J.kc(18,"translate"),J.Ub(),J.Vb(19,"button",45),J.fc("click",function(){J.Ec(i);var e=J.jc(),t=J.Bc(44);return e.openModalHistory(t)}),J.Qb(20,"i",46),J.Lc(21," History"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(3),J.Nc(" ",J.lc(4,8,"Back")," "),J.Cb(5),J.qc("onLabel",J.lc(10,10,"DONE")),J.qc("offLabel",J.lc(11,12,"UNDONE")),J.pc("disabled",n.approvalStatus)("checked",n.createdStatus),J.Cb(4),J.qc("offLabel",J.lc(14,14,"NOT_APPROVED")),J.pc("checked",n.approvalStatus),J.Cb(5),J.Nc(" ",J.lc(18,16,"FINISHED")," ")}}function En(e,t){if(1&e&&(J.Vb(0,"li",56),J.Vb(1,"a"),J.Lc(2),J.Vb(3,"span",57),J.Lc(4),J.Ub(),J.Ub(),J.Ub()),2&e){var i=t.$implicit;J.Cb(2),J.Oc(" ",i.position,". ",i.ingredientName," "),J.Cb(2),J.Nc("(",i.percentage,"%)")}}function Vn(e,t){if(1&e&&(J.Vb(0,"ul"),J.Vb(1,"span",53),J.Lc(2),J.Ub(),J.Vb(3,"li",54),J.Lc(4),J.Vb(5,"ul"),J.Jc(6,En,5,3,"li",55),J.Ub(),J.Ub(),J.Ub()),2&e){var i=J.jc(2);J.Cb(2),J.Mc(i.formulaTamp()),J.Cb(2),J.Nc(" ",i.formula()," "),J.Cb(2),J.pc("ngForOf",i.renderchemical())}}function Fn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"button",58),J.fc("click",function(){J.Ec(i);var e=t.$implicit;return J.jc(2).sortBySup(e.id)}),J.Qb(1,"i",59),J.Lc(2),J.Ub()}if(2&e){var n=t.$implicit;J.Cb(2),J.Nc(" ",n.name," ")}}function Mn(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"ITEM")," ")}function Ln(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",67,68),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(3).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(3);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function Gn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"ejs-dropdownlist",67,68),J.fc("change",function(e){J.Ec(i);var n=t.$implicit;return J.jc(3).onChangePosition(e,n,n.index)}),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(3);J.pc("dataSource",a.dataPosition)("value",n.position)("fields",a.fieldsPosition)("allowFiltering",!0)}}function Tn(e,t){1&e&&(J.Lc(0),J.kc(1,"translate")),2&e&&J.Nc(" ",J.lc(1,1,"INGREDIENT_NAME")," ")}function On(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function jn(e,t){1&e&&J.Lc(0),2&e&&J.Nc(" ",t.$implicit.name," ")}function Jn(e,t){if(1&e&&(J.Vb(0,"div"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(3);J.Eb(n.changePercentageColor(i)),J.Cb(1),J.Mc(i.percentage)}}function Rn(e,t){1&e&&(J.Vb(0,"div"),J.Qb(1,"i",69),J.Ub())}function Kn(e,t){if(1&e&&(J.Vb(0,"div"),J.Lc(1),J.Ub()),2&e){var i=t.$implicit,n=J.jc(3);J.Eb(n.changeAllowColor(i)),J.Cb(1),J.Nc("\xb1 ",i.allow,"")}}function $n(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",60),J.Vb(1,"div",9),J.Vb(2,"div",18),J.Vb(3,"ejs-grid",61,62),J.fc("actionComplete",function(e){return J.Ec(i),J.jc(2).actionCompleteIngredient(e)})("recordDoubleClick",function(e){return J.Ec(i),J.jc(2).onDoubleClickIngredient(e)})("actionBegin",function(e){return J.Ec(i),J.jc(2).actionBeginIngredient(e)})("toolbarClick",function(e){return J.Ec(i),J.jc(2).toolbarClickIngredient(e)})("rowSelected",function(e){return J.Ec(i),J.jc(2).rowSelectedIngredient(e)}),J.Vb(5,"e-columns"),J.Vb(6,"e-column",63),J.Jc(7,Mn,2,3,"ng-template",null,22,J.Kc),J.Jc(9,Ln,2,4,"ng-template",null,23,J.Kc),J.Jc(11,Gn,2,4,"ng-template",null,27,J.Kc),J.Ub(),J.Vb(13,"e-column",64),J.Jc(14,Tn,2,3,"ng-template",null,22,J.Kc),J.Jc(16,On,1,1,"ng-template",null,27,J.Kc),J.Jc(18,jn,1,1,"ng-template",null,23,J.Kc),J.Ub(),J.Vb(20,"e-column",65),J.Jc(21,Jn,2,3,"ng-template",null,23,J.Kc),J.Ub(),J.Vb(23,"e-column",66),J.Jc(24,Rn,2,0,"ng-template",null,22,J.Kc),J.Jc(26,Kn,2,3,"ng-template",null,23,J.Kc),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub()}if(2&e){var n=t.$implicit,a=J.jc(2);J.Cb(3),J.pc("dataSource",n)("allowSorting",!0)("allowSorting",!0)("editSettings",a.editSettings)("toolbar",a.toolbarOptions2)}}function Qn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",47),J.Jc(1,Vn,7,3,"ul",48),J.Vb(2,"div",0),J.Vb(3,"div",49),J.Vb(4,"button",50),J.fc("click",function(){return J.Ec(i),J.jc().sortBySup(0)}),J.Lc(5),J.kc(6,"translate"),J.Ub(),J.Jc(7,Fn,3,1,"button",51),J.Ub(),J.Ub(),J.Vb(8,"div",0),J.Jc(9,$n,28,5,"div",52),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(1),J.pc("ngIf",n.renderchemical().length>0),J.Cb(4),J.Nc(" ",J.lc(6,4,"DEFAULT")," "),J.Cb(2),J.pc("ngForOf",n.supplier),J.Cb(2),J.pc("ngForOf",n.ingredientGroupData)}}function Hn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",70),J.Vb(1,"h4",71),J.Qb(2,"i",72),J.Lc(3," Clone Article "),J.Ub(),J.Vb(4,"button",73),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",74),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",75),J.Vb(8,"div",0),J.Vb(9,"div",76),J.Vb(10,"div",77),J.Vb(11,"label",78),J.Lc(12,"Article Name"),J.Ub(),J.Vb(13,"span",79),J.Lc(14,"(*)"),J.Ub(),J.Vb(15,"input",80),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc().articleName=e}),J.Ub(),J.Ub(),J.Ub(),J.Vb(16,"div",76),J.Vb(17,"div",77),J.Vb(18,"label",78),J.Lc(19,"Process"),J.Ub(),J.Vb(20,"ejs-dropdownlist",81,82),J.fc("change",function(e){return J.Ec(i),J.jc().onChangeProcessCloneModal(e)}),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(22,"div",83),J.Vb(23,"button",84),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(24,"Close"),J.Ub(),J.Vb(25,"button",85),J.fc("click",function(){return J.Ec(i),J.jc().cloneArticleModelname()}),J.Lc(26,"Clone"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(15),J.pc("ngModel",n.articleName),J.Cb(5),J.pc("value",n.valueProcess)("dataSource",n.processData)("allowFiltering",!0)("fields",n.processfields)}}function _n(e,t){1&e&&(J.Lc(0),J.kc(1,"date")),2&e&&J.Nc(" ",J.mc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function Wn(e,t){if(1&e&&(J.Tb(0),J.Qb(1,"input",98),J.Sb()),2&e){var i=J.jc().$implicit;J.Cb(1),J.pc("value",i.remark)}}function qn(e,t){if(1&e&&J.Qb(0,"input",99),2&e){var i=J.jc().$implicit;J.pc("value",i.remark)}}function zn(e,t){if(1&e&&(J.Vb(0,"span",95),J.Jc(1,Wn,2,1,"ng-container",96),J.Jc(2,qn,1,1,"ng-template",null,97,J.Kc),J.Ub()),2&e){var i=t.$implicit,n=J.Bc(3);J.pc("ngClass","Improve"==i.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),J.Cb(1),J.pc("ngIf","Improve"==i.action)("ngIfElse",n)}}function Xn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",70),J.Vb(1,"h4",71),J.Qb(2,"i",72),J.Lc(3," BPFC History "),J.Ub(),J.Vb(4,"button",73),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",74),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",75),J.Vb(8,"ejs-grid",86,87),J.fc("actionBegin",function(e){return J.Ec(i),J.jc().actionBeginHistory(e)}),J.Vb(10,"e-columns"),J.Vb(11,"e-column",88),J.Jc(12,_n,2,4,"ng-template",null,23,J.Kc),J.Ub(),J.Qb(14,"e-column",89),J.Qb(15,"e-column",90),J.Qb(16,"e-column",91),J.Vb(17,"e-column",92),J.Jc(18,zn,4,3,"ng-template",null,27,J.Kc),J.Ub(),J.Qb(20,"e-column",93),J.Ub(),J.Ub(),J.Ub(),J.Vb(21,"div",83),J.Vb(22,"button",94),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(23,"Close"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(8),J.pc("dataSource",n.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",n.editSettingsHis)("toolbar",n.toolbarOptionsHistory),J.Cb(9),J.pc("edit",n.editparamsHis)}}function Yn(e,t){if(1&e){var i=J.Wb();J.Vb(0,"div",70),J.Vb(1,"h4",71),J.Qb(2,"i",72),J.Lc(3," Clone BPFC "),J.Ub(),J.Vb(4,"button",73),J.fc("click",function(){return t.$implicit.dismiss("Cross click")}),J.Vb(5,"span",74),J.Lc(6,"\xd7"),J.Ub(),J.Ub(),J.Ub(),J.Vb(7,"div",75),J.Vb(8,"div",0),J.Vb(9,"div",76),J.Vb(10,"div",77),J.Vb(11,"label",78),J.Lc(12,"Model Name"),J.Ub(),J.Vb(13,"span",79),J.Lc(14,"(*)"),J.Ub(),J.Qb(15,"input",6),J.Ub(),J.Ub(),J.Vb(16,"div",76),J.Vb(17,"div",77),J.Vb(18,"label",78),J.Lc(19,"Model NO"),J.Ub(),J.Vb(20,"span",79),J.Lc(21,"(*)"),J.Ub(),J.Qb(22,"input",6),J.Ub(),J.Ub(),J.Vb(23,"div",76),J.Vb(24,"div",77),J.Vb(25,"label",78),J.Lc(26,"Article NO"),J.Ub(),J.Vb(27,"span",79),J.Lc(28,"(*)"),J.Ub(),J.Vb(29,"input",100),J.fc("ngModelChange",function(e){return J.Ec(i),J.jc().articleNoNewLeo=e}),J.Ub(),J.Ub(),J.Ub(),J.Vb(30,"div",76),J.Vb(31,"div",77),J.Vb(32,"label",78),J.Lc(33,"Process"),J.Ub(),J.Vb(34,"span",79),J.Lc(35,"(*)"),J.Ub(),J.Qb(36,"input",6),J.Ub(),J.Ub(),J.Ub(),J.Ub(),J.Vb(37,"div",83),J.Vb(38,"button",84),J.fc("click",function(){return t.$implicit.close("Close click")}),J.Lc(39,"Close"),J.Ub(),J.Vb(40,"button",85),J.fc("click",function(){return J.Ec(i),J.jc().onClickClone()}),J.Lc(41,"Clone"),J.Ub(),J.Ub()}if(2&e){var n=J.jc();J.Cb(15),J.pc("value",n.modelNameLeo),J.Cb(7),J.pc("value",n.modelNoLeo),J.Cb(7),J.pc("ngModel",n.articleNoNewLeo)("value",n.articleNoLeo),J.Cb(7),J.pc("value",n.artProcessLeo)}}var Zn,ea,ta,ia=((Zn=function(){function e(t,i,n,a,l,o,r,c,u,d,h,g,m,f,b,p,v,D){var I=this;s(this,e),this.glueIngredientService=t,this.modalNameService=i,this.glueService=n,this.alertify=a,this.modalService=l,this.route=o,this.router=r,this.authService=c,this.bPFCEstablishService=u,this.modelNoService=d,this.articleNoService=h,this.kindService=g,this.partService=m,this.materialService=f,this.buildingUserService=b,this.artProcessService=p,this.ingredientService=v,this.dataService=D,this.positions=["B","C","D","E"],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={id:0,name:"",gluename:"",code:"",createdDate:"",partID:0,kindID:0,materialID:0,BPFCEstablishID:0,consumption:"",expiredTime:0,createdBy:0,glueNameID:0,glueIngredients:[]},this.ingredient={id:0,name:"",code:"",percentage:0,createdDate:new Date,supplierID:0,position:0,allow:0,voc:0,expiredTime:0,daysToExpiration:0,materialNO:"",unit:0,real:0,cbd:0},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.modelNameLeo=null,this.modelNoLeo=null,this.articleNoLeo=null,this.articleNoNewLeo=null,this.artProcessLeo=null,this.modelNameIDLeo=0,this.modelNoIDLeo=0,this.articleNoIDLeo=0,this.artProcessIDLeo=0,this.BPFCIDLeo=0,this.textSearch=null,this.ingredientGroupData=[[],[]],this.onFiltering=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(I.modelNameData,t)},this.onFilteringModelName=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(I.modelNameData,t)},this.onFilteringModelNO=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(I.modelNoData,t)},this.onFilteringArticleNO=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(I.articleNoData,t)},this.onFilteringModelNameClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(I.modelNameData,t)},this.onFilteringModelNOClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(I.modelNoData,t)},this.onFilteringArticleNOClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(I.articleNoData,t)},this.onFilteringArtProcessClone=function(e){var t=new K.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(I.artProcessDataClone,t)},this.dataSearch=this.dataService.currentMessage.subscribe(function(e){I.textSearch=e})}return d(e,[{key:"ngOnInit",value:function(){var e=this;this.BPFCID=this.route.snapshot.params.id,this.tab=this.route.snapshot.params.tab,this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.GetDetailBPFC(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(function(t){200===t&&e.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}},{key:"back",value:function(){this.router.navigate(["/ec/establish/bpfc-schedule/".concat(this.tab,"/").concat(this.articleNoLeo)])}},{key:"ngOnDestroy",value:function(){this.dataService.changeMessages(this.textSearch),this.dataSearch.unsubscribe()}},{key:"GetDetailBPFC",value:function(){var e=this;this.BPFCID=this.route.snapshot.params.id,this.bPFCEstablishService.getDetailBPFC(this.BPFCID).subscribe(function(t){var i,n=t[0];e.BPFCIDLeo=n.id,e.modelNameLeo=n.modelName,e.modelNoLeo=n.modelNo,e.articleNoLeo=n.articleNo,e.artProcessLeo=n.artProcess,e.articleNoNewLeo=n.articleNo,e.modelNameID=n.modelNameID,e.modelNoID=n.modelNoID,e.articleNoID=n.articleNoID,e.artProcessIDLeo="ASY"===n.artProcess?1:2,e.modelNameDetail=t[0].modelName,e.modelNameID=t[0].modelNameID,e.modelNoDetail=t[0].modelNo,e.articleNoDetail=t[0].articleNo,e.artProcessDetail=t[0].artProcess,e.modelNameIDClone=t[0].modelNameID,e.value=t[0].modelNameID,e.valuemodelNo=t[0].modelNoID,e.articleNoID=t[0].articleNoID,e.resetLifeCycleBPFC(),e.BPFCID=null===(i=t[0])||void 0===i?void 0:i.id,e.approvalStatus=t[0].approvalStatus,e.createdStatus=t[0].finishedStatus,localStorage.removeItem("details"),e.glue.BPFCEstablishID=e.BPFCID,e.getAllGluesByBPFCID(e.BPFCID),e.getAllPart(),e.getAllKind(),e.getAllMaterial(),e.getAllIngredient(),e.existGlue=!0,e.modified=!0})}},{key:"onChangeProcessCloneModal",value:function(e){e.itemData&&(this.processID=e.itemData.id)}},{key:"resetLifeCycleBPFC",value:function(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}},{key:"onCreatedGridGlue",value:function(){}},{key:"ngAfterViewInit",value:function(){$('[data-toggle="tooltip"]').tooltip();var e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}},{key:"onChangeKindEdit",value:function(e){this.kindEdit=e.value,this.kindID=e.itemData.id}},{key:"onChangePartEdit",value:function(e){this.partEdit=e.value,this.partID=e.itemData.id}},{key:"onChangeMaterialEdit",value:function(e){this.kindEdit=e.value,this.materialID=e.itemData.id}},{key:"dataBoundGlue",value:function(){this.gridglue.selectRows(this.selectedRow.length?this.selectedRow:this.selIndex)}},{key:"actionBeginGlue",value:function(e){var t=this;"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":"Consumption ".concat(e.rowData.consumption),this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After="Consumption ".concat(e.data.consumption),this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){t.glueService.delete(e.data[0].id).subscribe(function(){t.getAllGluesByBPFCID(t.BPFCID),t.detailGlue=!1,t.removeLocalStore("details"),t.glueIngredientDetail=[],t.oldDetail=[],t.alertify.success("Glue has been deleted")},function(e){t.alertify.error("Failed to delete the Glue")})}))}},{key:"rowDeselected",value:function(e){var t=this,i=e.rowIndex,n=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,n)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(function(e){if(t.modified=!0,t.gridglue.getSelectedRowIndexes().length){var n=t.gridglue.dataSource[i];n.name=n.chemical.name,t.gridglue.refresh()}}).catch(function(e){t.gridglue.selectRows([i])})}},{key:"rowSelected",value:function(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);var t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}},{key:"onChangePosition",value:function(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;var n=e.value,a=this.getLocalStore("details");if(""===e.value);else{if(0!==a.length){var l="";switch(a[a.length-1].position){case"A":l="B";break;case"B":l="C";break;case"C":l="D";break;case"D":l="E"}if(n!==l)return this.alertify.warning("H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 ".concat(l),!0),this.grid.toArray().forEach(function(e){return e.refresh()}),void(e.cancel=!0)}if(0===a.filter(function(t){return t.position===e.value}).length&&null!==e.value)if(a=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==a.filter(function(e){return e.ingredientName===t.name&&e.position===t.position}).length){var o=a.findIndex(function(e){return e.ingredientName===t.name});a[o].position=e.value,this.setLocalStore("details",a),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.toArray().forEach(function(e){return e.refresh()})}else{a=this.getLocalStore("details");var r={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(r.percentage=100,r.expiredTime=t.expiredTime),a.push(r),this.setLocalStore("details",a),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.toArray().forEach(function(e){return e.refresh()})}}}},{key:"recordDoubleClick",value:function(e){this.modifiedGlue=!0}},{key:"toolbarClickIngredient",value:function(e){e.item.id.includes("add")&&(e.cancel=!0,this.openIngredientModalComponent())}},{key:"onDoubleClickIngredient",value:function(e){this.setFocus=e.column}},{key:"rowSelectedIngredient",value:function(e){this.ingridientID=e.data.id}},{key:"genaratorGlueCode",value:function(){this.glue.code=this.makeid(8)}},{key:"makeid",value:function(e){for(var t="",i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length,a=0;a<e;a++)t+=i.charAt(Math.floor(Math.random()*n));return t}},{key:"compareArray",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"setLocalStore",value:function(e,t){localStorage.removeItem(e);var i=JSON.stringify(t);localStorage.setItem(e,i)}},{key:"getLocalStore",value:function(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}},{key:"removeLocalStore",value:function(e){localStorage.removeItem(e)}},{key:"dynamicSort",value:function(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(i,n){return-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}}},{key:"checkColorCode",value:function(e){return!0===e.approvalStatus&&!0===e.finishedStatus}},{key:"checkDone",value:function(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}},{key:"checkStatus",value:function(e,t){return!0===e&&!0===t?"Done":"Undone"}},{key:"renderchemical",value:function(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}},{key:"makeFormula",value:function(){var e,t,i=this.getLocalStore("details").filter(function(e){return"A"===e.position})||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(function(e){return e.percentage}),this.percentageCountEdit=this.glueIngredientDetail.map(function(e){return e}),this.totalPercentage=this.percentageCount.reduce(function(e,t){return e+t},0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);var n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}},{key:"formula",value:function(){return this.B&&this.C&&this.D&&this.E?"{[ (".concat(this.nameGlue,"+ ").concat(this.B,") + ").concat(this.C," ] + ").concat(this.D,"}+ ").concat(this.E):this.B&&this.C&&this.D?"[(".concat(this.nameGlue," + ").concat(this.B,") + ").concat(this.C,"] + ").concat(this.D):this.B&&this.C?"(".concat(this.nameGlue," + ").concat(this.B,") + ").concat(this.C):this.B?"".concat(this.nameGlue," + ").concat(this.B):"".concat(this.nameGlue)}},{key:"formulaTamp",value:function(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName="{[ (".concat(this.nameGlues,"+ ").concat(this.BB,") + ").concat(this.CC," ] + ").concat(this.DD,"}+ ").concat(this.EE),"{[ (".concat(this.nameGlues,"+ ").concat(this.BB,") + ").concat(this.CC," ] + ").concat(this.DD,"}+ ").concat(this.EE)):this.BB&&this.CC&&this.DD?(this.glueNewName="[(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC,"] + ").concat(this.DD),"[(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC,"] + ").concat(this.DD)):this.BB&&this.CC?(this.glueNewName="(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC),"(".concat(this.nameGlues," + ").concat(this.BB,") + ").concat(this.CC)):this.BB?(this.glueNewName="".concat(this.nameGlues," + ").concat(this.BB),"".concat(this.nameGlues," + ").concat(this.BB)):"".concat(this.nameGlues)}},{key:"getDetail",value:function(e){var t=this;this.glueIngredientService.getDetail(e).subscribe(function(e){var i,n,a,l;t.glueIngredientDetail=e.glueIngredients,t.setLocalStore("details",t.glueIngredientDetail),t.setLocalStore("detailsTamp",t.glueIngredientDetail),t.glueIngredientDetail=t.renderchemical(),t.oldDetail=t.renderchemical();var o=t.glueIngredientDetail.filter(function(e){return"A"===e.position})||[];t.nameGlue=(null===(i=o[0])||void 0===i?void 0:i.ingredientName)||"",t.nameGlues=(null===(n=o[0])||void 0===n?void 0:n.ingredientName)+"^"+(null===(a=t.glueIngredientDetail[0])||void 0===a?void 0:a.allow)+"%"||!1,t.A=(null===(l=o[0])||void 0===l?void 0:l.ingredientName)||"",void 0===t.glueIngredientDetail[1]?t.B="":(t.B=t.glueIngredientDetail[1].percentage+"%"+t.glueIngredientDetail[1].ingredientName,t.BB=t.glueIngredientDetail[1].percentage+"%"+t.glueIngredientDetail[1].ingredientName+"^"+t.glueIngredientDetail[1].allow+"%"),void 0===t.glueIngredientDetail[2]?t.C="":(t.C=t.glueIngredientDetail[2].percentage+"%"+t.glueIngredientDetail[2].ingredientName,t.CC=t.glueIngredientDetail[2].percentage+"%"+t.glueIngredientDetail[2].ingredientName+"^"+t.glueIngredientDetail[2].allow+"%"),void 0===t.glueIngredientDetail[3]?t.D="":(t.D=t.glueIngredientDetail[3].percentage+"%"+t.glueIngredientDetail[3].ingredientName,t.DD=t.glueIngredientDetail[3].percentage+"%"+t.glueIngredientDetail[3].ingredientName+"^"+t.glueIngredientDetail[3].allow+"%"),void 0===t.glueIngredientDetail[4]?t.E="":(t.E=t.glueIngredientDetail[4].percentage+"%"+t.glueIngredientDetail[4].ingredientName,t.EE=t.glueIngredientDetail[4].percentage+"%"+t.glueIngredientDetail[4].ingredientName+"^"+t.glueIngredientDetail[4].allow+"%"),t.glueIngredientDetail.length>0?(t.percentageCount=t.glueIngredientDetail.map(function(e){return e.percentage}),t.percentageCount.join("+"),t.percentageCountEdit=t.glueIngredientDetail.map(function(e){return e}),t.totalPercentage=t.percentageCount.reduce(function(e,t){return e+t},0)):(t.percentageCount=[],t.percentageCountEdit=[],t.totalPercentage=0)})}},{key:"updateChemicalList",value:function(){var e,t=this.getLocalStore("details"),i=o(this.ingredientGroupData);try{for(i.s();!(e=i.n()).done;){var n,a=e.value,l=o(t);try{var r=function(){var e=n.value,t=a.findIndex(function(t){return t.name===e.ingredientName&&t.id===e.ingredientID});-1!==t&&(a[t].position=e.position,a[t].percentage=e.percentage,a[t].allow=e.allow)};for(l.s();!(n=l.n()).done;)r()}catch(c){l.e(c)}finally{l.f()}}}catch(c){i.e(c)}finally{i.f()}}},{key:"actionBeginIngredient",value:function(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){var t=e.previousData,i=e.data;this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;var n=t.allow!==i.allow;if(t.percentage!==i.percentage){this.modified=!1;var a=this.getLocalStore("details"),l=a.findIndex(function(t){return t.ingredientName===e.data.name&&t.ingredientID===e.data.id});if(a[l].percentage=e.data.percentage,this.setLocalStore("details",a),this.updateChemicalsV2(),this.gridglue.getSelectedRecords().length>0){var o=this.gridglue.getSelectedRecords()[0].glueIngredients;if(o.length>0){var r=o.findIndex(function(t){return t.ingredientID===e.data.id});o[r].percentage=e.data.percentage}}}if(n){var c=this.getLocalStore("details"),s=c.findIndex(function(t){return t.ingredientName===e.data.name&&t.ingredientID===e.data.id});if(c[s].allow=e.data.allow,this.setLocalStore("details",c),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicalsV2(),this.gridglue.getSelectedRecords().length>0){var u=this.gridglue.getSelectedRecords()[0].glueIngredients;if(u.length>0){var d=u.findIndex(function(t){return t.ingredientID===e.data.id});u[d].allow=e.data.allow}}}}"delete"===e.requestType&&this.deleteIngredient()}},{key:"updateGlueIngredient",value:function(){}},{key:"loadPreview",value:function(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}},{key:"resolver",value:function(){var e=this;this.route.data.subscribe(function(t){e.glues=t.glues.result,e.paginationG=t.glues.pagination})}},{key:"onService",value:function(){var e=this;this.ingredientService.currentIngredient.subscribe(function(t){300===t&&(e.getIngredients(),e.updateChemicalList(),e.ingredientService.changeIngredient(0))})}},{key:"mapGlue",value:function(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}},{key:"getIngredients",value:function(){var e=this;this.glueIngredientService.getIngredients(this.glueid).subscribe(function(t){e.ingredients1=t.result.list1,e.ingredients2=t.result.list2,e.ingredientGroupData=[],e.ingredientGroupData.push(t.result.list1,t.result.list2)},function(t){e.alertify.error(t)})}},{key:"getGlues",value:function(){var e=this;this.glueService.getAllGlue().subscribe(function(t){e.glues=t},function(t){e.alertify.error(t)})}},{key:"mapGlueIngredients",value:function(e){var t=this;this.glueIngredientService.mapGlueIngredient(e).subscribe(function(e){void 0===t.subID?(t.sortBySup(0),t.getDetail(t.glueid)):(t.sortBySup(t.subID),t.getDetail(t.glueid))})}},{key:"mapGlueIngredient",value:function(e){var t=this;this.glueIngredientService.mappGlueIngredient(e).subscribe(function(e){void 0===t.subID?(t.getAllGluesByBPFCID(t.BPFCID),t.sortBySup(0),t.getDetail(t.glueid)):(t.sortBySup(t.subID),t.getDetail(t.glueid),t.getAllGluesByBPFCID(t.BPFCID))})}},{key:"openIngredientModalComponent",value:function(){var e=this.modalService.open(re.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(function(e){},function(e){})}},{key:"actionCompleteIngredient",value:function(e){}},{key:"openPopupDropdownlist",value:function(){$('[data-toggle="tooltip"]').tooltip()}},{key:"toolbarClick",value:function(e){var t=this;switch(e.item.text){case"Add New":var i=this.getLocalStore("details").sort(this.dynamicSort("position"));if(!1===this.compareArray(this.oldDetail,i)&&i.length>0&&this.oldDetail.length>0)this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(function(e){var i={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:t.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};t.glue=i,t.saveGlue()}).catch(function(t){e.cancel=!0});else{var n={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=n,this.saveGlue()}}}},{key:"openModal",value:function(e){this.modalReference=this.modalService.open(e)}},{key:"openModalHistory",value:function(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}},{key:"LoadHistoryBPFC",value:function(){var e=this;this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(function(t){e.historyData=t.map(function(t){return{id:t.id,glueID:t.glueID,createdTime:t.createdTime,bpfcEstablishID:t.bpfcEstablishID,before:t.before,after:t.after,action:t.action,remark:t.remark,userID:t.userID,createdBy:e.createdBy(t.userID)}})})}},{key:"actionBeginHistory",value:function(e){var t=this;"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(function(e){e&&t.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}},{key:"getAllUsers",value:function(){var e=this;this.buildingUserService.getAllUsers(1,1e3).subscribe(function(t){e.userData=t.result})}},{key:"createdBy",value:function(e){if(0===e)return"#N/A";var t=this.userData.filter(function(t){return t.ID===e})[0];return void 0!==t?t.Username:"#N/A"}},{key:"cloneModelname",value:function(){var e=this;this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",function(){e.modalNameService.cloneModelname(e.modelNameID,e.modelNameClone,e.modelNoClone,e.valueProcess).subscribe(function(t){e.alertify.success("the model name has been cloned"),e.modalReference.close(),e.modelNameDropdownlist.hidePopup()})})}},{key:"cloneArticleModelname",value:function(){var e=this;this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",function(){e.modalNameService.cloneArticleModelname(e.modelNameID,e.modelNameClone,e.modelNoClone,e.articleName,e.processID).subscribe(function(t){e.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),e.modalReference.close(),e.modelNameDropdownlist.hidePopup()})})}},{key:"delete",value:function(e,t){var i=this;this.glueIngredientService.delete(e,t).subscribe(function(t){i.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),i.getIngredients(),i.getDetail(e)})}},{key:"deleteGlue",value:function(e){var t=this;this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',function(){t.glueService.delete(e.id).subscribe(function(){t.getGlues(),t.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(e){t.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}},{key:"deleteIngridient",value:function(e){var t=this;this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',function(){t.ingredientService.delete(e.id).subscribe(function(){t.getIngredients(),t.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(e){t.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}},{key:"getAllGluesByBPFCID",value:function(e){var t=this;this.glueService.getAllGluesByBPFCID(e).subscribe(function(e){t.glues=e})}},{key:"getAllGluesByBPFCID2",value:function(e){var t=this;this.glueService.getAllGluesByBPFCID(e).subscribe(function(e){void 0===t.ingredientID?(t.glues=e,e.length>0&&(t.detailGlue=!0)):(t.glueid=e[0].id,t.glueIngredient2.ingredientID=t.ingredientID,t.glueIngredient2.percentage=100,t.glueIngredient2.glueID=t.glueid,t.glueIngredient2.position="A",t.mapGlueIngredient(t.glueIngredient2))})}},{key:"updateChemicals",value:function(){var e=this;this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(function(t){e.ingredients1=t.list1,e.ingredients2=t.list2;var i,n=e.getLocalStore("details"),a=o(n);try{var l=function(){var t=i.value,n=e.ingredients1.findIndex(function(e){return e.name===t.ingredientName&&e.id===t.ingredientID});-1!==n&&(e.ingredients1[n].position=t.position,e.ingredients1[n].percentage=t.percentage,e.ingredients1[n].allow=t.allow)};for(a.s();!(i=a.n()).done;)l()}catch(u){a.e(u)}finally{a.f()}var r,c=o(n);try{var s=function(){var t=r.value,i=e.ingredients2.findIndex(function(e){return e.name===t.ingredientName&&e.id===t.ingredientID});-1!==i&&(e.ingredients2[i].position=t.position,e.ingredients2[i].percentage=t.percentage,e.ingredients2[i].allow=t.allow)};for(c.s();!(r=c.n()).done;)s()}catch(u){c.e(u)}finally{c.f()}e.glueIngredientDetail=n,e.makeFormula()})}},{key:"updateChemicalsV2",value:function(){var e=this;this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(function(t){var i,n=t.list1,a=t.list2,l=e.getLocalStore("details"),r=o(l);try{var c=function(){var e=i.value,t=n.findIndex(function(t){return t.name===e.ingredientName&&t.id===e.ingredientID});-1!==t&&(n[t].position=e.position,n[t].percentage=e.percentage,n[t].allow=e.allow)};for(r.s();!(i=r.n()).done;)c()}catch(h){r.e(h)}finally{r.f()}var s,u=o(l);try{var d=function(){var e=s.value,t=a.findIndex(function(t){return t.name===e.ingredientName&&t.id===e.ingredientID});-1!==t&&(a[t].position=e.position,a[t].percentage=e.percentage,a[t].allow=e.allow)};for(u.s();!(s=u.n()).done;)d()}catch(h){u.e(h)}finally{u.f()}e.ingredientGroupData=[],e.ingredientGroupData.push(n,a),e.glueIngredientDetail=l,e.makeFormula()})}},{key:"sortBySup",value:function(e){var t=this;0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(function(i){var n=i.list1,a=i.list2;if(t.ingredientGroupData=[],t.ingredientGroupData.push(n,a),0===e){var l=t.getLocalStore("details");n=l.map(function(e){return{id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,cbd:e.cbd}}),t.ingredientGroupData=[],t.ingredientGroupData.push(n),t.glueIngredientDetail=l}else t.updateChemicalList()}))}},{key:"saveGlue",value:function(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}},{key:"getBuilding",value:function(){JSON.parse(localStorage.getItem("user"))}},{key:"getAllIngredient",value:function(){var e=this;this.ingredientService.getAllIngredient().subscribe(function(t){e.ingrediented=t})}},{key:"createGlue",value:function(){var e=this;this.glueService.create(this.glue).subscribe(function(){e.alertify.success("\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.clearGlueForm(),e.genaratorGlueCode(),e.expiredTime=0},function(t){e.alertify.error(t),e.genaratorGlueCode()})}},{key:"finished",value:function(){var e=this,t=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=t,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(function(){});var i=this.getLocalStore("details"),n=this.gridglue.getSelectedRecords()[0];n.expiredTime=i.filter(function(e){return"A"===e.position})[0].expiredTime,n.kindID=0===n.kindID?null:n.kindID,n.partID=0===n.partID?null:n.partID,n.materialID=0===n.materialID?null:n.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),this.glueService.update(n).subscribe(function(t){e.alertify.success("Update sucessfully!<br>C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.detailGlue=!0,e.modified=!0}),i.length>0&&(this.mapGlueIngredients(i),this.modified=!0)}}},{key:"clearGlueForm",value:function(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}},{key:"update",value:function(){var e=this;this.glueService.update(this.glue).subscribe(function(t){e.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.detailGlue=!1,e.history.Action="Created",e.expiredTime=0})}},{key:"updateChemical",value:function(){var e=this;this.glueService.updateChemical(this.glue).subscribe(function(t){e.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),e.getAllGluesByBPFCID(e.BPFCID),e.detailGlue=!1,e.onChangeChemical=!1,e.history.Action="Created"})}},{key:"deleteIngredient",value:function(){var e=this;this.ingredientService.delete(this.ingridientID).subscribe(function(){var t=e.getLocalStore("details").filter(function(t){return t.ingredientID!==e.ingridientID});e.setLocalStore("details",t),e.glueIngredientDetail=t,e.getIngredients(),e.makeFormula(),e.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},function(t){e.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}},{key:"approval",value:function(){var e=this,t=this.gridglue.dataSource;if(t){var i,n=o(t);try{for(n.s();!(i=n.n()).done;){var a=i.value;if("STF"===this.artProcessDetail&&null===a.kindID)return this.alertify.warning("Please maintain the kind!<br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind!<br>\n          <br>\n              ",!0),void(this.approvalStatus=!this.approvalStatus);if(a.glueIngredients.length>0){var l,r=o(a.glueIngredients.filter(function(e){return"A"!==e.position}));try{for(r.s();!(l=r.n()).done;){var c=l.value;if(c.allow<=0&&"A"!==c.position)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The allowance of checmical name ".concat(c.ingredient.name," must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ").concat(c.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(a.name," <br>\n              "),!0);if(c.percentage<=0&&"A"!==c.position)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The percentage of checmical name ".concat(c.ingredient.name," must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ").concat(c.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(a.name," <br>\n              "),!0)}}catch(u){r.e(u)}finally{r.f()}}if(+a.consumption<=0)return this.approvalStatus=!this.approvalStatus,void this.alertify.warning("The consumption of glue name ".concat(a.name," must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ").concat(a.name," ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ").concat(a.name," <br>\n          "),!0)}}catch(u){n.e(u)}finally{n.f()}var s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(function(t){e.alertify.success("The BPFC has been approved!"),e.createdStatus=e.approvalStatus;var i=e.modelNameDropdownlist.getDataByValue(e.modelNameDropdownlist.value);e.modelNameDropdownlist.valueTemplate="(".concat(e.checkStatus(e.approvalStatus,e.createdStatus),") ").concat(i.name)})}}},{key:"done",value:function(){var e=this,t=this.gridglue.dataSource,i=!1,n=!1,a=!1;if(t){var l,r=o(t);try{for(r.s();!(l=r.n()).done;){var c=l.value;if("STF"===this.artProcessDetail&&null===c.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.createdStatus=!this.createdStatus);if(c.glueIngredients.length>0){var s,u=c.glueIngredients.filter(function(e){return"A"!==e.position}),d=o(u);try{for(d.s();!(s=d.n()).done;){var h=s.value;if(h.allow<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The allow of checmical name ".concat(h.ingredient.name," is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ").concat(h.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(c.name," <br>\n              "),!0);if(h.percentage<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The percentage of checmical name ".concat(h.ingredient.name," is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ").concat(h.ingredient.name," ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ").concat(c.name," <br>\n              "),!0);i=!0,n=!0}}catch(m){d.e(m)}finally{d.f()}0===u.length&&(i=!0,n=!0)}if(+c.consumption<=0)return a=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning("The consumption of glue name ".concat(c.name," is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ").concat(c.name," ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ").concat(c.name," <br>\n          "),!0);a=!0}}catch(m){r.e(m)}finally{r.f()}if(i&&n&&a){var g=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,g).subscribe(function(t){!0===t.status?(e.alertify.success(t.message),e.createdStatus=e.createdStatus):e.alertify.success(t.message)})}}}},{key:"getModelNames",value:function(){var e=this;this.modalNameService.getAllModalName().subscribe(function(t){e.modelNameData=t.map(function(e){return{id:e.id,name:e.name}})})}},{key:"getArticleNoByModelNameID",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNoData=e})}},{key:"getModelNoByModelNameID",value:function(e){var t=this;this.modelNoService.getModelNoByModelNameID(e).subscribe(function(e){t.modelNoData=e})}},{key:"getArtProcessByArticleNoID",value:function(e){var t=this;this.artProcessService.getArtProcessByArticleNoID(e).subscribe(function(e){t.artProcessData=e.map(function(e){return{id:e.id,name:1===e.processID?"ASY":"STF"}})})}},{key:"getAllProcess",value:function(){var e=this;this.artProcessService.GetAllProcess().subscribe(function(t){e.artProcessDataClone2=t})}},{key:"getAllKind",value:function(){var e=this;this.kindService.getAllKind().subscribe(function(t){e.kinds=t})}},{key:"getAllPart",value:function(){var e=this;this.partService.getAllPart().subscribe(function(t){e.parts=t})}},{key:"getAllMaterial",value:function(){var e=this;this.materialService.getAllMaterial().subscribe(function(t){e.materials=t})}},{key:"getIngredientsByGlueID",value:function(){var e=this;this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(function(t){e.ingredients1=t.list1,e.ingredients2=t.list2})}},{key:"getAllSupllier",value:function(){var e=this;this.ingredientService.getAllSupplier().subscribe(function(t){e.supplier=t})}},{key:"getArticleNoByModelNoID",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNosData=e})}},{key:"getBPFCID",value:function(e){var t=this;this.bPFCEstablishService.getBPFCID(e).subscribe(function(e){t.resetLifeCycleBPFC(),t.BPFCID=null==e?void 0:e.id,t.approvalStatus=e.approvalStatus,t.createdStatus=e.finishedStatus,t.glue.BPFCEstablishID=t.BPFCID,t.getAllGluesByBPFCID(t.BPFCID),t.getAllPart(),t.getAllKind(),t.getAllMaterial(),t.getAllIngredient(),t.existGlue=!0,t.modified=!0})}},{key:"OndataBound",value:function(e){}},{key:"getModelNamesClone",value:function(){var e=this;this.modalNameService.getAllModalName().subscribe(function(t){e.modelNameDataClone=t.map(function(e){return{id:e.id,name:e.name}}),e.getModelNoByModelNameIDClone(e.modelNameIDClone),e.articleNosDataClone=[],e.artProcessDataClone=[]})}},{key:"getArticleNoByModelNameIDClone",value:function(e){var t=this;this.articleNoService.getArticleNoByModelNoID(e).subscribe(function(e){t.articleNosDataClone=e})}},{key:"getModelNoByModelNameIDClone",value:function(e){var t=this;this.modelNoService.getModelNoByModelNameID(e).subscribe(function(e){t.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}},{key:"getArtProcessByArticleNoIDClone",value:function(e){var t=this;this.artProcessService.getArtProcessByArticleNoID(e).subscribe(function(e){t.artProcessDataClone=e.map(function(e){return{id:e.id,name:1===e.ProcessID?"ASY":"STF"}})})}},{key:"onChangeModelName",value:function(e){this.resetLifeCycleBPFC(),this.modelNameID=e.value,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}},{key:"onChangeModelNo",value:function(e){e.isInteracted&&(this.modelNoID=e.value,this.valuemodelNo=e.value,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}},{key:"onChangeArticleNo",value:function(e){e.isInteracted&&(this.articleNoID=e.value,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}},{key:"onClickProcess",value:function(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue))}},{key:"ClickProcessData",value:function(e){}},{key:"clearFormClone",value:function(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}},{key:"onClickClone",value:function(){var e={modelNameID:this.modelNameIDLeo,modelNOID:this.modelNoIDLeo,articleNOID:this.articleNoIDLeo,artProcessID:Number(this.artProcessIDLeo),bpfcID:this.BPFCIDLeo,name:this.articleNoNewLeo,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}},{key:"clone",value:function(e){var t=this;this.articleNoNewLeo!==this.articleNoLeo?this.modalNameService.cloneBPFC(e).subscribe(function(e){!0===e.status?(t.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),t.modalService.dismissAll(),t.getAllUsers()):t.alertify.error("The BPFC exists!")}):this.alertify.error("The BPFC exists!")}},{key:"onChangeModelNameClone",value:function(e){this.value!==e.value&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}},{key:"onChangeModelNoClone",value:function(e){this.modelNOIDClone=e.value,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}},{key:"onChangeArticleNoClone",value:function(e){e.isInteracted&&(this.articleNOIDClone=e.value,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}},{key:"onChangeProcessClone",value:function(e){e.isInteracted&&(this.artProcessIDClone=e.value)}},{key:"changeAllowColor",value:function(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}},{key:"changePercentageColor",value:function(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}},{key:"changeConsumptionColor",value:function(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}]),e}()).\u0275fac=function(e){return new(e||Zn)(J.Pb(Y),J.Pb(L.a),J.Pb(Z.a),J.Pb(G.a),J.Pb(f.b),J.Pb(V.a),J.Pb(V.c),J.Pb(te.a),J.Pb(j.a),J.Pb(ie),J.Pb(ee),J.Pb(ae.a),J.Pb(le.a),J.Pb(oe.a),J.Pb(T.a),J.Pb(ne),J.Pb(R.a),J.Pb(M.a))},Zn.\u0275cmp=J.Jb({type:Zn,selectors:[["app-bpfc-detailv2"]],viewQuery:function(e,t){var i;1&e&&(J.Rc(un,1),J.Rc(dn,1),J.Rc(hn,1),J.Rc(gn,1),J.Rc(mn,1),J.Rc(fn,1),J.Rc(bn,1),J.Rc(pn,1),J.Rc(vn,1)),2&e&&(J.Ac(i=J.gc())&&(t.doneSwitch=i.first),J.Ac(i=J.gc())&&(t.approvalSwitch=i.first),J.Ac(i=J.gc())&&(t.gridglue=i.first),J.Ac(i=J.gc())&&(t.grid2=i.first),J.Ac(i=J.gc())&&(t.modelNameDropdownlist=i.first),J.Ac(i=J.gc())&&(t.modelNoDropdownlist=i.first),J.Ac(i=J.gc())&&(t.chemicalDropdownlist=i.first),J.Ac(i=J.gc())&&(t.grid=i),J.Ac(i=J.gc())&&(t.positionDropdownlist=i))},features:[J.Bb([k.n,k.f,k.k])],decls:47,vars:10,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["type","text","name","","disabled","","title","",1,"form-control",3,"value"],[1,"col-md-1","mt-2"],["type","button",1,"btn","btn-danger","rounded-pill"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],["class","card-header-actions",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["HistoryModal",""],["cloneModal",""],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],[1,"card-header-actions"],["type","button","ejs-button","","cssClass","e-small e-primary mr-2",3,"click"],[1,"fas","fa-backward"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],["appPermission","","appFunction","BPFC Schedule","appAction","DONE",2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","checked","click","checkedChange"],["doneSwitch",""],["appPermission","","appFunction","BPFC Schedule","appAction","APPROVAL","onLabel","Approved",2,"width","120px",3,"offLabel","checked","click","checkedChange"],["approvalSwitch",""],["type","button","appPermission","","appFunction","BPFC Schedule","appAction","FINISH","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[4,"ngIf"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","bg-gradient-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],["class","col-md-6",4,"ngFor","ngForOf"],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","","title","",1,"form-control",3,"ngModel","value","ngModelChange"]],template:function(e,t){1&e&&(J.Vb(0,"div",0),J.Vb(1,"div",1),J.Vb(2,"div",2),J.Vb(3,"div",3),J.Vb(4,"div",0),J.Vb(5,"div",4),J.Vb(6,"label"),J.Lc(7,"Model Name: "),J.Ub(),J.Ub(),J.Vb(8,"div",5),J.Qb(9,"input",6),J.Ub(),J.Ub(),J.Vb(10,"div",0),J.Vb(11,"div",4),J.Vb(12,"label"),J.Lc(13,"Model NO: "),J.Ub(),J.Ub(),J.Vb(14,"div",5),J.Qb(15,"input",6),J.Ub(),J.Ub(),J.Vb(16,"div",0),J.Vb(17,"div",4),J.Vb(18,"label"),J.Lc(19,"Article NO: "),J.Ub(),J.Ub(),J.Vb(20,"div",5),J.Qb(21,"input",6),J.Ub(),J.Qb(22,"div",7),J.Ub(),J.Vb(23,"div",0),J.Vb(24,"div",4),J.Vb(25,"label"),J.Lc(26,"Process: "),J.Ub(),J.Ub(),J.Vb(27,"div",5),J.Vb(28,"button",8),J.Lc(29),J.Ub(),J.Ub(),J.Qb(30,"div",7),J.Ub(),J.Ub(),J.Ub(),J.Vb(31,"div",2),J.Vb(32,"div",9),J.Jc(33,xn,32,5,"div",10),J.Ub(),J.Ub(),J.Ub(),J.Vb(34,"div",11),J.Vb(35,"div",2),J.Vb(36,"div",12),J.Lc(37),J.kc(38,"translate"),J.Jc(39,Un,22,18,"div",13),J.Ub(),J.Jc(40,Qn,10,6,"div",14),J.Ub(),J.Ub(),J.Jc(41,Hn,27,5,"ng-template",null,15,J.Kc),J.Jc(43,Xn,24,6,"ng-template",null,16,J.Kc),J.Ub(),J.Jc(45,Yn,42,5,"ng-template",null,17,J.Kc)),2&e&&(J.Cb(9),J.pc("value",t.modelNameDetail),J.Cb(6),J.pc("value",t.modelNoDetail),J.Cb(6),J.pc("value",t.articleNoDetail),J.Cb(8),J.Mc(t.artProcessDetail),J.Cb(4),J.pc("ngIf",t.existGlue),J.Cb(4),J.Nc(" ",J.lc(38,8,"PREVIEW")," "),J.Cb(2),J.pc("ngIf",t.existGlue),J.Cb(1),J.pc("ngIf",t.existGlue))},directives:[c.n,k.j,p.d,A.d,A.b,k.e,k.b,p.c,A.c,A.a,k.d,k.a,m.c,u.f,u.i,v.b,v.k,Di.a,c.m,u.a,c.l],pipes:[C.c,c.e],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{animation:warning-frames .5s infinite;color:#000}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),Zn),na=[{path:"",children:[{path:"bpfc-schedule",data:{title:"bpfc-schedule",breadcrumb:"BPFC Schedule",functionCode:"BPFC Schedule"},canActivate:[F.a],children:[{path:"",component:Li},{path:":tab",data:{title:"bpfc-schedule",breadcrumb:"BPFC Schedule",functionCode:"BPFC Schedule"},component:Li},{path:":tab/:keySearch",data:{title:"bpfc-schedule",breadcrumb:"BPFC Schedule",functionCode:"BPFC Schedule"},component:Li},{path:":tab/detail",data:{title:"Detail",breadcrumb:"Detail",functionCode:"BPFC Schedule"},children:[{path:"",component:mi},{path:":id",component:mi}]},{path:":tab/detailv2",data:{title:"Detail",breadcrumb:"Detail",functionCode:"BPFC Schedule"},children:[{path:"",component:ia},{path:":id",component:ia}]}]},{path:"bpfc-status",component:sn,data:{title:"BPFC Status",breadcrumb:"BPFC Status",functionCode:"BPFC Status"},canActivate:[F.a]},{path:"bpfc-1",component:ht,data:{title:"BPFC ",breadcrumb:"BPFC",functionCode:"BPFC"},canActivate:[F.a]}]}],aa=((ta=function e(){s(this,e)}).\u0275fac=function(e){return new(e||ta)},ta.\u0275mod=J.Nb({type:ta}),ta.\u0275inj=J.Mb({imports:[[V.g.forChild(na)],V.g]}),ta);function la(e){return new N.a(e,"./assets/i18n/",".json")}var oa=localStorage.getItem("lang");Object(P.bb)(l("2PVe"),l("GFvd"),l("GFWS"),l("0zpJ"),l("LRxf")),Object(P.bb)(l("2PVe"),l("oP7I"),l("Joj5"),l("3JeS"),l("LRxf")),ea="vi"===oa?oa:"en";var ra,ca=((ra=function e(){s(this,e),"vi"===oa?(ea="vi",setTimeout(function(){P.p.load(l("+7Wi")),Object(P.nb)("vi")})):(ea="en",setTimeout(function(){P.p.load(l("7j5C")),Object(P.nb)("en")}))}).\u0275fac=function(e){return new(e||ra)},ra.\u0275mod=J.Nb({type:ra}),ra.\u0275inj=J.Mb({providers:[c.e],imports:[[E.b,v.c,c.c,u.b,u.l,h.b,aa,g.a,m.d,f.c,p.b,p.a,p.e,b.a,b.c,b.b,v.l,I.a,D.b,A.h,k.i,v.i,S.d,U.b,w.a,D.d,x.a,B.e,v.f,m.g,r.a,C.b.forChild({loader:{provide:C.a,useFactory:la,deps:[y.b]},defaultLanguage:ea})]]}),ra)},NkNT:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("x+4Q"),a=i("8Y7J"),l=i("iInd"),o=function(){var e=function(){function e(t,i,n){s(this,e),this.el=t,this.route=i,this.authService=n}return d(e,[{key:"ngOnInit",value:function(){var e=this;if(this.authService.loggedIn()){var t=JSON.parse(localStorage.getItem("functions")).map(function(e){return e.childrens}),i=this.route.snapshot.data.functionCode,n=[].concat.apply([],t).filter(function(e){return e.functionCode===i});this.el.nativeElement.style.display=n&&n.filter(function(t){return t.functionCode===e.appFunction&&t.code===e.appAction}).length>0?"":"none"}else this.el.nativeElement.style.display="none"}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Pb(a.l),a.Pb(l.a),a.Pb(n.a))},e.\u0275dir=a.Kb({type:e,selectors:[["","appPermission",""]],inputs:{appFunction:"appFunction",appAction:"appAction"}}),e}()},dQqK:function(t,i,n){"use strict";n.d(i,"a",function(){return l});var a=n("iStF"),l=function(){function t(){s(this,t),this.editSettingsTree={allowEditing:!1,allowAdding:!1,allowDeleting:!1,newRowPosition:"Child",mode:"Row"},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=["ExcelExport","Add","Edit","Delete","Cancel","Search"],this.toolbarOptionsTree=["Add","Delete","Search","ExpandAll","CollapseAll","ExcelExport"],this.contextMenuItems=[{text:"Add Child",iconCss:" e-icons e-add",target:".e-content",id:"Add-Sub-Item"},{text:"Delete",iconCss:" e-icons e-delete",target:".e-content",id:"DeleteOC"}]}return d(t,[{key:"Permission",value:function(t){var i=t.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var n,a=o(this.functions);try{for(a.s();!(n=a.n()).done;){var l,r=n.value,c=[],s=o(r.childrens);try{for(s.s();!(l=s.n()).done;){var u=l.value,d=this.makeAction(u.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(g){s.e(g)}finally{s.f()}c.push("Search");var h=c.filter(function(e,t,i){return t===i.indexOf(e)});this.toolbarOptions=h}}catch(g){a.e(g)}finally{a.f()}}},{key:"PermissionForTreeGrid",value:function(t){this.contextMenuItems=[],this.functions=JSON.parse(localStorage.getItem("functions"));var i,n=o(this.functions);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(t.snapshot.data.functionCode.includes(a.functionCode)){var l,r=[],c=o(a.childrens);try{for(c.s();!(l=c.n()).done;){var s=l.value,u=this.makeActionTreeGrid(s.code);r.push.apply(r,e(u.filter(Boolean)))}}catch(h){c.e(h)}finally{c.f()}r.push("Search","ExpandAll","CollapseAll","ExcelExport");var d=r.filter(function(e,t,i){return t===i.indexOf(e)});this.toolbarOptionsTree=d;break}}}catch(h){n.e(h)}finally{n.f()}}},{key:"makeAction",value:function(e){switch(e){case a.a.CREATE:return this.editSettings.allowAdding=!0,["Add","Cancel"];case a.a.EDIT:return this.editSettings.allowEditing=!0,["Edit","Update","Cancel"];case a.a.DELETE:return this.editSettings.allowDeleting=!0,["Delete"];case a.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}},{key:"makeActionTreeGrid",value:function(e){switch(e){case a.a.EXCEL_EXPORT:return["ExcelExport"];case a.a.CREATE:return this.editSettingsTree.allowAdding=!0,this.contextMenuItems.push({text:"Add Child",iconCss:" e-icons e-add",target:".e-content",id:"Add-Sub-Item"}),["Add"];case a.a.EDIT:return this.editSettingsTree.allowEditing=!0,[void 0];case a.a.DELETE:return this.editSettingsTree.allowDeleting=!0,this.contextMenuItems.push({text:"Delete",iconCss:" e-icons e-delete",target:".e-content",id:"DeleteOC"}),[void 0];default:return[void 0]}}}]),t}()},"h9f+":function(e,t,i){"use strict";i.d(t,"a",function(){return u});var n=i("2Vo4"),a=i("lJxs"),l=i("IheW"),o=i("AytR"),r=i("2zK7"),c=i("8Y7J");new l.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});var u=function(){var e=function(){function e(t){s(this,e),this.http=t,this.baseUrl=o.a.apiUrlEC,this.authUrl=o.a.apiUrl,this.messageSource=new n.a(0),this.currentMessage=this.messageSource.asObservable()}return d(e,[{key:"changeMessage",value:function(e){this.messageSource.next(e)}},{key:"getBuildingsAsTreeView",value:function(){return this.http.get("".concat(this.baseUrl,"Building/GetAllAsTreeView"))}},{key:"mappingUserWithBuilding",value:function(e){return this.http.post("".concat(this.baseUrl,"BuildingUser/MappingUserWithBuilding"),e)}},{key:"removeBuildingUser",value:function(e){return this.http.post("".concat(this.baseUrl,"BuildingUser/RemoveBuildingUser"),e)}},{key:"getAllUsers",value:function(e,t){var i=new r.a;return this.http.get("".concat(this.authUrl,"Users/GetAllUsers/").concat(o.a.systemCode,"/").concat(e,"/").concat(t),{observe:"response"}).pipe(Object(a.a)(function(e){return i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i}))}},{key:"deleteUser",value:function(e){return this.http.delete("".concat(this.authUrl,"Users/Delete/").concat(e))}},{key:"updateUser",value:function(e){return this.http.post("".concat(this.authUrl,"Users/Update"),e)}},{key:"createUser",value:function(e){return this.http.post("".concat(this.authUrl,"Users/Create"),e)}},{key:"getAllBuildingUsers",value:function(){return this.http.get("".concat(this.baseUrl,"BuildingUser/getAllBuildingUsers"))}},{key:"getBuildingUserByBuildingID",value:function(e){return this.http.get("".concat(this.baseUrl,"BuildingUser/GetBuildingUserByBuildingID/").concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(c.cc(l.b))},e.\u0275prov=c.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},vrRs:function(e,t,i){"use strict";i.d(t,"a",function(){return u});var n=i("IheW"),a=i("2Vo4"),l=i("lJxs"),o=i("AytR"),r=i("2zK7"),c=i("8Y7J");new n.e({"Content-Type":"application/json"});var u=function(){var e=function(){function e(t){s(this,e),this.http=t,this.baseUrl=o.a.apiUrlEC,this.ingredientSource=new a.a(0),this.currentIngredient=this.ingredientSource.asObservable()}return d(e,[{key:"getIngredients",value:function(e,t){var i=new r.a,a=new n.f;return null!=e&&null!=t&&(a=(a=a.append("pageNumber",e)).append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/getingredients",{observe:"response",params:a}).pipe(Object(l.a)(function(e){return i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i}))}},{key:"search",value:function(e,t,i){var a=new r.a,o=new n.f;return null!=e&&null!=t&&(o=(o=o.append("pageNumber",e)).append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/Search/"+i,{observe:"response",params:o}).pipe(Object(l.a)(function(e){return a.result=e.body,null!=e.headers.get("Pagination")&&(a.pagination=JSON.parse(e.headers.get("Pagination"))),a}))}},{key:"getAllIngredient",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAll",{})}},{key:"rate",value:function(){return this.http.get(this.baseUrl+"ingredient/Rate",{})}},{key:"getAllGlueType",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAllGlueType",{})}},{key:"getByID",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/"+e,{})}},{key:"scanQRCode",value:function(e){return this.http.get(this.baseUrl+"ingredient/ScanQRCode/"+e,{})}},{key:"scanQRCodeFromChemicalWareHouse",value:function(e,t,i){return this.http.get("".concat(this.baseUrl,"ingredient/ScanQRCodeFromChemialWareHouse/").concat(e,"/").concat(t,"/").concat(i),{})}},{key:"scanQRCodeOutput",value:function(e,t,i){return this.http.get("".concat(this.baseUrl,"ingredient/ScanQRCodeOutput/").concat(e,"/").concat(t,"/").concat(i),{})}},{key:"getAllSupplier",value:function(){return this.http.get(this.baseUrl+"Suppier/GetAll",{})}},{key:"getAllIngredientInfo",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfo",{})}},{key:"getAllIngredientInfoOutput",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutPut",{})}},{key:"getAllIngredientInfoByBuildingName",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoByBuildingName/".concat(e),{})}},{key:"getAllIngredientInfoReport",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReport",{})}},{key:"getAllIngredientInfoReportByBuildingName",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReportByBuildingName/".concat(e),{})}},{key:"searchInventory",value:function(e,t){return this.http.get("".concat(this.baseUrl,"ingredient/Search/").concat(e,"/").concat(t),{})}},{key:"searchInventoryByBuildingName",value:function(e,t,i){return this.http.get("".concat(this.baseUrl,"ingredient/SearchWithBuildingName/").concat(e,"/").concat(t,"/").concat(i),{})}},{key:"deleteIngredientInfo",value:function(e,t,i,n){return this.http.delete(this.baseUrl+"ingredient/DeleteIngredientInfo/".concat(e,"/").concat(t,"/").concat(i,"/").concat(n))}},{key:"UpdateConsumption",value:function(e,t,i){return this.http.post(this.baseUrl+"ingredient/UpdateConsumptionIngredientReport/".concat(e,"/").concat(t,"/").concat(i),{})}},{key:"UpdateConsumptionOfBuilding",value:function(e){return this.http.post(this.baseUrl+"ingredient/UpdateConsumptionOfBuildingIngredientReport",e)}},{key:"createSub",value:function(e){return this.http.post(this.baseUrl+"suppier/create",e)}},{key:"updateSub",value:function(e){return this.http.put(this.baseUrl+"suppier/update",e)}},{key:"deleteSub",value:function(e){return this.http.delete(this.baseUrl+"suppier/delete/"+e)}},{key:"sortBySup",value:function(e,t){return this.http.get(this.baseUrl+"GlueIngredient/GetIngredientsByGlueID/".concat(e,"/").concat(t))}},{key:"getIngredientsByGlueID",value:function(e){return this.http.get(this.baseUrl+"GlueIngredient/GetIngredientsByGlueID/".concat(e))}},{key:"create",value:function(e){return this.http.post(this.baseUrl+"ingredient/create1",e)}},{key:"update",value:function(e){return this.http.put(this.baseUrl+"ingredient/update",e)}},{key:"delete",value:function(e){return this.http.delete(this.baseUrl+"ingredient/delete/"+e)}},{key:"changeIngredient",value:function(e){this.ingredientSource.next(e)}},{key:"import",value:function(e,t){var i=new FormData;return i.append("UploadedFile",e),i.append("CreatedBy",t),this.http.post(this.baseUrl+"ingredient/Import",i)}},{key:"downloadFile",value:function(){return this.http.post(this.baseUrl+"ingredient/ExcelExport",{})}},{key:"GetQrcodeByid",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/".concat(e))}},{key:"UpdatePrint",value:function(e){return this.http.put(this.baseUrl+"ingredient/UpdatePrint",e)}},{key:"checkIncoming",value:function(e,t,i){return this.http.get("".concat(this.baseUrl,"ingredient/CheckIncoming/").concat(e,"/").concat(t,"/").concat(i),{})}},{key:"getAllIngredientInfoByBuilding",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoByBuilding/".concat(e),{})}},{key:"getAllIngredientInfoOutputByBuilding",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutputByBuilding/".concat(e),{})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(c.cc(n.b))},e.\u0275prov=c.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()}}])}();