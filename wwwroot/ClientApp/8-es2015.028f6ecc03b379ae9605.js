(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{F7Yq:function(e,t,i){"use strict";i.r(t),i.d(t,"HttpLoaderFactory",function(){return Jn}),i.d(t,"EstablishModule",function(){return Kn});var n=i("xxV/"),s=i("SVse"),l=i("s7LF"),a=i("7g+E"),o=i("wTG2"),r=i("PDtH"),c=i("G0yt"),d=i("wpBH"),h=i("WWtw"),u=i("sWsm"),g=i("10VE"),m=i("Uc7L"),b=i("IheW"),p=i("TSSN"),f=i("k5Gf"),D=i("e7Im"),I=i("KeVr"),C=i("emFE"),N=i("4SUy"),S=i("BrIm"),v=i("4DqM"),y=i("pQl/"),w=i("OoJn"),P=i("bwdU"),B=i("iInd"),A=i("vpVc"),x=i("KCoQ"),U=i("qLS9"),E=i("HJFG"),k=i("h9f+"),V=i("AytR"),F=i("t0UR"),M=i("8Y7J"),L=i("vrRs"),G=i("H552"),T=i("2zK7"),O=i("2Vo4"),j=i("lJxs");new b.e({Authorization:"Bearer "+localStorage.getItem("token")});let J=(()=>{class e{constructor(e){this.http=e,this.baseUrl=V.a.apiUrlEC,this.gueIngredientSource=new O.a({}),this.currentGlueIngredient=this.gueIngredientSource.asObservable(),this.flagSource=new O.a("0"),this.currentFlag=this.flagSource.asObservable()}getIngredients(e,t,i){const n=new T.a;return this.http.get(`${this.baseUrl}GlueIngredient/GetIngredientsByGlueID/${e}`,{observe:"response"}).pipe(Object(j.a)(e=>(n.result=e.body,null!=e.headers.get("Pagination")&&(n.pagination=JSON.parse(e.headers.get("Pagination"))),n)))}getGlues(e,t){const i=new T.a;return this.http.get(`${this.baseUrl}GlueIngredient/getAllGlues/${e}/${t}`,{observe:"response"}).pipe(Object(j.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}mappGlueIngredient(e){return this.http.post(`${this.baseUrl}GlueIngredient/MapGlueIngredient`,e)}mapGlueIngredientByGlueID(e){return this.http.post(`${this.baseUrl}GlueIngredient/MapGlueIngredientByGlueID`,e)}mapGlueIngredient(e){return this.http.post(`${this.baseUrl}GlueIngredient/MapGlueIngredients`,e)}delete(e,t){return this.http.get(`${this.baseUrl}GlueIngredient/${e}/${t}/delete`)}editPercentage(e){return this.http.put(`${this.baseUrl}GlueIngredient/editPercentage`,e)}editAllow(e){return this.http.put(`${this.baseUrl}GlueIngredient/editAllow`,e)}getDetail(e){return this.http.get(this.baseUrl+`GlueIngredient/${e}/detail`)}}return e.\u0275fac=function(t){return new(t||e)(M.cc(b.b))},e.\u0275prov=M.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var R=i("xiVD");let K=(()=>{class e{constructor(e){this.http=e,this.baseUrl=V.a.apiUrlEC}getArticleNos(e,t){const i=new T.a;let n=new b.f;return null!=e&&null!=t&&(n=n.append("pageNumber",e),n=n.append("pageSize",t)),this.http.get(this.baseUrl+"ArticleNo/getArticleNos",{observe:"response",params:n}).pipe(Object(j.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}getAlls(){return this.http.get(this.baseUrl+"ArticleNo/GetAll",{})}getArticleNoByModelNameID(e){return this.http.get(this.baseUrl+"ArticleNo/getArticleNoByModelNameID/"+e,{})}getArticleNoByModelNoID(e){return this.http.get(this.baseUrl+"ArticleNo/getArticleNoByModelNoID/"+e,{})}create(e){return this.http.post(this.baseUrl+"ArticleNo/create",e)}update(e){return this.http.put(this.baseUrl+"ArticleNo/update",e)}delete(e){return this.http.delete(this.baseUrl+"ArticleNo/delete/"+e)}}return e.\u0275fac=function(t){return new(t||e)(M.cc(b.b))},e.\u0275prov=M.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Q=i("j7qE");let H=(()=>{class e{constructor(e){this.http=e,this.baseUrl=V.a.apiUrlEC}getAll(){return this.http.get(this.baseUrl+"ModelNo/GetAll",{})}getModelNoByModelNameID(e){return this.http.get(this.baseUrl+"ModelNo/getModelNoByModelNameID/"+e,{})}}return e.\u0275fac=function(t){return new(t||e)(M.cc(b.b))},e.\u0275prov=M.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),_=(()=>{class e{constructor(e){this.http=e,this.baseUrl=V.a.apiUrlEC}getAll(){return this.http.get(this.baseUrl+"ArtProcess/GetAll",{})}getArtProcessByArticleNoID(e){return this.http.get(this.baseUrl+"ArtProcess/getArtProcessByArticleNoID/"+e,{})}GetAllProcess(){return this.http.get(this.baseUrl+"Process/GetAll",{})}}return e.\u0275fac=function(t){return new(t||e)(M.cc(b.b))},e.\u0275prov=M.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var W=i("CC+3"),q=i("MBJp"),z=i("6U7I"),X=i("WAEy");const Y=["switch"],Z=["grid"],ee=["gridglue"],te=["grid2"],ie=["modelNameDropdownlist"],ne=["modelNoDropdownlist"],se=["chemicalDropdownlist"],le=["positionDropdownlist"];function ae(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",11),M.Vb(1,"button",25),M.fc("click",function(){M.Ec(e);const t=M.jc(),i=M.Bc(48);return t.openModal(i)}),M.Qb(2,"i",26),M.Ub(),M.Ub()}}function oe(e,t){if(1&e){const e=M.Wb();M.Tb(0),M.Vb(1,"ejs-radiobutton",27),M.fc("click",function(t){return M.Ec(e),M.jc().onClickProcess(t)}),M.Ub(),M.Sb()}if(2&e){const e=t.$implicit;M.Cb(1),M.pc("label",e.name)("value",e.id)}}function re(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"GLUE")," ")}function ce(e,t){if(1&e&&(M.Vb(0,"div",40),M.Lc(1),M.Ub()),2&e){const e=t.$implicit;M.qc("title",e.name),M.Cb(1),M.Nc(" ",e.name," ")}}function de(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"CONSUMPTION")," ")}function he(e,t){if(1&e&&(M.Vb(0,"span"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changeConsumptionColor(e)),M.Cb(1),M.Mc(""===e.consumption?"0":e.consumption)}}function ue(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"EXPIRED_TIME")," ")}function ge(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"KIND")," ")}function me(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",41,42),M.fc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangeKindEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.kinds)("ngModel",e.kindName)("fields",i.fieldsKindEdit)("allowFiltering",!0)}}function be(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"PART")," ")}function pe(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",43,44),M.fc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangePartEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.parts)("ngModel",e.partName)("fields",i.fieldsPartEdit)("allowFiltering",!0)}}function fe(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"MATERIAL")," ")}function De(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",43,44),M.fc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangeMaterialEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.materials)("ngModel",e.materialName)("fields",i.fieldsMaterialEdit)("allowFiltering",!0)}}function Ie(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",28),M.Vb(1,"ejs-grid",29,30),M.fc("rowDeselected",function(t){return M.Ec(e),M.jc().rowDeselected(t)})("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginGlue(t)})("rowSelected",function(t){return M.Ec(e),M.jc().rowSelected(t)})("created",function(){return M.Ec(e),M.jc().onCreatedGridGlue()})("toolbarClick",function(t){return M.Ec(e),M.jc().toolbarClick(t)})("dataBound",function(){return M.Ec(e),M.jc().dataBoundGlue()}),M.Vb(3,"e-columns"),M.Vb(4,"e-column",31),M.Jc(5,re,2,3,"ng-template",null,32,M.Kc),M.Jc(7,ce,2,2,"ng-template",null,33,M.Kc),M.Ub(),M.Vb(9,"e-column",34),M.Jc(10,de,2,3,"ng-template",null,32,M.Kc),M.Jc(12,he,2,3,"ng-template",null,33,M.Kc),M.Ub(),M.Vb(14,"e-column",35),M.Jc(15,ue,2,3,"ng-template",null,32,M.Kc),M.Ub(),M.Vb(17,"e-column",36),M.Jc(18,ge,2,3,"ng-template",null,32,M.Kc),M.Jc(20,me,2,4,"ng-template",null,37,M.Kc),M.Ub(),M.Vb(22,"e-column",38),M.Jc(23,be,2,3,"ng-template",null,32,M.Kc),M.Jc(25,pe,2,4,"ng-template",null,37,M.Kc),M.Ub(),M.Vb(27,"e-column",39),M.Jc(28,fe,2,3,"ng-template",null,32,M.Kc),M.Jc(30,De,2,4,"ng-template",null,37,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(1),M.pc("dataSource",e.glues)("editSettings",e.editSettings)("toolbar",e.toolbar)("allowSorting",!0)("selectedRowIndex",e.rowIndex)}}function Ce(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-switch",52,53),M.fc("click",function(){return M.Ec(e),M.jc(2).done()})("ngModelChange",function(t){return M.Ec(e),M.jc(2).createdStatus=t}),M.kc(2,"translate"),M.kc(3,"translate"),M.Ub()}if(2&e){const e=M.jc(2);M.qc("onLabel",M.lc(2,5,"DONE")),M.qc("offLabel",M.lc(3,7,"UNDONE")),M.pc("disabled",e.approvalStatus)("ngModel",e.createdStatus)("checked",e.createdStatus)}}function Ne(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-switch",55),M.fc("click",function(){return M.Ec(e),M.jc(3).approval()})("ngModelChange",function(t){return M.Ec(e),M.jc(3).approvalStatus=t}),M.kc(1,"translate"),M.Ub()}if(2&e){const e=M.jc(3);M.qc("offLabel",M.lc(1,3,"NOT_APPROVED")),M.pc("ngModel",e.approvalStatus)("checked",e.approvalStatus)}}function Se(e,t){if(1&e&&(M.Tb(0),M.Jc(1,Ne,2,5,"ejs-switch",54),M.Sb()),2&e){const e=M.jc(2);M.Cb(1),M.pc("ngIf",e.modelNameID>0)}}function ve(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",56),M.fc("click",function(){return M.Ec(e),M.jc(2).finished()}),M.Qb(1,"i",57),M.Lc(2),M.kc(3,"translate"),M.Ub()}2&e&&(M.Cb(2),M.Nc(" ",M.lc(3,1,"FINISHED")," "))}function ye(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",58),M.fc("click",function(){M.Ec(e);const t=M.jc(2),i=M.Bc(50);return t.openModalHistory(i)}),M.Qb(1,"i",59),M.Lc(2," History"),M.Ub()}}function we(e,t){if(1&e&&(M.Vb(0,"div",45),M.Vb(1,"button",46),M.Qb(2,"i",47),M.Lc(3," Reset "),M.Ub(),M.Jc(4,Ce,4,9,"ejs-switch",48),M.Jc(5,Se,2,1,"ng-container",49),M.Jc(6,ve,4,3,"button",50),M.Jc(7,ye,3,0,"button",51),M.Ub()),2&e){const e=M.jc();M.Cb(4),M.pc("ngIf",e.modelNameID>0),M.Cb(1),M.pc("ngIf",3!==e.level&&4!==e.level),M.Cb(1),M.pc("ngIf",e.modelNameID>0),M.Cb(1),M.pc("ngIf",e.modelNameID>0)}}function Pe(e,t){if(1&e&&(M.Vb(0,"li",76),M.Vb(1,"a"),M.Lc(2),M.Vb(3,"span",77),M.Lc(4),M.Ub(),M.Ub(),M.Ub()),2&e){const e=t.$implicit;M.Cb(2),M.Oc(" ",e.position,". ",e.ingredientName," "),M.Cb(2),M.Nc("(",e.percentage,"%)")}}function Be(e,t){if(1&e&&(M.Vb(0,"ul"),M.Vb(1,"span",73),M.Lc(2),M.Ub(),M.Vb(3,"li",74),M.Lc(4),M.Vb(5,"ul"),M.Jc(6,Pe,5,3,"li",75),M.Ub(),M.Ub(),M.Ub()),2&e){const e=M.jc(2);M.Cb(2),M.Mc(e.formulaTamp()),M.Cb(2),M.Nc(" ",e.formula()," "),M.Cb(2),M.pc("ngForOf",e.renderchemical())}}function Ae(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",78),M.fc("click",function(){M.Ec(e);const i=t.$implicit;return M.jc(2).sortBySup(i.id)}),M.Qb(1,"i",79),M.Lc(2),M.Ub()}if(2&e){const e=t.$implicit;M.Cb(2),M.Nc(" ",e.name," ")}}function xe(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"ITEM")," ")}function Ue(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",80,81),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(2).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Ee(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",80,81),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(2).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function ke(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"INGREDIENT_NAME")," ")}function Ve(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function Fe(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function Me(e,t){if(1&e&&(M.Vb(0,"div"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changePercentageColor(e)),M.Cb(1),M.Mc(e.percentage)}}function Le(e,t){1&e&&(M.Vb(0,"div"),M.Qb(1,"i",82),M.Ub())}function $e(e,t){if(1&e&&(M.Vb(0,"div"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changeAllowColor(e)),M.Cb(1),M.Nc("\xb1 ",e.allow,"")}}function Ge(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"ITEM")," ")}function Te(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",80,81),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(2).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Oe(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",80,81),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(2).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function je(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"INGREDIENT_NAME")," ")}function Je(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function Re(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function Ke(e,t){1&e&&(M.Vb(0,"div"),M.Qb(1,"i",82),M.Ub())}function Qe(e,t){if(1&e&&(M.Vb(0,"div"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changeAllowColor(e)),M.Cb(1),M.Nc("\xb1 ",e.allow,"")}}function He(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",60),M.Jc(1,Be,7,3,"ul",49),M.Vb(2,"div",0),M.Vb(3,"div",61),M.Vb(4,"button",62),M.fc("click",function(){return M.Ec(e),M.jc().sortBySup(0)}),M.Lc(5),M.kc(6,"translate"),M.Ub(),M.Jc(7,Ae,3,1,"button",63),M.Ub(),M.Ub(),M.Vb(8,"div",0),M.Vb(9,"div",64),M.Vb(10,"div",15),M.Vb(11,"div",28),M.Vb(12,"ejs-grid",65,66),M.fc("actionComplete",function(t){return M.Ec(e),M.jc().actionCompleteIngredient(t)})("recordDoubleClick",function(t){return M.Ec(e),M.jc().onDoubleClickIngredient(t)})("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginIngredient(t)})("toolbarClick",function(t){return M.Ec(e),M.jc().toolbarClickIngredient(t)})("rowSelected",function(t){return M.Ec(e),M.jc().rowSelectedIngredient(t)}),M.Vb(14,"e-columns"),M.Vb(15,"e-column",67),M.Jc(16,xe,2,3,"ng-template",null,32,M.Kc),M.Jc(18,Ue,2,4,"ng-template",null,33,M.Kc),M.Jc(20,Ee,2,4,"ng-template",null,37,M.Kc),M.Ub(),M.Vb(22,"e-column",68),M.Jc(23,ke,2,3,"ng-template",null,32,M.Kc),M.Jc(25,Ve,1,1,"ng-template",null,37,M.Kc),M.Jc(27,Fe,1,1,"ng-template",null,33,M.Kc),M.Ub(),M.Vb(29,"e-column",69),M.Jc(30,Me,2,3,"ng-template",null,33,M.Kc),M.Ub(),M.Vb(32,"e-column",70),M.Jc(33,Le,2,0,"ng-template",null,32,M.Kc),M.Jc(35,$e,2,3,"ng-template",null,33,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(37,"div",64),M.Vb(38,"div",15),M.Vb(39,"div",28),M.Vb(40,"ejs-grid",71,72),M.fc("actionComplete",function(t){return M.Ec(e),M.jc().actionCompleteIngredient(t)})("recordDoubleClick",function(t){return M.Ec(e),M.jc().onDoubleClickIngredient(t)})("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginIngredient(t)})("toolbarClick",function(t){return M.Ec(e),M.jc().toolbarClickIngredient(t)})("rowSelected",function(t){return M.Ec(e),M.jc().rowSelectedIngredient(t)}),M.Vb(42,"e-columns"),M.Vb(43,"e-column",67),M.Jc(44,Ge,2,3,"ng-template",null,32,M.Kc),M.Jc(46,Te,2,4,"ng-template",null,33,M.Kc),M.Jc(48,Oe,2,4,"ng-template",null,37,M.Kc),M.Ub(),M.Vb(50,"e-column",68),M.Jc(51,je,2,3,"ng-template",null,32,M.Kc),M.Jc(53,Je,1,1,"ng-template",null,37,M.Kc),M.Jc(55,Re,1,1,"ng-template",null,33,M.Kc),M.Ub(),M.Qb(57,"e-column",69),M.Vb(58,"e-column",70),M.Jc(59,Ke,2,0,"ng-template",null,32,M.Kc),M.Jc(61,Qe,2,3,"ng-template",null,33,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(1),M.pc("ngIf",e.renderchemical().length>0),M.Cb(4),M.Nc(" ",M.lc(6,12,"DEFAULT")," "),M.Cb(2),M.pc("ngForOf",e.supplier),M.Cb(5),M.pc("dataSource",e.ingredients1)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions2),M.Cb(28),M.pc("dataSource",e.ingredients2)("allowSorting",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions2)}}function _e(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",83),M.Vb(1,"h4",84),M.Qb(2,"i",85),M.Lc(3," Clone Article "),M.Ub(),M.Vb(4,"button",86),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",87),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",88),M.Vb(8,"div",0),M.Vb(9,"div",89),M.Vb(10,"div",90),M.Vb(11,"label",91),M.Lc(12,"Article Name"),M.Ub(),M.Vb(13,"span",92),M.Lc(14,"(*)"),M.Ub(),M.Vb(15,"input",93),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc().articleName=t}),M.Ub(),M.Ub(),M.Ub(),M.Vb(16,"div",89),M.Vb(17,"div",90),M.Vb(18,"label",91),M.Lc(19,"Process"),M.Ub(),M.Vb(20,"ejs-dropdownlist",94,95),M.fc("change",function(t){return M.Ec(e),M.jc().onChangeProcessCloneModal(t)}),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(22,"div",96),M.Vb(23,"button",97),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(24,"Close"),M.Ub(),M.Vb(25,"button",98),M.fc("click",function(){return M.Ec(e),M.jc().cloneArticleModelname()}),M.Lc(26,"Clone"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(15),M.pc("ngModel",e.articleName),M.Cb(5),M.pc("value",e.valueProcess)("dataSource",e.processData)("allowFiltering",!0)("fields",e.processfields)}}function We(e,t){if(1&e){const e=M.Wb();M.Tb(0),M.Vb(1,"ejs-radiobutton",102),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc(2).artProcessIDClone=t}),M.Ub(),M.Sb()}if(2&e){const e=t.$implicit,i=M.jc(2);M.Cb(1),M.pc("label",e.name)("value",e.id)("ngModel",i.artProcessIDClone)}}function qe(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",83),M.Vb(1,"h4",84),M.Qb(2,"i",85),M.Lc(3," Clone BPFC "),M.Ub(),M.Vb(4,"button",86),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",87),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",88),M.Vb(8,"div",0),M.Vb(9,"div",89),M.Vb(10,"div",90),M.Vb(11,"label",91),M.Lc(12,"Model Name"),M.Ub(),M.Vb(13,"span",92),M.Lc(14,"(*)"),M.Ub(),M.Vb(15,"ejs-dropdownlist",99,7),M.fc("open",function(){return M.Ec(e),M.jc().openPopupDropdownlist()})("filtering",function(t){return M.Ec(e),M.jc().onFilteringModelNameClone(t)})("select",function(t){return M.Ec(e),M.jc().onChangeModelNameClone(t)}),M.Ub(),M.Lc(17),M.Ub(),M.Ub(),M.Vb(18,"div",89),M.Vb(19,"div",90),M.Vb(20,"label",91),M.Lc(21,"Model NO"),M.Ub(),M.Vb(22,"span",92),M.Lc(23,"(*)"),M.Ub(),M.Vb(24,"ejs-dropdownlist",100,10),M.fc("dataBound",function(t){return M.Ec(e),M.jc().OndataBound(t)})("filtering",function(t){return M.Ec(e),M.jc().onFilteringModelNOClone(t)})("select",function(t){return M.Ec(e),M.jc().onChangeModelNoClone(t)}),M.Ub(),M.Lc(26),M.Ub(),M.Ub(),M.Vb(27,"div",89),M.Vb(28,"div",90),M.Vb(29,"label",91),M.Lc(30,"Article NO"),M.Ub(),M.Vb(31,"span",92),M.Lc(32,"(*)"),M.Ub(),M.Vb(33,"ejs-dropdownlist",101,7),M.fc("filtering",function(t){return M.Ec(e),M.jc().onFilteringArticleNOClone(t)})("ngModelChange",function(t){return M.Ec(e),M.jc().articleNOIDClone=t})("select",function(t){return M.Ec(e),M.jc().onChangeArticleNoClone(t)}),M.Ub(),M.Lc(35),M.Ub(),M.Ub(),M.Vb(36,"div",89),M.Vb(37,"div",90),M.Vb(38,"label",91),M.Lc(39,"Process"),M.Ub(),M.Vb(40,"span",92),M.Lc(41,"(*)"),M.Ub(),M.Vb(42,"div",13),M.Jc(43,We,2,3,"ng-container",14),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(44,"div",96),M.Vb(45,"button",97),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(46,"Close"),M.Ub(),M.Vb(47,"button",98),M.fc("click",function(){return M.Ec(e),M.jc().onClickClone()}),M.Lc(48,"Clone"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(15),M.pc("dataSource",e.modelNameDataClone)("fields",e.fieldsBPFCs)("allowFiltering",!0)("value",e.value),M.Cb(2),M.Nc(" ",e.modelNameIDClone," "),M.Cb(7),M.pc("dataSource",e.modelNOsDataClone)("fields",e.fieldsBPFCs)("allowFiltering",!0)("value",e.valuemodelNo),M.Cb(2),M.Nc(" ",e.modelNOIDClone," "),M.Cb(7),M.pc("dataSource",e.articleNosDataClone)("fields",e.fieldsBPFCs)("allowFiltering",!0)("ngModel",e.articleNOIDClone),M.Cb(2),M.Nc(" ",e.articleNOIDClone," "),M.Cb(8),M.pc("ngForOf",e.artProcessDataClone2)}}function ze(e,t){1&e&&(M.Lc(0),M.kc(1,"date")),2&e&&M.Nc(" ",M.mc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function Xe(e,t){if(1&e&&(M.Tb(0),M.Qb(1,"input",115),M.Sb()),2&e){const e=M.jc().$implicit;M.Cb(1),M.pc("value",e.remark)}}function Ye(e,t){if(1&e&&M.Qb(0,"input",116),2&e){const e=M.jc().$implicit;M.pc("value",e.remark)}}function Ze(e,t){if(1&e&&(M.Vb(0,"span",112),M.Jc(1,Xe,2,1,"ng-container",113),M.Jc(2,Ye,1,1,"ng-template",null,114,M.Kc),M.Ub()),2&e){const e=t.$implicit,i=M.Bc(3);M.pc("ngClass","Improve"==e.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),M.Cb(1),M.pc("ngIf","Improve"==e.action)("ngIfElse",i)}}function et(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",83),M.Vb(1,"h4",84),M.Qb(2,"i",85),M.Lc(3," BPFC History "),M.Ub(),M.Vb(4,"button",86),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",87),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",88),M.Vb(8,"ejs-grid",103,104),M.fc("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginHistory(t)}),M.Vb(10,"e-columns"),M.Vb(11,"e-column",105),M.Jc(12,ze,2,4,"ng-template",null,33,M.Kc),M.Ub(),M.Qb(14,"e-column",106),M.Qb(15,"e-column",107),M.Qb(16,"e-column",108),M.Vb(17,"e-column",109),M.Jc(18,Ze,4,3,"ng-template",null,37,M.Kc),M.Ub(),M.Qb(20,"e-column",110),M.Ub(),M.Ub(),M.Ub(),M.Vb(21,"div",96),M.Vb(22,"button",111),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(23,"Close"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(8),M.pc("dataSource",e.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettingsHis)("toolbar",e.toolbarOptionsHistory),M.Cb(9),M.pc("edit",e.editparamsHis)}}let tt=(()=>{class e{constructor(e,t,i,n,s,l,a,o,r,c,d,h,u,g,m,b){this.glueIngredientService=e,this.modalNameService=t,this.glueService=i,this.alertify=n,this.modalService=s,this.route=l,this.authService=a,this.bPFCEstablishService=o,this.modelNoService=r,this.articleNoService=c,this.kindService=d,this.partService=h,this.materialService=u,this.buildingUserService=g,this.artProcessService=m,this.ingredientService=b,this.data=[],this.modelNameData=[],this.modelNoData=[],this.positions=["B","C","D","E"],this.articleNoData=[],this.modelNameClone=[],this.modelNoClone=[],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={},this.ingredient={},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.ingredients1=[],this.ingredients2=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search","Add","Delete","Cancel"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.onFiltering=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelName=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringModelNameClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringArtProcessClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.artProcessDataClone,t)}}ngOnInit(){this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(e=>{200===e&&this.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}onChangeProcessCloneModal(e){e.itemData&&(this.processID=e.itemData.id)}resetLifeCycleBPFC(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}onCreatedGridGlue(){}ngAfterViewInit(){$('[data-toggle="tooltip"]').tooltip();const e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}onChangeKindEdit(e){this.kindEdit=e.value,this.kindID=e.itemData.id}onChangePartEdit(e){this.partEdit=e.value,this.partID=e.itemData.id}onChangeMaterialEdit(e){this.kindEdit=e.value,this.materialID=e.itemData.id}dataBoundGlue(){$('[data-toggle="tooltip"]').tooltip(),this.selectedRow.length?(this.gridglue.selectRows(this.selectedRow),this.selectedRow=[]):this.gridglue.selectRows(this.selIndex)}actionBeginGlue(e){"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":`Consumption ${e.rowData.consumption}`,this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=`Consumption ${e.data.consumption}`,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{this.getBPFCID({modelNameID:this.modelNameID,modelNoID:this.modelNoID,articleNoID:this.articleNoID,artProcessID:this.artProcessID})}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{this.glueService.delete(e.data[0].id).subscribe(()=>{this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.removeLocalStore("details"),this.glueIngredientDetail=[],this.oldDetail=[],this.grid.refresh(),this.grid2.refresh(),this.alertify.success("Glue has been deleted")},e=>{this.alertify.error("Failed to delete the Glue")})}))}rowDeselected(e){const t=e.rowIndex,i=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,i)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(e=>{if(this.modified=!0,this.gridglue.getSelectedRowIndexes().length){const e=this.gridglue.dataSource[t];e.name=e.chemical.name,this.gridglue.refresh()}}).catch(e=>{this.gridglue.selectRows([t])})}rowSelected(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);const t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}onChangePosition(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;const n=e.value;let s=this.getLocalStore("details");if(""===e.value);else{if(0!==s.length){let t="";switch(s[s.length-1].position){case"A":t="B";break;case"B":t="C";break;case"C":t="D";break;case"D":t="E"}if(n!==t)return this.alertify.warning(`H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 ${t}`,!0),this.grid.refresh(),this.grid2.refresh(),void(e.cancel=!0)}if(0===s.filter(t=>t.position===e.value).length&&null!==e.value)if(s=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==s.filter(e=>e.ingredientName===t.name&&e.position===t.position).length){const i=s.findIndex(e=>e.ingredientName===t.name);s[i].position=e.value,this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.refresh()}else{s=this.getLocalStore("details");const i={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(i.percentage=100,i.expiredTime=t.expiredTime),s.push(i),this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.refresh()}}}recordDoubleClick(e){this.modifiedGlue=!0}toolbarClickIngredient(e){switch(e.item.text){case"Add":e.cancel=!0,this.openIngredientModalComponent()}}onDoubleClickIngredient(e){this.setFocus=e.column}rowSelectedIngredient(e){this.ingridientID=e.data.id}genaratorGlueCode(){this.glue.code=this.makeid(8)}makeid(e){let t="";const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length;for(let s=0;s<e;s++)t+=i.charAt(Math.floor(Math.random()*n));return t}compareArray(e,t){return JSON.stringify(e)===JSON.stringify(t)}setLocalStore(e,t){localStorage.removeItem(e);const i=JSON.stringify(t);localStorage.setItem(e,i)}getLocalStore(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}removeLocalStore(e){localStorage.removeItem(e)}dynamicSort(e){let t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),(i,n)=>-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}checkColorCode(e){return!0===e.approvalStatus&&!0===e.finishedStatus}checkDone(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}checkStatus(e,t){return!0===e&&!0===t?"Done":"Undone"}renderchemical(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}makeFormula(){var e,t;const i=this.getLocalStore("details").filter(e=>"A"===e.position)||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);const n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}formula(){return this.B&&this.C&&this.D&&this.E?`{[ (${this.nameGlue}+ ${this.B}) + ${this.C} ] + ${this.D}}+ ${this.E}`:this.B&&this.C&&this.D?`[(${this.nameGlue} + ${this.B}) + ${this.C}] + ${this.D}`:this.B&&this.C?`(${this.nameGlue} + ${this.B}) + ${this.C}`:this.B?`${this.nameGlue} + ${this.B}`:`${this.nameGlue}`}formulaTamp(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName=`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`,`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`):this.BB&&this.CC&&this.DD?(this.glueNewName=`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`,`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`):this.BB&&this.CC?(this.glueNewName=`(${this.nameGlues} + ${this.BB}) + ${this.CC}`,`(${this.nameGlues} + ${this.BB}) + ${this.CC}`):this.BB?(this.glueNewName=`${this.nameGlues} + ${this.BB}`,`${this.nameGlues} + ${this.BB}`):`${this.nameGlues}`}getDetail(e){this.glueIngredientService.getDetail(e).subscribe(e=>{var t,i,n,s;this.glueIngredientDetail=e.glueIngredients,this.setLocalStore("details",this.glueIngredientDetail),this.setLocalStore("detailsTamp",this.glueIngredientDetail),this.glueIngredientDetail=this.renderchemical(),this.oldDetail=this.renderchemical();const l=this.glueIngredientDetail.filter(e=>"A"===e.position)||[];this.nameGlue=(null===(t=l[0])||void 0===t?void 0:t.ingredientName)||"",this.nameGlues=(null===(i=l[0])||void 0===i?void 0:i.ingredientName)+"^"+(null===(n=this.glueIngredientDetail[0])||void 0===n?void 0:n.allow)+"%"||!1,this.A=(null===(s=l[0])||void 0===s?void 0:s.ingredientName)||"",void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCount.join("+"),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0)})}updateChemicalList(){const e=this.getLocalStore("details");for(const t of e){const e=this.ingredients1.findIndex(e=>e.name===t.ingredientName&&e.id===t.ingredientID);-1!==e&&(this.ingredients1[e].position=t.position,this.ingredients1[e].percentage=t.percentage,this.ingredients1[e].allow=t.allow)}for(const t of e){const e=this.ingredients2.findIndex(e=>e.name===t.ingredientName&&e.id===t.ingredientID);-1!==e&&(this.ingredients2[e].position=t.position,this.ingredients2[e].percentage=t.percentage,this.ingredients2[e].allow=t.allow)}}actionBeginIngredient(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;const t=Number(this.percentageDefault)!==Number(this.percentageChange),i=Number(this.allowDefault)!==Number(this.allowChange);if(t){this.modified=!1;const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);t[i].percentage=e.data.percentage,this.setLocalStore("details",t),this.updateChemicals()}if(i){const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);t[i].allow=e.data.allow,this.setLocalStore("details",t),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicals()}}"delete"===e.requestType&&this.deleteIngredient()}updateGlueIngredient(){}loadPreview(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}resolver(){this.route.data.subscribe(e=>{this.glues=e.glues.result,this.paginationG=e.glues.pagination})}onService(){this.ingredientService.currentIngredient.subscribe(e=>{300===e&&(this.getIngredients(),this.updateChemicalList(),this.ingredientService.changeIngredient(0))})}mapGlue(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}getIngredients(){this.glueIngredientService.getIngredients(this.glueid).subscribe(e=>{this.ingredients1=e.result.list1,this.ingredients2=e.result.list2},e=>{this.alertify.error(e)})}getGlues(){this.glueService.getAllGlue().subscribe(e=>{this.glues=e},e=>{this.alertify.error(e)})}mapGlueIngredients(e){this.glueIngredientService.mapGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid))})}mapGlueIngredient(e){this.glueIngredientService.mappGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.getAllGluesByBPFCID(this.BPFCID),this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid),this.getAllGluesByBPFCID(this.BPFCID))})}mapGlueIngredientByGlueID(e){this.glueIngredientService.mapGlueIngredientByGlueID(e).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!0,this.modified=!0,this.modified=!0,void 0===this.subID?(this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid))})}openIngredientModalComponent(){const e=this.modalService.open(X.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(e=>{},e=>{})}actionCompleteIngredient(e){"beginEdit"===e.requestType&&"Item"!==this.setFocus.field&&(e.form.elements.namedItem(this.setFocus.field).focus(),e.form.elements.namedItem(this.setFocus.field).value="")}openPopupDropdownlist(){$('[data-toggle="tooltip"]').tooltip()}toolbarClick(e){switch(e.item.text){case"Add New":const t=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,t)&&t.length>0&&this.oldDetail.length>0?this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(e=>{this.glue.id=0,this.glue.name="1",this.glue.BPFCEstablishID=this.BPFCID,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.saveGlue()}).catch(t=>{e.cancel=!0}):(this.glue.id=0,this.glue.name="1",this.glue.BPFCEstablishID=this.BPFCID,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.saveGlue())}}openModal(e){this.getModelNamesClone(),this.getAllProcess(),this.modalReference=this.modalService.open(e)}openModalHistory(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}LoadHistoryBPFC(){this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(e=>{this.historyData=e.map(e=>({id:e.id,glueID:e.glueID,createdTime:e.createdTime,bpfcEstablishID:e.bpfcEstablishID,before:e.before,after:e.after,action:e.action,remark:e.remark,userID:e.userID,createdBy:this.createdBy(e.userID)}))})}actionBeginHistory(e){"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(e=>{e&&this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}getAllUsers(){this.buildingUserService.getAllUsers(1,1e3).subscribe(e=>{this.userData=e.result})}createdBy(e){if(0===e)return"#N/A";const t=this.userData.filter(t=>t.ID===e)[0];return void 0!==t?t.Username:"#N/A"}cloneModelname(){this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",()=>{this.modalNameService.cloneModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.valueProcess).subscribe(e=>{this.alertify.success("the model name has been cloned"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}cloneArticleModelname(){this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",()=>{this.modalNameService.cloneArticleModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.articleName,this.processID).subscribe(e=>{this.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}delete(e,t){this.glueIngredientService.delete(e,t).subscribe(t=>{this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),this.getIngredients(),this.getDetail(e)})}deleteGlue(e){this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.glueService.delete(e.id).subscribe(()=>{this.getGlues(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}deleteIngridient(e){this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.ingredientService.delete(e.id).subscribe(()=>{this.getIngredients(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}getAllGluesByBPFCID(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{this.glues=e})}getAllGluesByBPFCID2(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{void 0===this.ingredientID?(this.glues=e,e.length>0&&(this.detailGlue=!0)):(this.glueid=e[0].id,this.glueIngredient2.ingredientID=this.ingredientID,this.glueIngredient2.percentage=100,this.glueIngredient2.glueID=this.glueid,this.glueIngredient2.position="A",this.mapGlueIngredient(this.glueIngredient2))})}updateChemicals(){this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2;const t=this.getLocalStore("details");for(const i of t){const e=this.ingredients1.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients1[e].position=i.position,this.ingredients1[e].percentage=i.percentage,this.ingredients1[e].allow=i.allow)}for(const i of t){const e=this.ingredients2.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients2[e].position=i.position,this.ingredients2[e].percentage=i.percentage,this.ingredients2[e].allow=i.allow)}this.glueIngredientDetail=t,this.makeFormula()})}sortBySup(e){0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(t=>{if(this.ingredients1=t.list1,this.ingredients2=t.list2,0===e){const e=this.getLocalStore("details");this.ingredients1=e.map(e=>({id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,glueTypeID:0,cbd:e.cbd,replacementFrequency:0,prepareTime:0,partNO:"",standardCycle:0})),this.glueIngredientDetail=e}else this.updateChemicalList()}))}saveGlue(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}getBuilding(){JSON.parse(localStorage.getItem("user"))}getAllIngredient(){this.ingredientService.getAllIngredient().subscribe(e=>{this.ingrediented=e})}createGlue(){this.glueService.create(this.glue).subscribe(()=>{this.alertify.success("Add successfully!<br>\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.clearGlueForm(),this.genaratorGlueCode(),this.expiredTime=0},e=>{this.alertify.error(e),this.genaratorGlueCode()})}finished(){const e=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=e,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{});const t=this.getLocalStore("details"),i=this.gridglue.getSelectedRecords()[0];i.expiredTime=t.filter(e=>"A"===e.position)[0].expiredTime,i.kindID=0===i.kindID?null:i.kindID,i.partID=0===i.partID?null:i.partID,i.materialID=0===i.materialID?null:i.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),t.length>0&&this.mapGlueIngredientByGlueID({glueName:i.name,glueID:i.id,glueIngredientForMapDto:t})}}clearGlueForm(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}update(){this.glueService.update(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.history.Action="Created",this.expiredTime=0})}updateChemical(){this.glueService.updateChemical(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.onChangeChemical=!1,this.history.Action="Created"})}deleteIngredient(){this.ingredientService.delete(this.ingridientID).subscribe(()=>{const e=this.getLocalStore("details").filter(e=>e.ingredientID!==this.ingridientID);this.setLocalStore("details",e),this.glueIngredientDetail=e,this.getIngredients(),this.makeFormula(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}approval(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const l of e){if("STF"===this.artProcess&&null===l.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.approvalStatus=!this.approvalStatus);if(l.glueIngredients.length>0){const e=l.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0&&"A"!==n.position)return t=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The allowance of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);if(n.percentage<=0&&"A"!==n.position)return i=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);t=!0,i=!0}}if(+l.consumption<=0)return n=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The consumption of glue name ${l.name} must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${l.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${l.name} <br>\n          `,!0);n=!0}const s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(e=>{this.alertify.success("The BPFC has been approved!"),this.createdStatus=this.approvalStatus;const t=this.modelNameDropdownlist.getDataByValue(this.modelNameDropdownlist.value);this.modelNameDropdownlist.valueTemplate=`(${this.checkStatus(this.approvalStatus,this.createdStatus)}) ${t.name}`})}}done(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const s of e){if("STF"===this.artProcess&&null===s.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.createdStatus=!this.createdStatus);if(s.glueIngredients.length>0){const e=s.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0)return t=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The allow of checmical name ${n.ingredient.name} is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);if(n.percentage<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);t=!0,i=!0}0===e.length&&(t=!0,i=!0)}if(s.consumption<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The consumption of glue name ${s.name} is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${s.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${s.name} <br>\n          `,!0);n=!0}if(t&&i&&n){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,e).subscribe(e=>{!0===e.status?(this.alertify.success(e.message),this.createdStatus=this.createdStatus):this.alertify.success(e.message)})}}}getModelNames(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameData=e.map(e=>({id:e.id,name:e.name}))})}getArticleNoByModelNameID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNoData=e})}getModelNoByModelNameID(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNoData=e})}getArtProcessByArticleNoID(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessData=e.map(e=>({id:e.id,name:1===e.processID?"ASY":"STF"}))})}getAllProcess(){this.artProcessService.GetAllProcess().subscribe(e=>{this.artProcessDataClone2=e})}getAllKind(){this.kindService.getAllKind().subscribe(e=>{this.kinds=e})}getAllPart(){this.partService.getAllPart().subscribe(e=>{this.parts=e})}getAllMaterial(){this.materialService.getAllMaterial().subscribe(e=>{this.materials=e})}getIngredientsByGlueID(){this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2})}getAllSupllier(){this.ingredientService.getAllSupplier().subscribe(e=>{this.supplier=e})}getArticleNoByModelNoID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosData=e})}getBPFCID(e){this.bPFCEstablishService.getBPFCID(e).subscribe(e=>{this.resetLifeCycleBPFC(),this.BPFCID=null==e?void 0:e.id,this.approvalStatus=e.approvalStatus,this.createdStatus=e.finishedStatus,this.artProcess=e.artProcess,this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}OndataBound(e){this.modelNoDropdownlist.value=this.value}getModelNamesClone(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameDataClone=e.map(e=>({id:e.id,name:e.name})),this.getModelNoByModelNameIDClone(this.modelNameIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]})}getArticleNoByModelNameIDClone(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosDataClone=e})}getModelNoByModelNameIDClone(e){this.modelNoService.getModelNoByModelNameID(e||0).subscribe(e=>{this.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}getArtProcessByArticleNoIDClone(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessDataClone=e.map(e=>({id:e.id,name:1===e.ProcessID?"ASY":"STF"}))})}clone(e){this.modalNameService.clone(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalService.dismissAll(),this.getArtProcessByArticleNoID(this.articleNoID),this.clearFormClone()):this.alertify.error(e.message)})}onChangeModelName(e){this.resetLifeCycleBPFC(),this.modelNameID=e.itemData.id,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}onChangeModelNo(e){e.isInteracted&&(this.modelNoID=e.itemData.id,this.valuemodelNo=e.itemData.id,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}onChangeArticleNo(e){e.isInteracted&&(this.articleNoID=e.itemData.id,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}onClickProcess(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue),this.getBPFCID({modelNameID:this.modelNameID,modelNoID:this.modelNoID,articleNoID:this.articleNoID,artProcessID:this.artProcessID}))}ClickProcessData(e){}clearFormClone(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}onClickClone(){const e={modelNameID:this.modelNameIDClone,modelNOID:this.modelNOIDClone,articleNOID:this.articleNOIDClone,artProcessID:Number(this.artProcessIDClone),bpfcID:this.BPFCID,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}onChangeModelNameClone(e){this.value!==e.itemData.id&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.itemData.id,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.itemData.id,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}onChangeModelNoClone(e){this.modelNOIDClone=e.itemData.id,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}onChangeArticleNoClone(e){e.isInteracted&&(this.articleNOIDClone=e.itemData.id,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}onChangeProcessClone(e){e.isInteracted&&(this.artProcessIDClone=e.itemData.id)}changeAllowColor(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changePercentageColor(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changeConsumptionColor(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}return e.\u0275fac=function(t){return new(t||e)(M.Pb(J),M.Pb(U.a),M.Pb(R.a),M.Pb(E.a),M.Pb(c.b),M.Pb(B.a),M.Pb(Q.a),M.Pb(F.a),M.Pb(H),M.Pb(K),M.Pb(W.a),M.Pb(q.a),M.Pb(z.a),M.Pb(k.a),M.Pb(_),M.Pb(L.a))},e.\u0275cmp=M.Jb({type:e,selectors:[["app-glue-ingredient"]],viewQuery:function(e,t){if(1&e&&(M.Rc(Y,1),M.Rc(Z,1),M.Rc(ee,1),M.Rc(te,1),M.Rc(ie,1),M.Rc(ne,1),M.Rc(se,1),M.Rc(le,1)),2&e){let e;M.Ac(e=M.gc())&&(t.switch=e.first),M.Ac(e=M.gc())&&(t.grid=e.first),M.Ac(e=M.gc())&&(t.gridglue=e.first),M.Ac(e=M.gc())&&(t.grid2=e.first),M.Ac(e=M.gc())&&(t.modelNameDropdownlist=e.first),M.Ac(e=M.gc())&&(t.modelNoDropdownlist=e.first),M.Ac(e=M.gc())&&(t.chemicalDropdownlist=e.first),M.Ac(e=M.gc())&&(t.positionDropdownlist=e)}},features:[M.Bb([C.n,C.f,C.k])],decls:51,vars:20,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["placeholder","Select a Model Name",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],["modelNameDropdownlist",""],["class","col-md-1 mt-2",4,"ngIf"],["placeholder","Select a Model NO",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],["modelNoDropdownlist",""],[1,"col-md-1","mt-2"],["placeholder","Select article NO   ",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],[1,"col-md-9","mt-2"],[4,"ngFor","ngForOf"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],[1,"card-title"],["class","card-tools",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["cloneModal",""],["HistoryModal",""],["ejs-button","","cssClass","e-info",1,"float-right","ml-1",3,"click"],[1,"fa","fa-clone"],["name","process",3,"label","value","click"],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["kindDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],[1,"card-tools"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],["style","width: 100px; margin-right: 10px;",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click",4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click",4,"ngIf"],[2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange"],["switch",""],["onLabel","Approved","style","width: 120px;",3,"offLabel","ngModel","checked","click","ngModelChange",4,"ngIf"],["onLabel","Approved",2,"width","120px",3,"offLabel","ngModel","checked","click","ngModelChange"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","btn-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],["height","675px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid2",""],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["placeholder","Select a Model Name",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","value","open","filtering","select"],["placeholder","Select a Model NO",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","value","dataBound","filtering","select"],["placeholder","Select article NO   ",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","filtering","ngModelChange","select"],["name","process2",3,"label","value","ngModel","ngModelChange"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"]],template:function(e,t){1&e&&(M.Vb(0,"div",0),M.Vb(1,"div",1),M.Vb(2,"div",2),M.Vb(3,"div",3),M.Vb(4,"div",0),M.Vb(5,"div",4),M.Vb(6,"label"),M.Lc(7,"Model Name: "),M.Ub(),M.Ub(),M.Vb(8,"div",5),M.Vb(9,"ejs-dropdownlist",6,7),M.fc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.modelNameID=e})("filtering",function(e){return t.onFilteringModelName(e)})("select",function(e){return t.onChangeModelName(e)}),M.Ub(),M.Ub(),M.Jc(11,ae,3,0,"div",8),M.Ub(),M.Vb(12,"div",0),M.Vb(13,"div",4),M.Vb(14,"label"),M.Lc(15,"Model NO: "),M.Ub(),M.Ub(),M.Vb(16,"div",5),M.Vb(17,"ejs-dropdownlist",9,10),M.fc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.modelNoID=e})("filtering",function(e){return t.onFilteringModelNO(e)})("select",function(e){return t.onChangeModelNo(e)}),M.Ub(),M.Ub(),M.Qb(19,"div",11),M.Ub(),M.Vb(20,"div",0),M.Vb(21,"div",4),M.Vb(22,"label"),M.Lc(23,"Article NO: "),M.Ub(),M.Ub(),M.Vb(24,"div",5),M.Vb(25,"ejs-dropdownlist",12,7),M.fc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.articleNoID=e})("filtering",function(e){return t.onFilteringArticleNO(e)})("select",function(e){return t.onChangeArticleNo(e)}),M.Ub(),M.Ub(),M.Qb(27,"div",11),M.Ub(),M.Vb(28,"div",0),M.Vb(29,"div",4),M.Vb(30,"label"),M.Lc(31,"Process: "),M.Ub(),M.Ub(),M.Vb(32,"div",13),M.Jc(33,oe,2,2,"ng-container",14),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(34,"div",2),M.Vb(35,"div",15),M.Jc(36,Ie,32,5,"div",16),M.Ub(),M.Ub(),M.Ub(),M.Vb(37,"div",17),M.Vb(38,"div",2),M.Vb(39,"div",18),M.Vb(40,"h3",19),M.Lc(41),M.kc(42,"translate"),M.Ub(),M.Jc(43,we,8,4,"div",20),M.Ub(),M.Jc(44,He,63,14,"div",21),M.Ub(),M.Ub(),M.Jc(45,_e,27,5,"ng-template",null,22,M.Kc),M.Jc(47,qe,49,16,"ng-template",null,23,M.Kc),M.Jc(49,et,24,6,"ng-template",null,24,M.Kc),M.Ub()),2&e&&(M.Cb(9),M.pc("dataSource",t.modelNameData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.modelNameID),M.Cb(2),M.pc("ngIf",t.modelNameSelect&&t.modelNoSelect&&t.modelArtSelect&&t.modelProcessSelect),M.Cb(6),M.pc("dataSource",t.modelNoData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.modelNoID),M.Cb(8),M.pc("dataSource",t.articleNosData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.articleNoID),M.Cb(8),M.pc("ngForOf",t.artProcessData),M.Cb(3),M.pc("ngIf",t.existGlue),M.Cb(5),M.Nc("",M.lc(42,18,"PREVIEW")," "),M.Cb(2),M.pc("ngIf",t.existGlue),M.Cb(1),M.pc("ngIf",t.existGlue))},directives:[r.c,l.f,l.i,s.n,s.m,u.b,u.h,C.j,h.d,v.d,v.b,C.e,C.b,h.c,v.c,v.a,C.d,C.a,u.k,l.a,s.l],pipes:[p.c,s.e],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{animation:warning-frames .5s infinite;color:#000}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),e})();const it=["switch"],nt=["grid"],st=["gridglue"],lt=["grid2"],at=["modelNameDropdownlist"],ot=["modelNoDropdownlist"],rt=["chemicalDropdownlist"],ct=["positionDropdownlist"];function dt(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"GLUE")," ")}function ht(e,t){if(1&e&&(M.Vb(0,"div",31),M.Lc(1),M.Ub()),2&e){const e=t.$implicit;M.qc("title",e.name),M.Cb(1),M.Nc(" ",e.name," ")}}function ut(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"CONSUMPTION")," ")}function gt(e,t){if(1&e&&(M.Vb(0,"span"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changeConsumptionColor(e)),M.Cb(1),M.Mc(""===e.consumption?"0":e.consumption)}}function mt(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"EXPIRED_TIME")," ")}function bt(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"KIND")," ")}function pt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",32,33),M.fc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangeKindEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.kinds)("ngModel",e.kindName)("fields",i.fieldsKindEdit)("allowFiltering",!0)}}function ft(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"PART")," ")}function Dt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",34,33),M.fc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangePartEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.parts)("ngModel",e.partName)("fields",i.fieldsPartEdit)("allowFiltering",!0)}}function It(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"MATERIAL")," ")}function Ct(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",34,33),M.fc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangeMaterialEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.materials)("ngModel",e.materialName)("fields",i.fieldsMaterialEdit)("allowFiltering",!0)}}function Nt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",19),M.Vb(1,"ejs-grid",20,21),M.fc("rowDeselected",function(t){return M.Ec(e),M.jc().rowDeselected(t)})("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginGlue(t)})("rowSelected",function(t){return M.Ec(e),M.jc().rowSelected(t)})("created",function(){return M.Ec(e),M.jc().onCreatedGridGlue()})("toolbarClick",function(t){return M.Ec(e),M.jc().toolbarClick(t)})("dataBound",function(){return M.Ec(e),M.jc().dataBoundGlue()}),M.Vb(3,"e-columns"),M.Vb(4,"e-column",22),M.Jc(5,dt,2,3,"ng-template",null,23,M.Kc),M.Jc(7,ht,2,2,"ng-template",null,24,M.Kc),M.Ub(),M.Vb(9,"e-column",25),M.Jc(10,ut,2,3,"ng-template",null,23,M.Kc),M.Jc(12,gt,2,3,"ng-template",null,24,M.Kc),M.Ub(),M.Vb(14,"e-column",26),M.Jc(15,mt,2,3,"ng-template",null,23,M.Kc),M.Ub(),M.Vb(17,"e-column",27),M.Jc(18,bt,2,3,"ng-template",null,23,M.Kc),M.Jc(20,pt,2,4,"ng-template",null,28,M.Kc),M.Ub(),M.Vb(22,"e-column",29),M.Jc(23,ft,2,3,"ng-template",null,23,M.Kc),M.Jc(25,Dt,2,4,"ng-template",null,28,M.Kc),M.Ub(),M.Vb(27,"e-column",30),M.Jc(28,It,2,3,"ng-template",null,23,M.Kc),M.Jc(30,Ct,2,4,"ng-template",null,28,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(1),M.pc("dataSource",e.glues)("editSettings",e.editSettings)("toolbar",e.toolbar)("allowSorting",!0)("selectedRowIndex",e.rowIndex)}}function St(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-switch",42,43),M.fc("click",function(){return M.Ec(e),M.jc(2).done()})("ngModelChange",function(t){return M.Ec(e),M.jc(2).createdStatus=t}),M.kc(2,"translate"),M.kc(3,"translate"),M.Ub()}if(2&e){const e=M.jc(2);M.qc("onLabel",M.lc(2,5,"DONE")),M.qc("offLabel",M.lc(3,7,"UNDONE")),M.pc("disabled",e.approvalStatus)("ngModel",e.createdStatus)("checked",e.createdStatus)}}function vt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-switch",45),M.fc("click",function(){return M.Ec(e),M.jc(3).approval()})("ngModelChange",function(t){return M.Ec(e),M.jc(3).approvalStatus=t}),M.kc(1,"translate"),M.Ub()}if(2&e){const e=M.jc(3);M.qc("offLabel",M.lc(1,3,"NOT_APPROVED")),M.pc("ngModel",e.approvalStatus)("checked",e.approvalStatus)}}function yt(e,t){if(1&e&&(M.Tb(0),M.Jc(1,vt,2,5,"ejs-switch",44),M.Sb()),2&e){const e=M.jc(2);M.Cb(1),M.pc("ngIf",e.modelNameID>0)}}function wt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",46),M.fc("click",function(){return M.Ec(e),M.jc(2).finished()}),M.Qb(1,"i",47),M.Lc(2),M.kc(3,"translate"),M.Ub()}2&e&&(M.Cb(2),M.Nc(" ",M.lc(3,1,"FINISHED")," "))}function Pt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",48),M.fc("click",function(){M.Ec(e);const t=M.jc(2),i=M.Bc(45);return t.openModalHistory(i)}),M.Qb(1,"i",49),M.Lc(2," History"),M.Ub()}}function Bt(e,t){if(1&e&&(M.Vb(0,"div",35),M.Vb(1,"button",36),M.Qb(2,"i",37),M.Lc(3," Reset "),M.Ub(),M.Jc(4,St,4,9,"ejs-switch",38),M.Jc(5,yt,2,1,"ng-container",39),M.Jc(6,wt,4,3,"button",40),M.Jc(7,Pt,3,0,"button",41),M.Ub()),2&e){const e=M.jc();M.Cb(4),M.pc("ngIf",e.modelNameID>0),M.Cb(1),M.pc("ngIf",3!==e.level&&4!==e.level),M.Cb(1),M.pc("ngIf",e.modelNameID>0),M.Cb(1),M.pc("ngIf",e.modelNameID>0)}}function At(e,t){if(1&e&&(M.Vb(0,"li",66),M.Vb(1,"a"),M.Lc(2),M.Vb(3,"span",67),M.Lc(4),M.Ub(),M.Ub(),M.Ub()),2&e){const e=t.$implicit;M.Cb(2),M.Oc(" ",e.position,". ",e.ingredientName," "),M.Cb(2),M.Nc("(",e.percentage,"%)")}}function xt(e,t){if(1&e&&(M.Vb(0,"ul"),M.Vb(1,"span",63),M.Lc(2),M.Ub(),M.Vb(3,"li",64),M.Lc(4),M.Vb(5,"ul"),M.Jc(6,At,5,3,"li",65),M.Ub(),M.Ub(),M.Ub()),2&e){const e=M.jc(2);M.Cb(2),M.Mc(e.formulaTamp()),M.Cb(2),M.Nc(" ",e.formula()," "),M.Cb(2),M.pc("ngForOf",e.renderchemical())}}function Ut(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",68),M.fc("click",function(){M.Ec(e);const i=t.$implicit;return M.jc(2).sortBySup(i.id)}),M.Qb(1,"i",69),M.Lc(2),M.Ub()}if(2&e){const e=t.$implicit;M.Cb(2),M.Nc(" ",e.name," ")}}function Et(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"ITEM")," ")}function kt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",70,71),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(2).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Vt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",70,71),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(2).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Ft(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"INGREDIENT_NAME")," ")}function Mt(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function Lt(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function $t(e,t){if(1&e&&(M.Vb(0,"div"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changePercentageColor(e)),M.Cb(1),M.Mc(e.percentage)}}function Gt(e,t){1&e&&(M.Vb(0,"div"),M.Qb(1,"i",72),M.Ub())}function Tt(e,t){if(1&e&&(M.Vb(0,"div"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changeAllowColor(e)),M.Cb(1),M.Nc("\xb1 ",e.allow,"")}}function Ot(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"ITEM")," ")}function jt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",70,71),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(2).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Jt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",70,71),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(2).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Rt(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"INGREDIENT_NAME")," ")}function Kt(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function Qt(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function Ht(e,t){1&e&&(M.Vb(0,"div"),M.Qb(1,"i",72),M.Ub())}function _t(e,t){if(1&e&&(M.Vb(0,"div"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changeAllowColor(e)),M.Cb(1),M.Nc("\xb1 ",e.allow,"")}}function Wt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",50),M.Jc(1,xt,7,3,"ul",39),M.Vb(2,"div",0),M.Vb(3,"div",51),M.Vb(4,"button",52),M.fc("click",function(){return M.Ec(e),M.jc().sortBySup(0)}),M.Lc(5),M.kc(6,"translate"),M.Ub(),M.Jc(7,Ut,3,1,"button",53),M.Ub(),M.Ub(),M.Vb(8,"div",0),M.Vb(9,"div",54),M.Vb(10,"div",9),M.Vb(11,"div",19),M.Vb(12,"ejs-grid",55,56),M.fc("actionComplete",function(t){return M.Ec(e),M.jc().actionCompleteIngredient(t)})("recordDoubleClick",function(t){return M.Ec(e),M.jc().onDoubleClickIngredient(t)})("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginIngredient(t)})("toolbarClick",function(t){return M.Ec(e),M.jc().toolbarClickIngredient(t)})("rowSelected",function(t){return M.Ec(e),M.jc().rowSelectedIngredient(t)}),M.Vb(14,"e-columns"),M.Vb(15,"e-column",57),M.Jc(16,Et,2,3,"ng-template",null,23,M.Kc),M.Jc(18,kt,2,4,"ng-template",null,24,M.Kc),M.Jc(20,Vt,2,4,"ng-template",null,28,M.Kc),M.Ub(),M.Vb(22,"e-column",58),M.Jc(23,Ft,2,3,"ng-template",null,23,M.Kc),M.Jc(25,Mt,1,1,"ng-template",null,28,M.Kc),M.Jc(27,Lt,1,1,"ng-template",null,24,M.Kc),M.Ub(),M.Vb(29,"e-column",59),M.Jc(30,$t,2,3,"ng-template",null,24,M.Kc),M.Ub(),M.Vb(32,"e-column",60),M.Jc(33,Gt,2,0,"ng-template",null,23,M.Kc),M.Jc(35,Tt,2,3,"ng-template",null,24,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(37,"div",54),M.Vb(38,"div",9),M.Vb(39,"div",19),M.Vb(40,"ejs-grid",61,62),M.fc("actionComplete",function(t){return M.Ec(e),M.jc().actionCompleteIngredient(t)})("recordDoubleClick",function(t){return M.Ec(e),M.jc().onDoubleClickIngredient(t)})("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginIngredient(t)})("toolbarClick",function(t){return M.Ec(e),M.jc().toolbarClickIngredient(t)})("rowSelected",function(t){return M.Ec(e),M.jc().rowSelectedIngredient(t)}),M.Vb(42,"e-columns"),M.Vb(43,"e-column",57),M.Jc(44,Ot,2,3,"ng-template",null,23,M.Kc),M.Jc(46,jt,2,4,"ng-template",null,24,M.Kc),M.Jc(48,Jt,2,4,"ng-template",null,28,M.Kc),M.Ub(),M.Vb(50,"e-column",58),M.Jc(51,Rt,2,3,"ng-template",null,23,M.Kc),M.Jc(53,Kt,1,1,"ng-template",null,28,M.Kc),M.Jc(55,Qt,1,1,"ng-template",null,24,M.Kc),M.Ub(),M.Qb(57,"e-column",59),M.Vb(58,"e-column",60),M.Jc(59,Ht,2,0,"ng-template",null,23,M.Kc),M.Jc(61,_t,2,3,"ng-template",null,24,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(1),M.pc("ngIf",e.renderchemical().length>0),M.Cb(4),M.Nc(" ",M.lc(6,12,"DEFAULT")," "),M.Cb(2),M.pc("ngForOf",e.supplier),M.Cb(5),M.pc("dataSource",e.ingredients1)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions2),M.Cb(28),M.pc("dataSource",e.ingredients2)("allowSorting",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions2)}}function qt(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",73),M.Vb(1,"h4",74),M.Qb(2,"i",75),M.Lc(3," Clone Article "),M.Ub(),M.Vb(4,"button",76),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",77),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",78),M.Vb(8,"div",0),M.Vb(9,"div",79),M.Vb(10,"div",80),M.Vb(11,"label",81),M.Lc(12,"Article Name"),M.Ub(),M.Vb(13,"span",82),M.Lc(14,"(*)"),M.Ub(),M.Vb(15,"input",83),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc().articleName=t}),M.Ub(),M.Ub(),M.Ub(),M.Vb(16,"div",79),M.Vb(17,"div",80),M.Vb(18,"label",81),M.Lc(19,"Process"),M.Ub(),M.Vb(20,"ejs-dropdownlist",84,85),M.fc("change",function(t){return M.Ec(e),M.jc().onChangeProcessCloneModal(t)}),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(22,"div",86),M.Vb(23,"button",87),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(24,"Close"),M.Ub(),M.Vb(25,"button",88),M.fc("click",function(){return M.Ec(e),M.jc().cloneArticleModelname()}),M.Lc(26,"Clone"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(15),M.pc("ngModel",e.articleName),M.Cb(5),M.pc("value",e.valueProcess)("dataSource",e.processData)("allowFiltering",!0)("fields",e.processfields)}}function zt(e,t){1&e&&(M.Lc(0),M.kc(1,"date")),2&e&&M.Nc(" ",M.mc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function Xt(e,t){if(1&e&&(M.Tb(0),M.Qb(1,"input",101),M.Sb()),2&e){const e=M.jc().$implicit;M.Cb(1),M.pc("value",e.remark)}}function Yt(e,t){if(1&e&&M.Qb(0,"input",102),2&e){const e=M.jc().$implicit;M.pc("value",e.remark)}}function Zt(e,t){if(1&e&&(M.Vb(0,"span",98),M.Jc(1,Xt,2,1,"ng-container",99),M.Jc(2,Yt,1,1,"ng-template",null,100,M.Kc),M.Ub()),2&e){const e=t.$implicit,i=M.Bc(3);M.pc("ngClass","Improve"==e.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),M.Cb(1),M.pc("ngIf","Improve"==e.action)("ngIfElse",i)}}function ei(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",73),M.Vb(1,"h4",74),M.Qb(2,"i",75),M.Lc(3," BPFC History "),M.Ub(),M.Vb(4,"button",76),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",77),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",78),M.Vb(8,"ejs-grid",89,90),M.fc("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginHistory(t)}),M.Vb(10,"e-columns"),M.Vb(11,"e-column",91),M.Jc(12,zt,2,4,"ng-template",null,24,M.Kc),M.Ub(),M.Qb(14,"e-column",92),M.Qb(15,"e-column",93),M.Qb(16,"e-column",94),M.Vb(17,"e-column",95),M.Jc(18,Zt,4,3,"ng-template",null,28,M.Kc),M.Ub(),M.Qb(20,"e-column",96),M.Ub(),M.Ub(),M.Ub(),M.Vb(21,"div",86),M.Vb(22,"button",97),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(23,"Close"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(8),M.pc("dataSource",e.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettingsHis)("toolbar",e.toolbarOptionsHistory),M.Cb(9),M.pc("edit",e.editparamsHis)}}function ti(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",73),M.Vb(1,"h4",74),M.Qb(2,"i",75),M.Lc(3," Clone BPFC "),M.Ub(),M.Vb(4,"button",76),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",77),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",78),M.Vb(8,"div",0),M.Vb(9,"div",79),M.Vb(10,"div",80),M.Vb(11,"label",81),M.Lc(12,"Model Name"),M.Ub(),M.Vb(13,"span",82),M.Lc(14,"(*)"),M.Ub(),M.Qb(15,"input",6),M.Ub(),M.Ub(),M.Vb(16,"div",79),M.Vb(17,"div",80),M.Vb(18,"label",81),M.Lc(19,"Model NO"),M.Ub(),M.Vb(20,"span",82),M.Lc(21,"(*)"),M.Ub(),M.Qb(22,"input",6),M.Ub(),M.Ub(),M.Vb(23,"div",79),M.Vb(24,"div",80),M.Vb(25,"label",81),M.Lc(26,"Article NO"),M.Ub(),M.Vb(27,"span",82),M.Lc(28,"(*)"),M.Ub(),M.Vb(29,"input",103),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc().articleNoNewLeo=t}),M.Ub(),M.Ub(),M.Ub(),M.Vb(30,"div",79),M.Vb(31,"div",80),M.Vb(32,"label",81),M.Lc(33,"Process"),M.Ub(),M.Vb(34,"span",82),M.Lc(35,"(*)"),M.Ub(),M.Qb(36,"input",6),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(37,"div",86),M.Vb(38,"button",87),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(39,"Close"),M.Ub(),M.Vb(40,"button",88),M.fc("click",function(){return M.Ec(e),M.jc().onClickClone()}),M.Lc(41,"Clone"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(15),M.pc("value",e.modelNameLeo),M.Cb(7),M.pc("value",e.modelNoLeo),M.Cb(7),M.pc("ngModel",e.articleNoNewLeo)("value",e.articleNoLeo),M.Cb(7),M.pc("value",e.artProcessLeo)}}let ii=(()=>{class e{constructor(e,t,i,n,s,l,a,o,r,c,d,h,u,g,m,b,p){this.glueIngredientService=e,this.modalNameService=t,this.glueService=i,this.alertify=n,this.modalService=s,this.route=l,this.authService=a,this.bPFCEstablishService=o,this.modelNoService=r,this.articleNoService=c,this.kindService=d,this.partService=h,this.materialService=u,this.buildingUserService=g,this.artProcessService=m,this.ingredientService=b,this.dataService=p,this.positions=["B","C","D","E"],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={id:0,name:"",gluename:"",code:"",createdDate:"",partID:0,kindID:0,materialID:0,BPFCEstablishID:0,consumption:"",expiredTime:0,createdBy:0,glueNameID:0,glueIngredients:[]},this.ingredient={id:0,name:"",code:"",percentage:0,createdDate:new Date,supplierID:0,position:0,allow:0,voc:0,expiredTime:0,daysToExpiration:0,materialNO:"",unit:0,real:0,cbd:0},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search","Add","Delete","Cancel"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.modelNameLeo=null,this.modelNoLeo=null,this.articleNoLeo=null,this.articleNoNewLeo=null,this.artProcessLeo=null,this.modelNameIDLeo=0,this.modelNoIDLeo=0,this.articleNoIDLeo=0,this.artProcessIDLeo=0,this.BPFCIDLeo=0,this.textSearch=null,this.onFiltering=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelName=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringModelNameClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringArtProcessClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.artProcessDataClone,t)},this.dataSearch=this.dataService.currentMessage.subscribe(e=>{this.textSearch=e})}ngOnInit(){this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.GetDetailBPFC(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(e=>{200===e&&this.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}ngOnDestroy(){this.dataService.changeMessages(this.textSearch),this.dataSearch.unsubscribe()}GetDetailBPFC(){this.BPFCID=this.route.snapshot.params.id,this.bPFCEstablishService.getDetailBPFC(this.BPFCID).subscribe(e=>{var t;const i=e[0];this.BPFCIDLeo=i.id,this.modelNameLeo=i.modelName,this.modelNoLeo=i.modelNo,this.articleNoLeo=i.articleNo,this.artProcessLeo=i.artProcess,this.articleNoNewLeo=i.articleNo,this.modelNameID=i.modelNameID,this.modelNoID=i.modelNoID,this.articleNoID=i.articleNoID,this.artProcessIDLeo="ASY"===i.artProcess?1:2,this.modelNameDetail=e[0].modelName,this.modelNameID=e[0].modelNameID,this.modelNoDetail=e[0].modelNo,this.articleNoDetail=e[0].articleNo,this.artProcessDetail=e[0].artProcess,this.modelNameIDClone=e[0].modelNameID,this.value=e[0].modelNameID,this.valuemodelNo=e[0].modelNoID,this.articleNoID=e[0].articleNoID,this.resetLifeCycleBPFC(),this.BPFCID=null===(t=e[0])||void 0===t?void 0:t.id,this.approvalStatus=e[0].approvalStatus,this.createdStatus=e[0].finishedStatus,localStorage.removeItem("details"),this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}onChangeProcessCloneModal(e){e.itemData&&(this.processID=e.itemData.id)}resetLifeCycleBPFC(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}onCreatedGridGlue(){}ngAfterViewInit(){$('[data-toggle="tooltip"]').tooltip();const e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}onChangeKindEdit(e){this.kindEdit=e.value,this.kindID=e.itemData.id}onChangePartEdit(e){this.partEdit=e.value,this.partID=e.itemData.id}onChangeMaterialEdit(e){this.kindEdit=e.value,this.materialID=e.itemData.id}dataBoundGlue(){this.gridglue.selectRows(this.selectedRow.length?this.selectedRow:this.selIndex)}actionBeginGlue(e){"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":`Consumption ${e.rowData.consumption}`,this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=`Consumption ${e.data.consumption}`,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{this.glueService.delete(e.data[0].id).subscribe(()=>{this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.removeLocalStore("details"),this.glueIngredientDetail=[],this.oldDetail=[],this.alertify.success("Glue has been deleted")},e=>{this.alertify.error("Failed to delete the Glue")})}))}rowDeselected(e){const t=e.rowIndex,i=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,i)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(e=>{if(this.modified=!0,this.gridglue.getSelectedRowIndexes().length){const e=this.gridglue.dataSource[t];e.name=e.chemical.name,this.gridglue.refresh()}}).catch(e=>{this.gridglue.selectRows([t])})}rowSelected(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);const t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}onChangePosition(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;const n=e.value;let s=this.getLocalStore("details");if(""===e.value);else{if(0!==s.length){let t="";switch(s[s.length-1].position){case"A":t="B";break;case"B":t="C";break;case"C":t="D";break;case"D":t="E"}if(n!==t)return this.alertify.warning(`H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 ${t}`,!0),this.grid.refresh(),this.grid2.refresh(),void(e.cancel=!0)}if(0===s.filter(t=>t.position===e.value).length&&null!==e.value)if(s=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==s.filter(e=>e.ingredientName===t.name&&e.position===t.position).length){const i=s.findIndex(e=>e.ingredientName===t.name);s[i].position=e.value,this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.refresh()}else{s=this.getLocalStore("details");const i={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(i.percentage=100,i.expiredTime=t.expiredTime),s.push(i),this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.refresh()}}}recordDoubleClick(e){this.modifiedGlue=!0}toolbarClickIngredient(e){switch(e.item.text){case"Add":e.cancel=!0,this.openIngredientModalComponent()}}onDoubleClickIngredient(e){this.setFocus=e.column}rowSelectedIngredient(e){this.ingridientID=e.data.id}genaratorGlueCode(){this.glue.code=this.makeid(8)}makeid(e){let t="";const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length;for(let s=0;s<e;s++)t+=i.charAt(Math.floor(Math.random()*n));return t}compareArray(e,t){return JSON.stringify(e)===JSON.stringify(t)}setLocalStore(e,t){localStorage.removeItem(e);const i=JSON.stringify(t);localStorage.setItem(e,i)}getLocalStore(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}removeLocalStore(e){localStorage.removeItem(e)}dynamicSort(e){let t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),(i,n)=>-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}checkColorCode(e){return!0===e.approvalStatus&&!0===e.finishedStatus}checkDone(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}checkStatus(e,t){return!0===e&&!0===t?"Done":"Undone"}renderchemical(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}makeFormula(){var e,t;const i=this.getLocalStore("details").filter(e=>"A"===e.position)||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);const n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}formula(){return this.B&&this.C&&this.D&&this.E?`{[ (${this.nameGlue}+ ${this.B}) + ${this.C} ] + ${this.D}}+ ${this.E}`:this.B&&this.C&&this.D?`[(${this.nameGlue} + ${this.B}) + ${this.C}] + ${this.D}`:this.B&&this.C?`(${this.nameGlue} + ${this.B}) + ${this.C}`:this.B?`${this.nameGlue} + ${this.B}`:`${this.nameGlue}`}formulaTamp(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName=`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`,`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`):this.BB&&this.CC&&this.DD?(this.glueNewName=`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`,`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`):this.BB&&this.CC?(this.glueNewName=`(${this.nameGlues} + ${this.BB}) + ${this.CC}`,`(${this.nameGlues} + ${this.BB}) + ${this.CC}`):this.BB?(this.glueNewName=`${this.nameGlues} + ${this.BB}`,`${this.nameGlues} + ${this.BB}`):`${this.nameGlues}`}getDetail(e){this.glueIngredientService.getDetail(e).subscribe(e=>{var t,i,n,s;this.glueIngredientDetail=e.glueIngredients,this.setLocalStore("details",this.glueIngredientDetail),this.setLocalStore("detailsTamp",this.glueIngredientDetail),this.glueIngredientDetail=this.renderchemical(),this.oldDetail=this.renderchemical();const l=this.glueIngredientDetail.filter(e=>"A"===e.position)||[];this.nameGlue=(null===(t=l[0])||void 0===t?void 0:t.ingredientName)||"",this.nameGlues=(null===(i=l[0])||void 0===i?void 0:i.ingredientName)+"^"+(null===(n=this.glueIngredientDetail[0])||void 0===n?void 0:n.allow)+"%"||!1,this.A=(null===(s=l[0])||void 0===s?void 0:s.ingredientName)||"",void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCount.join("+"),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0)})}updateChemicalList(){const e=this.getLocalStore("details");for(const t of e){const e=this.ingredients1.findIndex(e=>e.name===t.ingredientName&&e.id===t.ingredientID);-1!==e&&(this.ingredients1[e].position=t.position,this.ingredients1[e].percentage=t.percentage,this.ingredients1[e].allow=t.allow)}for(const t of e){const e=this.ingredients2.findIndex(e=>e.name===t.ingredientName&&e.id===t.ingredientID);-1!==e&&(this.ingredients2[e].position=t.position,this.ingredients2[e].percentage=t.percentage,this.ingredients2[e].allow=t.allow)}}actionBeginIngredient(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;const t=Number(this.percentageDefault)!==Number(this.percentageChange),i=Number(this.allowDefault)!==Number(this.allowChange);if(t){this.modified=!1;const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);t[i].percentage=e.data.percentage,this.setLocalStore("details",t),this.updateChemicals()}if(i){const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);t[i].allow=e.data.allow,this.setLocalStore("details",t),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicals()}}"delete"===e.requestType&&this.deleteIngredient()}updateGlueIngredient(){}loadPreview(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}resolver(){this.route.data.subscribe(e=>{this.glues=e.glues.result,this.paginationG=e.glues.pagination})}onService(){this.ingredientService.currentIngredient.subscribe(e=>{300===e&&(this.getIngredients(),this.updateChemicalList(),this.ingredientService.changeIngredient(0))})}mapGlue(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}getIngredients(){this.glueIngredientService.getIngredients(this.glueid).subscribe(e=>{this.ingredients1=e.result.list1,this.ingredients2=e.result.list2},e=>{this.alertify.error(e)})}getGlues(){this.glueService.getAllGlue().subscribe(e=>{this.glues=e},e=>{this.alertify.error(e)})}mapGlueIngredients(e){this.glueIngredientService.mapGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid))})}mapGlueIngredient(e){this.glueIngredientService.mappGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.getAllGluesByBPFCID(this.BPFCID),this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid),this.getAllGluesByBPFCID(this.BPFCID))})}openIngredientModalComponent(){const e=this.modalService.open(X.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(e=>{},e=>{})}actionCompleteIngredient(e){"beginEdit"===e.requestType&&"Item"!==this.setFocus.field&&(e.form.elements.namedItem(this.setFocus.field).focus(),e.form.elements.namedItem(this.setFocus.field).value="")}openPopupDropdownlist(){$('[data-toggle="tooltip"]').tooltip()}toolbarClick(e){switch(e.item.text){case"Add New":const t=this.getLocalStore("details").sort(this.dynamicSort("position"));if(!1===this.compareArray(this.oldDetail,t)&&t.length>0&&this.oldDetail.length>0)this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(e=>{const t={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=t,this.saveGlue()}).catch(t=>{e.cancel=!0});else{const e={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=e,this.saveGlue()}}}openModal(e){this.modalReference=this.modalService.open(e)}openModalHistory(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}LoadHistoryBPFC(){this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(e=>{this.historyData=e.map(e=>({id:e.id,glueID:e.glueID,createdTime:e.createdTime,bpfcEstablishID:e.bpfcEstablishID,before:e.before,after:e.after,action:e.action,remark:e.remark,userID:e.userID,createdBy:this.createdBy(e.userID)}))})}actionBeginHistory(e){"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(e=>{e&&this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}getAllUsers(){this.buildingUserService.getAllUsers(1,1e3).subscribe(e=>{this.userData=e.result})}createdBy(e){if(0===e)return"#N/A";const t=this.userData.filter(t=>t.ID===e)[0];return void 0!==t?t.Username:"#N/A"}cloneModelname(){this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",()=>{this.modalNameService.cloneModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.valueProcess).subscribe(e=>{this.alertify.success("the model name has been cloned"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}cloneArticleModelname(){this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",()=>{this.modalNameService.cloneArticleModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.articleName,this.processID).subscribe(e=>{this.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}delete(e,t){this.glueIngredientService.delete(e,t).subscribe(t=>{this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),this.getIngredients(),this.getDetail(e)})}deleteGlue(e){this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.glueService.delete(e.id).subscribe(()=>{this.getGlues(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}deleteIngridient(e){this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.ingredientService.delete(e.id).subscribe(()=>{this.getIngredients(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}getAllGluesByBPFCID(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{this.glues=e})}getAllGluesByBPFCID2(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{void 0===this.ingredientID?(this.glues=e,e.length>0&&(this.detailGlue=!0)):(this.glueid=e[0].id,this.glueIngredient2.ingredientID=this.ingredientID,this.glueIngredient2.percentage=100,this.glueIngredient2.glueID=this.glueid,this.glueIngredient2.position="A",this.mapGlueIngredient(this.glueIngredient2))})}updateChemicals(){this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2;const t=this.getLocalStore("details");for(const i of t){const e=this.ingredients1.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients1[e].position=i.position,this.ingredients1[e].percentage=i.percentage,this.ingredients1[e].allow=i.allow)}for(const i of t){const e=this.ingredients2.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients2[e].position=i.position,this.ingredients2[e].percentage=i.percentage,this.ingredients2[e].allow=i.allow)}this.glueIngredientDetail=t,this.makeFormula()})}sortBySup(e){0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(t=>{if(this.ingredients1=t.list1,this.ingredients2=t.list2,0===e){const e=this.getLocalStore("details");this.ingredients1=e.map(e=>({id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,cbd:e.cbd})),this.glueIngredientDetail=e}else this.updateChemicalList()}))}saveGlue(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}getBuilding(){JSON.parse(localStorage.getItem("user"))}getAllIngredient(){this.ingredientService.getAllIngredient().subscribe(e=>{this.ingrediented=e})}createGlue(){this.glueService.create(this.glue).subscribe(()=>{this.alertify.success("\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.clearGlueForm(),this.genaratorGlueCode(),this.expiredTime=0},e=>{this.alertify.error(e),this.genaratorGlueCode()})}finished(){const e=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=e,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{});const t=this.getLocalStore("details"),i=this.gridglue.getSelectedRecords()[0];i.expiredTime=t.filter(e=>"A"===e.position)[0].expiredTime,i.kindID=0===i.kindID?null:i.kindID,i.partID=0===i.partID?null:i.partID,i.materialID=0===i.materialID?null:i.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),this.glueService.update(i).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!0,this.modified=!0}),t.length>0&&(this.mapGlueIngredients(t),this.modified=!0)}}clearGlueForm(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}update(){this.glueService.update(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.history.Action="Created",this.expiredTime=0})}updateChemical(){this.glueService.updateChemical(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.onChangeChemical=!1,this.history.Action="Created"})}deleteIngredient(){this.ingredientService.delete(this.ingridientID).subscribe(()=>{const e=this.getLocalStore("details").filter(e=>e.ingredientID!==this.ingridientID);this.setLocalStore("details",e),this.glueIngredientDetail=e,this.getIngredients(),this.makeFormula(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}approval(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const l of e){if(l.glueIngredients.length>0){const e=l.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0&&"A"!==n.position)return t=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The allowance of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);if(n.percentage<=0&&"A"!==n.position)return i=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);t=!0,i=!0}}if(+l.consumption<=0)return n=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The consumption of glue name ${l.name} must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${l.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${l.name} <br>\n          `,!0);n=!0}const s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(e=>{this.alertify.success("The BPFC has been approved!"),this.createdStatus=this.approvalStatus;const t=this.modelNameDropdownlist.getDataByValue(this.modelNameDropdownlist.value);this.modelNameDropdownlist.valueTemplate=`(${this.checkStatus(this.approvalStatus,this.createdStatus)}) ${t.name}`})}}done(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const s of e){if(s.glueIngredients.length>0){const e=s.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0)return t=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The allow of checmical name ${n.ingredient.name} is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);if(n.percentage<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);t=!0,i=!0}0===e.length&&(t=!0,i=!0)}if(+s.consumption<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The consumption of glue name ${s.name} is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${s.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${s.name} <br>\n          `,!0);n=!0}if(t&&i&&n){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,e).subscribe(e=>{!0===e.status?(this.alertify.success(e.message),this.createdStatus=this.createdStatus):this.alertify.success(e.message)})}}}getModelNames(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameData=e.map(e=>({id:e.id,name:e.name}))})}getArticleNoByModelNameID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNoData=e})}getModelNoByModelNameID(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNoData=e})}getArtProcessByArticleNoID(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessData=e.map(e=>({id:e.id,name:1===e.processID?"ASY":"STF"}))})}getAllProcess(){this.artProcessService.GetAllProcess().subscribe(e=>{this.artProcessDataClone2=e})}getAllKind(){this.kindService.getAllKind().subscribe(e=>{this.kinds=e})}getAllPart(){this.partService.getAllPart().subscribe(e=>{this.parts=e})}getAllMaterial(){this.materialService.getAllMaterial().subscribe(e=>{this.materials=e})}getIngredientsByGlueID(){this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2})}getAllSupllier(){this.ingredientService.getAllSupplier().subscribe(e=>{this.supplier=e})}getArticleNoByModelNoID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosData=e})}getBPFCID(e){this.bPFCEstablishService.getBPFCID(e).subscribe(e=>{this.resetLifeCycleBPFC(),this.BPFCID=null==e?void 0:e.id,this.approvalStatus=e.approvalStatus,this.createdStatus=e.finishedStatus,this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}OndataBound(e){}getModelNamesClone(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameDataClone=e.map(e=>({id:e.id,name:e.name})),this.getModelNoByModelNameIDClone(this.modelNameIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]})}getArticleNoByModelNameIDClone(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosDataClone=e})}getModelNoByModelNameIDClone(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}getArtProcessByArticleNoIDClone(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessDataClone=e.map(e=>({id:e.id,name:1===e.ProcessID?"ASY":"STF"}))})}onChangeModelName(e){this.resetLifeCycleBPFC(),this.modelNameID=e.value,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}onChangeModelNo(e){e.isInteracted&&(this.modelNoID=e.value,this.valuemodelNo=e.value,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}onChangeArticleNo(e){e.isInteracted&&(this.articleNoID=e.value,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}onClickProcess(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue))}ClickProcessData(e){}clearFormClone(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}onClickClone(){const e={modelNameID:this.modelNameIDLeo,modelNOID:this.modelNoIDLeo,articleNOID:this.articleNoIDLeo,artProcessID:Number(this.artProcessIDLeo),bpfcID:this.BPFCIDLeo,name:this.articleNoNewLeo,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}clone(e){this.articleNoNewLeo!==this.articleNoLeo?this.modalNameService.cloneBPFC(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalService.dismissAll(),this.getAllUsers()):this.alertify.error("The BPFC exists!")}):this.alertify.error("The BPFC exists!")}onChangeModelNameClone(e){this.value!==e.value&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}onChangeModelNoClone(e){this.modelNOIDClone=e.value,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}onChangeArticleNoClone(e){e.isInteracted&&(this.articleNOIDClone=e.value,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}onChangeProcessClone(e){e.isInteracted&&(this.artProcessIDClone=e.value)}changeAllowColor(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changePercentageColor(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changeConsumptionColor(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}return e.\u0275fac=function(t){return new(t||e)(M.Pb(J),M.Pb(U.a),M.Pb(R.a),M.Pb(E.a),M.Pb(c.b),M.Pb(B.a),M.Pb(Q.a),M.Pb(F.a),M.Pb(H),M.Pb(K),M.Pb(W.a),M.Pb(q.a),M.Pb(z.a),M.Pb(k.a),M.Pb(_),M.Pb(L.a),M.Pb(x.a))},e.\u0275cmp=M.Jb({type:e,selectors:[["app-bpfc-detail"]],viewQuery:function(e,t){if(1&e&&(M.Rc(it,1),M.Rc(nt,1),M.Rc(st,1),M.Rc(lt,1),M.Rc(at,1),M.Rc(ot,1),M.Rc(rt,1),M.Rc(ct,1)),2&e){let e;M.Ac(e=M.gc())&&(t.switch=e.first),M.Ac(e=M.gc())&&(t.grid=e.first),M.Ac(e=M.gc())&&(t.gridglue=e.first),M.Ac(e=M.gc())&&(t.grid2=e.first),M.Ac(e=M.gc())&&(t.modelNameDropdownlist=e.first),M.Ac(e=M.gc())&&(t.modelNoDropdownlist=e.first),M.Ac(e=M.gc())&&(t.chemicalDropdownlist=e.first),M.Ac(e=M.gc())&&(t.positionDropdownlist=e)}},features:[M.Bb([C.n,C.f,C.k])],decls:48,vars:10,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["type","text","name","","disabled","","title","",1,"form-control",3,"value"],[1,"col-md-1","mt-2"],["type","button",1,"btn","btn-danger","rounded-pill"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],[1,"card-title"],["class","card-tools",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["HistoryModal",""],["cloneModal",""],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],[1,"card-tools"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],["style","width: 100px; margin-right: 10px;",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click",4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click",4,"ngIf"],[2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange"],["switch",""],["onLabel","Approved","style","width: 120px;",3,"offLabel","ngModel","checked","click","ngModelChange",4,"ngIf"],["onLabel","Approved",2,"width","120px",3,"offLabel","ngModel","checked","click","ngModelChange"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","bg-gradient-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],["height","675px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid2",""],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","","title","",1,"form-control",3,"ngModel","value","ngModelChange"]],template:function(e,t){1&e&&(M.Vb(0,"div",0),M.Vb(1,"div",1),M.Vb(2,"div",2),M.Vb(3,"div",3),M.Vb(4,"div",0),M.Vb(5,"div",4),M.Vb(6,"label"),M.Lc(7,"Model Name: "),M.Ub(),M.Ub(),M.Vb(8,"div",5),M.Qb(9,"input",6),M.Ub(),M.Ub(),M.Vb(10,"div",0),M.Vb(11,"div",4),M.Vb(12,"label"),M.Lc(13,"Model NO: "),M.Ub(),M.Ub(),M.Vb(14,"div",5),M.Qb(15,"input",6),M.Ub(),M.Ub(),M.Vb(16,"div",0),M.Vb(17,"div",4),M.Vb(18,"label"),M.Lc(19,"Article NO: "),M.Ub(),M.Ub(),M.Vb(20,"div",5),M.Qb(21,"input",6),M.Ub(),M.Qb(22,"div",7),M.Ub(),M.Vb(23,"div",0),M.Vb(24,"div",4),M.Vb(25,"label"),M.Lc(26,"Process: "),M.Ub(),M.Ub(),M.Vb(27,"div",5),M.Vb(28,"button",8),M.Lc(29),M.Ub(),M.Ub(),M.Qb(30,"div",7),M.Ub(),M.Ub(),M.Ub(),M.Vb(31,"div",2),M.Vb(32,"div",9),M.Jc(33,Nt,32,5,"div",10),M.Ub(),M.Ub(),M.Ub(),M.Vb(34,"div",11),M.Vb(35,"div",2),M.Vb(36,"div",12),M.Vb(37,"h3",13),M.Lc(38),M.kc(39,"translate"),M.Ub(),M.Jc(40,Bt,8,4,"div",14),M.Ub(),M.Jc(41,Wt,63,14,"div",15),M.Ub(),M.Ub(),M.Jc(42,qt,27,5,"ng-template",null,16,M.Kc),M.Jc(44,ei,24,6,"ng-template",null,17,M.Kc),M.Ub(),M.Jc(46,ti,42,5,"ng-template",null,18,M.Kc)),2&e&&(M.Cb(9),M.pc("value",t.modelNameDetail),M.Cb(6),M.pc("value",t.modelNoDetail),M.Cb(6),M.pc("value",t.articleNoDetail),M.Cb(8),M.Mc(t.artProcessDetail),M.Cb(4),M.pc("ngIf",t.existGlue),M.Cb(5),M.Nc("",M.lc(39,8,"PREVIEW")," "),M.Cb(2),M.pc("ngIf",t.existGlue),M.Cb(1),M.pc("ngIf",t.existGlue))},directives:[s.n,C.j,h.d,v.d,v.b,C.e,C.b,h.c,v.c,v.a,C.d,C.a,r.c,l.f,l.i,u.k,u.b,s.m,l.a,s.l],pipes:[p.c,s.e],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{animation:warning-frames .5s infinite;color:#000}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),e})();var ni=i("dQqK"),si=i("MAxt"),li=i("quSY"),ai=i("iStF"),oi=i("NkNT");const ri=["grid"],ci=["importModal"],di=["tooltip"];function hi(e,t){if(1&e&&M.Lc(0),2&e){const e=t.$implicit,i=M.jc();M.Mc(i.NO(e.index))}}function ui(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-tooltip",24,25),M.fc("beforeRender",function(i){M.Ec(e);const n=t.$implicit;return M.jc().onBeforeRender(i,n,n.index)}),M.Lc(2),M.Ub()}if(2&e){const e=t.$implicit;M.Cb(2),M.Nc(" ",e.modelName," ")}}function gi(e,t){if(1&e&&(M.Lc(0),M.kc(1,"date")),2&e){const e=t.$implicit;M.Nc(" ","ASY"===e.artProcess?"N/A":M.mc(1,1,e.dueDate,"d MMM, yyyy")," ")}}function mi(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div"),M.Vb(1,"ejs-datepicker",28),M.fc("change",function(t){return M.Ec(e),M.jc(2).onChangeDueDate(t)}),M.Ub(),M.Ub()}if(2&e){const e=M.jc().$implicit;M.Cb(1),M.pc("value",e.dueDate)}}function bi(e,t){if(1&e&&(M.Lc(0),M.kc(1,"date")),2&e){const e=M.jc().$implicit;M.Nc(" ","ASY"===e.artProcess?"N/A":M.mc(1,1,e.dueDate,"d MMM, yyyy")," ")}}function pi(e,t){if(1&e&&(M.Jc(0,mi,2,1,"div",26),M.Jc(1,bi,2,4,"ng-template",null,27,M.Kc)),2&e){const e=t.$implicit,i=M.Bc(2);M.pc("ngIf","STF"===e.artProcess)("ngIfElse",i)}}function fi(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",35),M.fc("click",function(){M.Ec(e);const t=M.jc().$implicit,i=M.jc(),n=M.Bc(34);return i.openModal(n,t)}),M.Qb(1,"i",36),M.Ub()}}function Di(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",37),M.fc("click",function(){M.Ec(e);const t=M.jc().$implicit,i=M.jc(),n=M.Bc(36);return i.openModalClone(n,t)}),M.Qb(1,"i",38),M.Ub()}}function Ii(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",29),M.fc("click",function(){M.Ec(e);const i=t.$implicit;return M.jc().detail(i)}),M.Qb(1,"i",30),M.Ub(),M.Jc(2,fi,2,0,"button",31),M.Jc(3,Di,2,0,"button",32),M.Vb(4,"button",33),M.fc("click",function(){M.Ec(e);const i=t.$implicit;return M.jc().delete(i.id)}),M.Qb(5,"i",34),M.Ub()}if(2&e){const e=t.$implicit;M.Cb(2),M.pc("ngIf",!0===e.finishedStatus),M.Cb(1),M.pc("ngIf",!1===e.finishedStatus)}}function Ci(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",39),M.Vb(1,"h4",40),M.Qb(2,"i",41),M.Lc(3," Import Excel "),M.Ub(),M.Vb(4,"button",42),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",43),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",44),M.Vb(8,"div",4),M.Vb(9,"div",45),M.Vb(10,"div",46),M.Vb(11,"label",47),M.Lc(12,"Select File (*Notice: Excel file must be followed a system template. If you do not have a template, please "),M.Vb(13,"a",48),M.Lc(14,"click here"),M.Ub(),M.Lc(15," to download. Thank you!)"),M.Ub(),M.Vb(16,"input",49),M.fc("change",function(t){return M.Ec(e),M.jc().fileProgress(t)}),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(17,"div",50),M.Vb(18,"button",51),M.fc("click",function(){return M.Ec(e),M.jc().uploadFile()}),M.Lc(19,"Upload File"),M.Ub(),M.Vb(20,"button",52),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(21,"Close"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(13),M.pc("href",e.excelDownloadUrl,M.Gc)}}function Ni(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",39),M.Vb(1,"h4",40),M.Qb(2,"i",41),M.Lc(3," New Version BPFC "),M.Ub(),M.Vb(4,"button",42),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",43),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",44),M.Vb(8,"div",4),M.Vb(9,"div",5),M.Vb(10,"div",46),M.Vb(11,"label",47),M.Lc(12,"Model Name"),M.Ub(),M.Qb(13,"input",53),M.Ub(),M.Ub(),M.Vb(14,"div",5),M.Vb(15,"div",46),M.Vb(16,"label",47),M.Lc(17,"Model NO"),M.Ub(),M.Qb(18,"input",53),M.Ub(),M.Ub(),M.Vb(19,"div",5),M.Vb(20,"div",46),M.Vb(21,"label",47),M.Lc(22,"Article NO"),M.Ub(),M.Vb(23,"span",54),M.Lc(24,"(*)"),M.Ub(),M.Vb(25,"div",55),M.Vb(26,"div",56),M.Vb(27,"span",57),M.Lc(28),M.Ub(),M.Ub(),M.Vb(29,"input",58),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc().value=t}),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(30,"div",5),M.Vb(31,"div",46),M.Vb(32,"label",47),M.Lc(33,"Process"),M.Ub(),M.Qb(34,"input",53),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(35,"div",50),M.Vb(36,"button",59),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(37,"Close"),M.Ub(),M.Vb(38,"button",60),M.fc("click",function(){return M.Ec(e),M.jc().onClickCloneNewVersion()}),M.Lc(39,"Copy"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(13),M.pc("value",e.modelName),M.Cb(5),M.pc("value",e.modelNo),M.Cb(10),M.Mc(e.articleNoDefault),M.Cb(1),M.pc("ngModel",e.value),M.Cb(5),M.pc("value",e.artProcess)}}function Si(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",39),M.Vb(1,"h4",40),M.Qb(2,"i",41),M.Lc(3," Clone BPFC "),M.Ub(),M.Vb(4,"button",42),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",43),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",44),M.Vb(8,"div",4),M.Vb(9,"div",5),M.Vb(10,"div",46),M.Vb(11,"ejs-dropdownlist",61,62),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc().changebpfcID=t})("filtering",function(t){return M.Ec(e),M.jc().onFilteringChangeBPFCModal(t)})("created",function(){return M.Ec(e),M.jc().created()})("select",function(t){return M.Ec(e),M.jc().onChangeBPFCModal(t)}),M.kc(13,"translate"),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(14,"div",50),M.Vb(15,"button",59),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(16,"Close"),M.Ub(),M.Vb(17,"button",60),M.fc("click",function(){return M.Ec(e),M.jc().onClickClone()}),M.Lc(18,"Copy"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(11),M.pc("dataSource",e.BPFCsForChangeModal)("ngModel",e.changebpfcID)("placeholder",M.lc(13,5,"Select a model"))("fields",e.fieldsBPFC)("allowFiltering",!0)}}new b.e({Accept:"application/json"});let vi=(()=>{class e extends ni.a{constructor(e,t,i,n,s,l,a,o,c,d,h,u){super(),this.modalNameService=e,this.alertify=t,this.userService=i,this.bPFCEstablishService=n,this.modalService=s,this.router=l,this.datePipe=a,this.spinner=o,this.articleNoService=c,this.dataService=d,this.http=h,this.route=u,this.pageSettings={pageCount:20,pageSizes:[50,100,150,200,"All"],pageSize:50},this.gridHeight=screen.height-100,this.users=[],this.modelName=null,this.modelNo=null,this.articleNo=null,this.articleNoNew=null,this.articleNoDefault=null,this.artProcess=null,this.value=null,this.modelNameID=0,this.modelNoID=0,this.articleNoID=0,this.artProcessID=0,this.BPFCID=0,this.baseUrl=V.a.apiUrlEC,this.textSearch=null,this.textSearchs=null,this.fieldsBPFCs={text:"name",value:"id"},this.sortSettings={columns:[{field:"articleNo",direction:"Ascending"}]},this.subscriptions=new li.a,this.checkCode=!1,this.styleBtn={background:"#6c757d",boxShadow:"0 0 0 3px rgba(130, 138, 145, 0.5)",border:"1px solid #6c757d",margin:"0",borderColor:"#6c757d",borderRadius:"4px",color:"#fff"},this.toolbar=["Search",{text:"Undone",tooltipText:"Undone",prefixIcon:"fa fa-remove",id:"Undone"},{text:"Done",tooltipText:"Done",prefixIcon:"fa fa-check",id:"Done"},{text:"All",tooltipText:"All",prefixIcon:"fa fa-list",id:"All"},{text:"% of done",tooltipText:"% of done",prefixIcon:"",id:"percentageOfDone"}],this.fieldsBPFC={text:"name",value:"name",tooltip:"name",itemCreated:e=>{Object(r.h)(e.item,this.queryString,!0,"Contains")}},this.onFilteringChangeBPFCModal=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.BPFCs,t)},this.onFilteringArticleNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNosData,t)},this.onFilteringModelNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNOsDataClone,t)},this.Permission(this.route)}ngOnInit(){this.getAllUsers(),this.tab=this.route.snapshot.params.tab||"undone",this.onRouteChange();const e=JSON.parse(localStorage.getItem("level"));this.role=e,this.excelDownloadUrl=`${V.a.apiUrlEC}ModelName/ExcelExport`,this.filterSettings={type:"Excel"},this.dataText=this.dataService.currentMessages.subscribe(e=>{this.textSearch=e,0!==e&&(this.searchOptions={fields:["modelName","modelNo","articleNo","approvedBy","artProcess"],operator:"contains",key:e||"",ignoreCase:!0})})}getAllBPFC(){this.bPFCEstablishService.filterByApprovedStatus().subscribe(e=>{if(this.bpfcDataSource=e.map(e=>({id:e.id,artProcess:e.artProcess,glues:e.glues,kinds:e.kinds,name:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),this.isSTF=JSON.parse(localStorage.getItem("isSTF")),this.isSTF){const t=e.filter(e=>"STF"===e.artProcess).map(e=>({id:e.id,artProcess:e.artProcess,glues:e.glues,kinds:e.kinds,name:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}));this.BPFCs=Object.assign([],t),this.BPFCsForChangeModal=Object.assign([],t)}else{const t=e.filter(e=>"STF"!==e.artProcess).map(e=>({id:e.id,artProcess:e.artProcess,glues:e.glues,kinds:e.kinds,name:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}));this.BPFCs=Object.assign([],t),this.BPFCsForChangeModal=Object.assign([],t)}})}created(){this.getAllBPFCForChangeModal()}getAllBPFCForChangeModal(){}onRouteChange(){this.route.data.subscribe(e=>{void 0!==this.route.snapshot.params.keySearch&&(this.keySearch=this.route.snapshot.params.keySearch,this.tab=this.route.snapshot.params.tab,this.loadData())})}ngOnDestroy(){this.dataText.unsubscribe()}Permission(e){const t=e.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(e=>e.functionCode===t)||[];for(const i of this.functions){const e=[];for(const n of i.childrens){const t=this.makeAction(n.code);e.push(...t.filter(Boolean))}e.push(...this.toolbar);const t=e.filter((e,t,i)=>t===i.indexOf(e));this.toolbarOptions=t}}makeAction(e){switch(e){case ai.a.EXCEL_EXPORT:return["ExcelExport"];case ai.a.EXCEL_IMPORT:return["Excel Import"];default:return[void 0]}}detail(e){return this.dataService.changeMessage(this.textSearch),this.router.navigate([`/ec/establish/bpfc-schedule/${this.tab}/detailv2/${e.id}`])}onChangeArticleNo(e){e.isInteracted&&(this.articleNoID=e.itemData.id)}onChangeDueDate(e){this.dueDate=e.value}createdSearch(e){this.loadData();const t=this.gridObj.element,i=document.createElement("span");i.className="e-clear-icon",i.id=t.id+"clear",i.onclick=this.cancelBtnClick.bind(this),t.querySelector(".e-toolbar-item .e-input-group").appendChild(i),this.percentageOfDone=new u.a({cssClass:"e-tbar-btn e-tbtn-txt e-control e-lib",iconCss:""}),this.percentageOfDone.appendTo("#percentageOfDone"),this.keySearch&&(this.gridObj.searchSettings.key=this.keySearch)}cancelBtnClick(e){this.gridObj.searchSettings.key="",this.gridObj.element.querySelector(".e-input-group.e-search .e-input").value=""}getSearchText(){}getArticleNoByModelNoID(e,t){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosData=e.filter(e=>e.name!==t)})}openPopupDropdownlist(){}onBeforeRender(e,t,i){const n=this.tooltip.filter((e,t)=>t===+i)[0];n.content="Loading...",n.dataBind(),this.bPFCEstablishService.getGlueByBPFCID(t.id).subscribe(e=>{n.content=e.join("<br>"),n.dataBind()})}onClickCloneNewVersion(){null!==this.value&&(this.articleNoNew=this.articleNoDefault+this.value);const e={modelNameID:this.modelNameID,modelNOID:this.modelNoID,articleNOID:this.articleNoID,artProcessID:Number(this.artProcessID),bpfcID:this.BPFCID,name:this.articleNoNew,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.cloneNewVersion(e)}cloneNewVersion(e){this.findArticleNo(this.articleNoNew),null!==this.value?this.checkCode?this.modalNameService.cloneBPFC(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng! <br> Copy succeeded!"),this.modalService.dismissAll(),this.getUndone(),this.gridObj.search(this.articleNoNew),this.value=null):(this.alertify.error("The BPFC exists!"),this.value=null)}):(this.alertify.error("The BPFC exists!"),this.value=null):(this.alertify.error("Version can not be Empty!"),this.value=null)}findArticleNo(e){for(const t of this.data){if(t.articleNo===e){this.checkCode=!1;break}this.checkCode=!0}}onChangeBPFCModal(e){this.BPFCID=e.itemData.id}onClickClone(){const e={modelNameID:this.modelNameID,modelNOID:this.modelNoID,articleNOID:this.articleNoID,artProcessID:Number(this.artProcessID),bpfcID:this.BPFCID,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}clone(e){this.alertify.confirm("Clone BPFC <br> Sao ch\xe9p BPFC","Are you sure you want to copy from this BPFC ?<br> B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p BPFC n\xe0y kh\xf4ng?",()=>{this.modalNameService.cloneModelNameForBPFCShcedule(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng! <br> Copy succeeded!"),this.getUndone(),this.gridObj.search(this.articleNoNew),this.modalService.dismissAll()):this.alertify.error("The BPFC exists!")})})}openModalClone(e,t){this.modalReference=this.modalService.open(e,{size:"lg"}),this.getAllBPFC(),this.modelName=t.modelName,this.modelNo=t.modelNo,this.artProcess=t.artProcess,this.articleNo=t.articleNo,this.modelNameID=t.modelNameID,this.modelNoID=t.modelNoID,console.log(t),this.articleNoID=t.articleNoID,this.getArticleNoByModelNoID(this.modelNoID,t.articleNo),this.artProcessID="ASY"===t.artProcess?1:2}openModal(e,t){this.modalReference=this.modalService.open(e,{size:"md",backdrop:"static",keyboard:!1}),this.BPFCID=t.id,this.modelName=t.modelName,this.modelNo=t.modelNo,this.articleNo=t.articleNo,this.artProcess=t.artProcess,this.articleNoNew=t.articleNo.split("-")[0]+"-T",this.articleNoDefault=t.articleNo.split("-")[0]+"-T",this.modelNameID=t.modelNameID,this.modelNoID=t.modelNoID,this.articleNoID=0,this.artProcessID="ASY"===t.artProcess?1:2}actionBegin(e){if("searching"===e.requestType&&(this.textSearch=e.searchString),"save"===e.requestType){const t={id:e.data.id,season:e.data.season},i=e.previousData.season;(null!==i||""!==i&&i!==e.data.season)&&this.bPFCEstablishService.updateSeason(t).subscribe(()=>{this.alertify.success("Update season successfully"),this.getAllUsers()});const n={id:e.data.id,dueDate:this.dueDate},s=e.previousData.dueDate;"STF"===e.data.artProcess&&this.dueDate.toDateString()!==s&&null!=s&&this.bPFCEstablishService.updateDueDate(n).subscribe(()=>{this.getAllUsers(),this.alertify.success("Update due date successfully")})}}dataBound(e){}toolbarClick(e){switch(e.item.id){case"grid_Excel Import":this.showModal(this.importModal);break;case"Done":this.gridObj.searchSettings.key="",this.tab="done",this.router.navigate([`/ec/establish/bpfc-schedule/${this.tab}`]),this.getDone();break;case"Undone":this.gridObj.searchSettings.key="",this.tab="undone",this.router.navigate([`/ec/establish/bpfc-schedule/${this.tab}`]),this.getUndone();break;case"All":this.gridObj.searchSettings.key="",this.tab="all",this.router.navigate([`/ec/establish/bpfc-schedule/${this.tab}`]),this.getAll();break;case"grid_Excel Export":const e=this.data.map(e=>({approvedBy:e.approvedBy,approvalStatus:e.approvalStatus,createdBy:e.createdBy,articleNo:e.articleNo,createdDate:this.datePipe.transform(e.createdDate,"d MMM, yyyy HH:mm"),artProcess:e.artProcess,finishedStatus:!0===e.finishedStatus?"Yes":"No",modelName:e.modelName,modelNo:e.modelNo,season:e.season}));this.gridObj.excelExport({dataSource:e})}}fileProgress(e){this.file=e.target.files[0]}uploadFile(){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.import(this.file,e).subscribe(e=>{this.getAll(),this.modalReference.close(),this.alertify.success("The excel has been imported into system!")})}loadData(){switch(this.tab){case"undone":this.getUndone();break;case"done":this.getDone();break;case"all":this.getAll()}}getAllUsers(){this.userService.getAllUserInfo().subscribe(e=>{this.users=e,console.log("getAllUsers",this.users)})}delete(e){this.alertify.confirm("Delete BPFC",'Are you sure you want to delete this BPFC "'+e+'" ?',()=>{this.bPFCEstablishService.delete(e).subscribe(e=>{this.alertify.success("Success"),this.getUndone()},e=>{this.alertify.warning(e)})})}rowDB(e){e.data.dueDateStatus&&e.row.classList.add("bgcolor")}editTextOfBtn(){const e=document.getElementById("All"),t=document.getElementById("Undone"),i=document.getElementById("Done");!0===this.isDone?(this.setAttrBtn(i),this.resetAttrBtn(t),this.resetAttrBtn(e)):!1===this.isDone?(this.setAttrBtn(t),this.resetAttrBtn(i),this.resetAttrBtn(e)):null===this.isDone&&(this.setAttrBtn(e),this.resetAttrBtn(i),this.resetAttrBtn(t))}getAll(){this.spinner.show(),this.bPFCEstablishService.getAll().subscribe(e=>{this.data=e.map(e=>{var t;return{id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,createdDate:new Date(e.createdDate),articleNo:e.articleNo,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,dueDate:e.dueDate,dueDateStatus:e.dueDateStatus,approvedBy:null===(t=this.users.filter(t=>t.id===e.approvalBy)[0])||void 0===t?void 0:t.username,createdBy:e.createdBy,artProcess:e.artProcess,season:e.season}}),this.spinner.hide(),this.isDone=null,this.editTextOfBtn()})}getDone(){this.spinner.show(),this.bPFCEstablishService.getDoneBPFC().subscribe(e=>{this.data=e.data.map(e=>{var t;return{id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,createdDate:new Date(e.createdDate),articleNo:e.articleNo,dueDate:e.dueDate,dueDateStatus:e.dueDateStatus,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvedBy:null===(t=this.users.filter(t=>t.id===e.approvalBy)[0])||void 0===t?void 0:t.username,createdBy:e.createdBy,artProcess:e.artProcess,season:e.season}}),this.percentageOfDoneData=e.percentageOfDone,this.percentageOfDone.element.innerHTML=this.percentageOfDoneData,this.doneText=`Done (${e.doneTotal})`,this.undoneText=`Undone (${e.undoneTotal})`,this.isDone=!0,this.editTextOfBtn(),this.spinner.hide()})}getUndone(){this.spinner.show(),this.bPFCEstablishService.getUndoneBPFC().subscribe(e=>{this.data=e.data.map(e=>{var t;return{id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,createdDate:new Date(e.createdDate),articleNo:e.articleNo,dueDate:e.dueDate,dueDateStatus:e.dueDateStatus,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvedBy:null===(t=this.users.filter(t=>t.id===e.approvalBy)[0])||void 0===t?void 0:t.username,createdBy:e.createdBy,artProcess:e.artProcess,season:e.season}}),this.percentageOfDoneData=e.percentageOfDone,this.percentageOfDone.element.innerHTML=this.percentageOfDoneData,this.doneText=`Done (${e.doneTotal})`,this.undoneText=`Undone (${e.undoneTotal})`,this.isDone=!1,this.editTextOfBtn(),this.spinner.hide()})}showModal(e){this.modalReference=this.modalService.open(e,{size:"xl"})}NO(e){return(this.gridObj.pageSettings.currentPage-1)*this.gridObj.pageSettings.pageSize+Number(e)+1}setAttrBtn(e,t={background:"#6c757d",boxShadow:"0 0 0 3px rgba(130, 138, 145, 0.5)",border:"1px solid #6c757d",margin:"0",borderColor:"#6c757d",borderRadius:"4px",color:"#fff"}){e.style.background=t.background,e.style.boxShadow=t.boxShadow,e.style.border=t.border,e.style.margin=t.margin,e.style.borderColor=t.borderColor,e.style.borderRadius=t.borderRadius,e.style.color=t.color}resetAttrBtn(e,t={background:"#f8f9fa",boxShadow:"none",border:"none",margin:"0",borderColor:"#f8f9fa",borderRadius:"none",color:"#495057"}){e.style.background=t.background,e.style.boxShadow=t.boxShadow,e.style.border=t.border,e.style.margin=t.margin,e.style.borderColor=t.borderColor,e.style.borderRadius=t.borderRadius,e.style.color=t.color}}return e.\u0275fac=function(t){return new(t||e)(M.Pb(U.a),M.Pb(E.a),M.Pb(si.a),M.Pb(F.a),M.Pb(c.b),M.Pb(B.c),M.Pb(s.e),M.Pb(a.c),M.Pb(K),M.Pb(x.a),M.Pb(b.b),M.Pb(B.a))},e.\u0275cmp=M.Jb({type:e,selectors:[["app-BPFCSchedule"]],viewQuery:function(e,t){if(1&e&&(M.Rc(ri,1),M.Rc(ci,3),M.Rc(di,1)),2&e){let e;M.Ac(e=M.gc())&&(t.gridObj=e.first),M.Ac(e=M.gc())&&(t.importModal=e.first),M.Ac(e=M.gc())&&(t.tooltip=e)}},features:[M.Bb([s.e]),M.zb],decls:37,vars:10,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"card"],[1,"card-body","p-0"],[1,"row"],[1,"col-md-12"],["id","grid","allowSorting","true","allowResizing","true","allowPaging","true","allowFiltering","true","allowResizing","true","gridLines","Both","showColumnMenu","true",3,"dataSource","pageSettings","filterSettings","sortSettings","editSettings","toolbar","enablePersistence","allowExcelExport","searchSettings","rowDataBound","created","dataBound","toolbarClick","actionBegin"],["grid",""],["field","#","isPrimaryKey","true","textAlign","Center","headerText","#","width","40"],["template",""],["field","modelName","isPrimaryKey","true","textAlign","Left","headerText","Model Name"],["field","modelNo","isPrimaryKey","true","textAlign","Center","width","100","headerText","Model NO"],["field","articleNo","isPrimaryKey","true","textAlign","Center","width","150","headerText","Article NO"],["field","artProcess","isPrimaryKey","true","textAlign","Center","width","100","headerText","Process"],["field","dueDate","textAlign","Center","editType","datepickeredit","type","date","format","d MMM, yyyy","width","150","headerText","STF Date"],["editTemplate",""],["field","createdDate","isPrimaryKey","true","type","date","format","d MMM, yyyy HH:mm","headerText","Update Time","textAlign","Center"],["field","approvedBy","isPrimaryKey","true","textAlign","Center","width","150","headerText","Approval By Supervisor"],["field","season","textAlign","Center","width","100","headerText","Season"],["field","option","textAlign","Center","headerText","-- Option --","width","170"],[1,"card-footer"],["importModal",""],["newVersionModal",""],["cloneModal",""],["position","RightCenter","content","loading...",1,"fix-css",3,"beforeRender"],["tooltip",""],[4,"ngIf","ngIfElse"],["stf",""],["placeholder","Enter date",3,"value","change"],["ejs-button","","cssClass","e-info mr-2","appPermission","","appFunction","BPFC Schedule","appAction","EDIT",3,"click"],[1,"far","fa-edit"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CREATE","cssClass","e-primary mr-2",3,"click",4,"ngIf"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CLONE","cssClass","e-success mr-2",3,"click",4,"ngIf"],["ejs-button","","cssClass","e-danger","appPermission","","appFunction","BPFC Schedule","appAction","DELETE",3,"click"],[1,"fa","fa-trash"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CREATE","cssClass","e-primary mr-2",3,"click"],[1,"fa","fa-plus"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CLONE","cssClass","e-success mr-2",3,"click"],[1,"fa","fa-clone"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],[1,"form-group"],["for","Name"],[3,"href"],["name","file","type","file",1,"form-control",3,"change"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["type","text","name","","disabled","","required","required","title","",1,"form-control",3,"value"],[2,"color","red"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["id","basic-addon3",1,"input-group-text"],["type","text","id","basic-url","placeholder","Enter Version Ex: 1","aria-describedby","basic-addon3",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["popupHeight","300px","popupWidth","450px",3,"dataSource","ngModel","placeholder","fields","allowFiltering","ngModelChange","filtering","created","select"],["changeBPFCDroupdownlist",""]],template:function(e,t){1&e&&(M.Vb(0,"ngx-spinner",0),M.Vb(1,"p",1),M.Lc(2,"Loading data..."),M.Ub(),M.Ub(),M.Vb(3,"div",2),M.Vb(4,"div",3),M.Vb(5,"div",4),M.Vb(6,"div",5),M.Vb(7,"ejs-grid",6,7),M.fc("rowDataBound",function(e){return t.rowDB(e)})("created",function(e){return t.createdSearch(e)})("dataBound",function(e){return t.dataBound(e)})("toolbarClick",function(e){return t.toolbarClick(e)})("actionBegin",function(e){return t.actionBegin(e)}),M.Vb(9,"e-columns"),M.Vb(10,"e-column",8),M.Jc(11,hi,1,1,"ng-template",null,9,M.Kc),M.Ub(),M.Vb(13,"e-column",10),M.Jc(14,ui,3,1,"ng-template",null,9,M.Kc),M.Ub(),M.Qb(16,"e-column",11),M.Qb(17,"e-column",12),M.Qb(18,"e-column",13),M.Vb(19,"e-column",14),M.Jc(20,gi,2,4,"ng-template",null,9,M.Kc),M.Jc(22,pi,3,2,"ng-template",null,15,M.Kc),M.Ub(),M.Qb(24,"e-column",16),M.Qb(25,"e-column",17),M.Qb(26,"e-column",18),M.Vb(27,"e-column",19),M.Jc(28,Ii,6,2,"ng-template",null,9,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Qb(30,"div",20),M.Ub(),M.Jc(31,Ci,22,1,"ng-template",null,21,M.Kc),M.Jc(33,Ni,40,5,"ng-template",null,22,M.Kc),M.Jc(35,Si,19,7,"ng-template",null,23,M.Kc)),2&e&&(M.pc("fullScreen",!0),M.Cb(7),M.pc("dataSource",t.data)("pageSettings",t.pageSettings)("filterSettings",t.filterSettings)("sortSettings",t.sortSettings)("editSettings",t.editSettings)("toolbar",t.toolbarOptions)("enablePersistence",!0)("allowExcelExport",!0)("searchSettings",t.searchOptions))},directives:[a.a,C.j,h.d,v.d,v.b,C.e,C.b,h.c,v.c,v.a,C.d,C.a,D.c,s.n,g.a,u.b,oi.a,l.a,l.f,l.i,r.c],pipes:[s.e,p.c],styles:[".active-btn[_ngcontent-%COMP%]{background-color:#00000073!important;color:#fff!important}.bgcolor[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fa7c7c}"]}),e})();new b.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});let yi=(()=>{class e{constructor(e){this.http=e,this.baseUrl=V.a.apiUrlEC,this.messageSource=new O.a(0),this.currentMessage=this.messageSource.asObservable()}changeMessage(e){this.messageSource.next(e)}getAllComments(){return this.http.get(this.baseUrl+"Comment/GetAll",{})}getAllCommentByBPFCEstablishID(e){return this.http.get(`${this.baseUrl}Comment/GetAllCommentByBPFCEstablishID/${e}`,{})}create(e){return this.http.post(this.baseUrl+"Comment/Create",e)}update(e){return this.http.put(this.baseUrl+"Comment/Update",e)}delete(e){return this.http.delete(this.baseUrl+"Comment/Delete/"+e)}}return e.\u0275fac=function(t){return new(t||e)(M.cc(b.b))},e.\u0275prov=M.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var wi=i("7FIR");const Pi=["gridModel"];function Bi(e,t){if(1&e&&M.Lc(0),2&e){const e=t.$implicit,i=M.jc();M.Nc(" ",i.no(e)," ")}}function Ai(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"CREATED_DATETIME_LABEL")," ")}function xi(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"PIC_LABEL")," ")}function Ui(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"FINISH_LABEL")," ")}function Ei(e,t){1&e&&(M.Vb(0,"span",23),M.Lc(1,"YES"),M.Ub())}function ki(e,t){1&e&&(M.Vb(0,"span",24),M.Lc(1,"No"),M.Ub())}function Vi(e,t){if(1&e&&(M.Jc(0,Ei,2,0,"span",21),M.Jc(1,ki,2,0,"span",22)),2&e){const e=t.$implicit;M.pc("ngIf",1==e.finishedStatus),M.Cb(1),M.pc("ngIf",0==e.finishedStatus)}}function Fi(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"APPROVAL_STATUS_LABEL")," ")}function Mi(e,t){1&e&&(M.Vb(0,"span",24),M.Lc(1,"YET"),M.Ub())}function Li(e,t){1&e&&(M.Vb(0,"span",26),M.Lc(1,"NG"),M.Ub())}function $i(e,t){1&e&&(M.Vb(0,"span",23),M.Lc(1,"OK"),M.Ub())}function Gi(e,t){if(1&e&&(M.Jc(0,Mi,2,0,"span",22),M.Jc(1,Li,2,0,"span",25),M.Jc(2,$i,2,0,"span",21)),2&e){const e=t.$implicit;M.pc("ngIf",0==e.approvalStatus&&"#N/A"===e.approvalBy),M.Cb(1),M.pc("ngIf",0==e.finishedStatus&&0==e.approvalStatus&&"#N/A"!==e.approvalBy),M.Cb(1),M.pc("ngIf",1==e.approvalStatus&&"#N/A"!==e.approvalBy)}}function Ti(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"APPROVAL_BY_LABEL")," ")}function Oi(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"DETAIL_LABEL")," ")}function ji(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",27),M.fc("click",function(){M.Ec(e);const i=t.$implicit,n=M.jc(),s=M.Bc(41);return n.openModalDetail(s,i.id)}),M.Qb(1,"i",28),M.Ub()}}function Ji(e,t){if(1&e&&(M.Vb(0,"div",65),M.Lc(1),M.Ub()),2&e){const e=t.$implicit;M.qc("title",e.name),M.Cb(1),M.Nc(" ",e.name," ")}}function Ri(e,t){1&e&&(M.Vb(0,"div"),M.Qb(1,"i",66),M.Ub())}function Ki(e,t){if(1&e&&(M.Vb(0,"span"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit;M.Cb(1),M.Nc("\xb1 ",e.allow,"")}}function Qi(e,t){if(1&e&&(M.Vb(0,"li",67),M.Vb(1,"a",68),M.Qb(2,"img",69),M.Ub(),M.Vb(3,"div",70),M.Vb(4,"span",71),M.Vb(5,"small",72),M.Lc(6),M.Ub(),M.Ub(),M.Vb(7,"strong",73),M.Lc(8),M.Ub(),M.Vb(9,"p"),M.Lc(10),M.Ub(),M.Ub(),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Cb(6),M.Nc(" ",i.datetime(e.createdDate),""),M.Cb(2),M.Nc(" ",i.username(e.createdBy),""),M.Cb(2),M.Nc(" ",e.content," ")}}function Hi(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",29),M.Vb(1,"h4",30),M.Qb(2,"i",31),M.Lc(3," BPFC Detail "),M.Ub(),M.Vb(4,"button",32),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",33),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",34),M.Vb(8,"div",2),M.Vb(9,"div",35),M.Vb(10,"ejs-grid",36,37),M.fc("rowSelected",function(t){return M.Ec(e),M.jc().rowSelected(t)}),M.Vb(12,"e-columns"),M.Vb(13,"e-column",38),M.Jc(14,Ji,2,2,"ng-template",null,8,M.Kc),M.Ub(),M.Qb(16,"e-column",39),M.Qb(17,"e-column",40),M.Qb(18,"e-column",41),M.Qb(19,"e-column",42),M.Qb(20,"e-column",43),M.Qb(21,"e-column",44),M.Ub(),M.Ub(),M.Ub(),M.Vb(22,"div",35),M.Vb(23,"ejs-grid",45,46),M.Vb(25,"e-columns"),M.Qb(26,"e-column",47),M.Qb(27,"e-column",48),M.Qb(28,"e-column",49),M.Vb(29,"e-column",50),M.Jc(30,Ri,2,0,"ng-template",null,14,M.Kc),M.Jc(32,Ki,2,1,"ng-template",null,8,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(34,"div",51),M.Vb(35,"button",52),M.fc("click",function(){return M.Ec(e),M.jc().release()}),M.Lc(36,"Release"),M.Ub(),M.Vb(37,"button",53),M.fc("click",function(){return M.Ec(e),M.jc().reject()}),M.Lc(38,"Reject"),M.Ub(),M.Vb(39,"button",54),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(40,"Close"),M.Ub(),M.Ub(),M.Vb(41,"div",34),M.Vb(42,"div",2),M.Vb(43,"div",3),M.Vb(44,"div",55),M.Vb(45,"div",56),M.Vb(46,"div",57),M.Vb(47,"div",58),M.Vb(48,"div",59),M.Vb(49,"textarea",60),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc().content=t}),M.Ub(),M.Qb(50,"br"),M.Vb(51,"button",61),M.fc("click",function(){return M.Ec(e),M.jc().createComment()}),M.Lc(52,"Post"),M.Ub(),M.Qb(53,"div",62),M.Qb(54,"hr"),M.Vb(55,"ul",63),M.Jc(56,Qi,11,3,"li",64),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(10),M.pc("dataSource",e.glues)("selectedRowIndex",0),M.Cb(13),M.pc("dataSource",e.ingredients)("allowSorting",!0),M.Cb(26),M.pc("ngModel",e.content),M.Cb(7),M.pc("ngForOf",e.comments)}}let _i=(()=>{class e extends ni.a{constructor(e,t,i,n,s,l,a,o,r,c,d){super(),this.modalNameService=e,this.bPFCEstablishService=t,this.modalService=i,this.alertify=n,this.ingredientService=s,this.glueService=l,this.commentService=a,this.calendarsService=o,this.userService=r,this.spinner=c,this.route=d,this.users=[],this.data=[],this.searchSettings={hierarchyMode:"Parent"},this.ingredients=[],this.glues=[],this.modalname={id:0,name:"",modelNo:"",createdBy:JSON.parse(localStorage.getItem("user")).user.id},this.toolbar=["Default",{text:"Rejected",tooltipText:"Rejected",prefixIcon:"fa fa-times",id:"Rejected"},{text:"Approved",tooltipText:"Approved",prefixIcon:"fa fa-check",id:"Approved"},"All","Search"]}ngOnInit(){this.tab="Default",this.Permission(this.route),this.pageSettings={pageSizes:!0,currentPage:1,pageSize:10,pageCount:20},this.editparams={params:{popupHeight:"300px"}}}Permission(e){const t=e.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(e=>e.functionCode===t)||[];for(const i of this.functions){const e=[];for(const n of i.childrens){const t=this.makeAction(n.code);e.push(...t.filter(Boolean))}e.push(...this.toolbar);const t=e.filter((e,t,i)=>t===i.indexOf(e));this.toolbarOptions=t}}makeAction(e){switch(e){case ai.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}ngAfterViewInit(){const e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}getBuilding(){JSON.parse(localStorage.getItem("user"))}createdSearch(e){this.getAllUsers()}loadData(){switch(this.tab){case"Approved":this.filterByApprovedStatus();break;case"Rejected":this.filterRejected();break;case"All":this.getAllBPFCStatus();break;case"Default":this.defaultFilter()}}dataBound(){this.gridModel.autoFitColumns()}no(e){return(this.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(e.index)+1}actionBegin(e){"save"===e.requestType&&(this.modalname.id=e.data.id||0,this.modalname.name=e.data.name,this.modalname.modelNo=e.data.modelNo,e.data.id>0?this.update(this.modalname):this.add(this.modalname)),"delete"===e.requestType&&this.delete(e.data[0].id)}actionComplete(e){"add"===e.requestType&&(e.form.elements.namedItem("name").focus(),e.form.elements.namedItem("id").disabled=!0,e.form.elements.namedItem("tool").disabled=!0)}onDoubleClick(e){this.setFocus=e.column}openaddModalName(e){this.modalReference=this.modalService.open(e)}getAllBPFCStatus(){this.spinner.show(),this.bPFCEstablishService.getAllBPFCStatus().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),this.editTextOfBtn(),this.spinner.hide()},()=>this.spinner.hide())}filterRejected(){this.spinner.show(),this.bPFCEstablishService.rejectedFilter().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),this.editTextOfBtn(),this.spinner.hide()},()=>this.spinner.hide())}filterByApprovedStatus(){this.spinner.show(),this.bPFCEstablishService.filterByApprovedStatus().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),this.editTextOfBtn(),this.spinner.hide()},()=>this.spinner.hide())}filterByFinishedStatus(){this.spinner.show(),this.bPFCEstablishService.filterByFinishedStatus().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),this.editTextOfBtn(),this.spinner.hide()},()=>this.spinner.hide())}defaultFilter(){this.spinner.show(),this.bPFCEstablishService.defaultFilter().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),this.editTextOfBtn(),this.spinner.hide()},()=>this.spinner.hide())}filterByNotApprovedStatus(){this.spinner.show(),this.bPFCEstablishService.filterByNotApprovedStatus().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),this.spinner.hide()},()=>this.spinner.hide())}update(e){this.modalNameService.update(e).subscribe(()=>{this.alertify.success("Update Modal Name Successfully")})}delete(e){this.alertify.confirm("Delete Modal Name",'Are you sure you want to delete this ModalName ID "'+e+'" ?',()=>{this.modalNameService.delete(e).subscribe(()=>{this.getAllBPFCStatus(),this.alertify.success("Modal Name has been deleted")})})}add(e){this.modalNameService.create(e).subscribe(()=>{this.alertify.success("Add Modal Name Successfully"),this.getAllBPFCStatus()})}approval(e){const t=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(e,t).subscribe(()=>{this.alertify.success("The model name - model no has been approved!"),this.getAllBPFCStatus()})}done(e){const t=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(e,t).subscribe(()=>{this.alertify.success("The model name - model no has been finished!"),this.getAllBPFCStatus()})}release(){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.release(this.BPFCEstablishID,e).subscribe(()=>{this.alertify.success("The model name - model no has been released!"),this.filterByApprovedStatus(),this.modalReferenceDetail.close()})}reject(){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.reject(this.BPFCEstablishID,e).subscribe(e=>{if(!0===e.status){this.alertify.success(e.message),this.filterByNotApprovedStatus(),this.modalReferenceDetail.close();const t=this.users.filter(t=>t.ID===e.userId)[0].Email||"";this.bPFCEstablishService.sendMailForPIC(t).subscribe(()=>{})}else this.alertify.error(e.message)})}openModalDetail(e,t){this.modalReferenceDetail=this.modalService.open(e,{size:"xxl"}),setTimeout(()=>{this.getAllGluesByBPFCID(t)},300),this.BPFCEstablishID=t,this.getComments()}sortBySup(e){this.ingredientService.sortBySup(e,0).subscribe(e=>{this.ingredients=e.list1})}getAllGluesByBPFCID(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{this.glues=e.map(e=>({chemical:e.chemical,code:e.code,consumption:e.consumption,createdBy:this.createdBy(e.createdBy),createdDate:e.createdDate,expiredTime:e.expiredTime,glueID:e.glueID,glueName:e.glueName,id:e.id,ingredients:e.ingredients,materialName:e.materialName,materialNameID:e.materialNameID,modelNameID:e.modelNameID,modelNo:e.modelNo,modelNoID:e.modelNoID,name:e.name,partNameID:e.partNameID,pathName:e.pathName,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),0===this.glues.length?this.glueid=0:(this.glueid=this.glues[0].id,this.sortBySup(this.glueid))})}rowSelected(e){this.sortBySup(e.data.id)}toolbarClick(e){switch(e.item.id){case"Approved":this.tab="Approved",this.filterByApprovedStatus();break;case"Rejected":this.tab="Rejected",this.filterRejected();break;case"grid_All":this.tab="All",this.getAllBPFCStatus();break;case"Excel Export":this.gridModel.excelExport();break;case"grid_Default":this.tab="Default",this.defaultFilter()}}getAllUsers(){this.userService.getAllUserInfo().subscribe(e=>{this.users=e,this.loadData()})}createComment(){this.comment={id:0,content:this.content,createdBy:JSON.parse(localStorage.getItem("user")).user.id,createdByName:"",BPFCEstablishID:this.BPFCEstablishID,createdDate:new Date},this.commentService.create(this.comment).subscribe(()=>{this.alertify.success("The comment has been created!"),this.content="",this.getComments()})}updateComment(){this.commentService.update(this.comment).subscribe(()=>{this.alertify.success("The comment has been updated!"),this.getComments()})}deleteComment(){this.commentService.delete(this.comment.id).subscribe(()=>{this.alertify.success("The comment has been deleted!"),this.getComments()})}getComments(){this.commentService.getAllCommentByBPFCEstablishID(this.BPFCEstablishID).subscribe(e=>{this.comments=e})}datetime(e){return this.calendarsService.JSONDateWithTime(e)}username(e){return this.users.filter(t=>t.id===e)[0].username}createdBy(e){if(0===e)return"#N/A";const t=this.users.filter(t=>t.id===e)[0];return void 0!==t?t.username:"#N/A"}editTextOfBtn(){const e=document.getElementById("grid_All"),t=document.getElementById("grid_Default"),i=document.getElementById("Rejected"),n=document.getElementById("Approved");switch(this.tab){case"All":this.setAttrBtn(e),this.resetAttrBtn(t),this.resetAttrBtn(i),this.resetAttrBtn(n);break;case"Default":this.setAttrBtn(t),this.resetAttrBtn(e),this.resetAttrBtn(i),this.resetAttrBtn(n);break;case"Rejected":this.setAttrBtn(i),this.resetAttrBtn(t),this.resetAttrBtn(e),this.resetAttrBtn(n);break;case"Approved":this.setAttrBtn(n),this.resetAttrBtn(i),this.resetAttrBtn(t),this.resetAttrBtn(e)}}setAttrBtn(e,t={background:"#6c757d",boxShadow:"0 0 0 3px rgba(130, 138, 145, 0.5)",border:"1px solid #6c757d",margin:"0",borderColor:"#6c757d",borderRadius:"4px",color:"#fff"}){e.style.background=t.background,e.style.boxShadow=t.boxShadow,e.style.border=t.border,e.style.margin=t.margin,e.style.borderColor=t.borderColor,e.style.borderRadius=t.borderRadius,e.style.color=t.color}resetAttrBtn(e,t={background:"#f8f9fa",boxShadow:"none",border:"none",margin:"0",borderColor:"#f8f9fa",borderRadius:"none",color:"#495057"}){e.style.background=t.background,e.style.boxShadow=t.boxShadow,e.style.border=t.border,e.style.margin=t.margin,e.style.borderColor=t.borderColor,e.style.borderRadius=t.borderRadius,e.style.color=t.color}}return e.\u0275fac=function(t){return new(t||e)(M.Pb(U.a),M.Pb(F.a),M.Pb(c.b),M.Pb(E.a),M.Pb(L.a),M.Pb(R.a),M.Pb(yi),M.Pb(wi.a),M.Pb(si.a),M.Pb(a.c),M.Pb(B.a))},e.\u0275cmp=M.Jb({type:e,selectors:[["app-bpfc-status"]],viewQuery:function(e,t){if(1&e&&M.Rc(Pi,1),2&e){let e;M.Ac(e=M.gc())&&(t.gridModel=e.first)}},features:[M.zb],decls:42,vars:6,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row"],[1,"col-md-12"],[1,"card"],["id","grid","allowPaging","true","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"searchSettings","toolbar","dataSource","allowExcelExport","pageSettings","dataBound","toolbarClick","actionBegin","recordDoubleClick","actionComplete","created"],["gridModel",""],["field","","headerText","#","isPrimaryKey","true","width","40","textAlign","Center","isPrimaryKey","true"],["template",""],["field","modelName","isPrimaryKey","true","textAlign","Center","headerText","Model Name","width","130"],["field","modelNo","isPrimaryKey","true","textAlign","Center","headerText","Model No","width","104"],["field","articleNo","isPrimaryKey","true","textAlign","Center","headerText","Article #","width","97"],["field","artProcess","isPrimaryKey","true","textAlign","Center","headerText","Process","width","97"],["field","createdDate","headerText","Created Date Time","type","date","format","dd MMM, yyyy HH:mm","width","155","textAlign","Center"],["headerTemplate",""],["field","createdBy","headerText","PIC","width","90","textAlign","Center"],["field","finishedStatus","isPrimaryKey","true","headerText","Finished","width","130","textAlign","Center"],["field","approvalStatus","isPrimaryKey","true","headerText","Approval Status","width","130","textAlign","Center"],["field","approvalBy","headerText","Approval By","width","100","textAlign","Center"],["field","tool","isPrimaryKey","true","headerText","Detail","width","70","textAlign","Center"],["detailModal",""],["class","badge badge-success",4,"ngIf"],["class","badge badge-danger",4,"ngIf"],[1,"badge","badge-success"],[1,"badge","badge-danger"],["class","badge badge-warning",4,"ngIf"],[1,"badge","badge-warning"],["ejs-button","","cssClass","e-info",3,"click"],[1,"fa","fa-eye"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],["showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both","height","250px",3,"dataSource","selectedRowIndex","rowSelected"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","finishedDate","headerText","Created Date Time","type","date","format","d MMM, yyyy HH:mm","width","150","textAlign","Center"],["field","finishedBy","headerText","PIC","width","100","textAlign","Center"],["field","modelNo","headerText","Kind","textAlign","Center","width","150"],["field","pathName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both","height","250px",3,"dataSource","allowSorting"],["grid",""],["field","position","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","150","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","70"],["field","allow","headerText","Allow (%)","textAlign","Center","width","70"],[1,"modal-footer"],["type","submit","appPermission","","appFunction","BPFC Status","appAction","RELEASE",1,"btn","btn-success",3,"click"],["type","submit","appPermission","","appFunction","BPFC Status","appAction","REJECT",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"row","bootstrap","snippets"],[1,"col-md-12","col-md-offset-2","col-sm-12"],[1,"comment-wrapper"],[1,"panel","panel-info"],[1,"panel-body"],["placeholder","write a comment...","rows","3",1,"form-control",3,"ngModel","ngModelChange"],["type","button","appPermission","","appFunction","BPFC Status","appAction","POST",1,"btn","btn-info","pull-right",3,"click"],[1,"clearfix"],[1,"media-list",2,"padding","0"],["class","media",4,"ngFor","ngForOf"],["data-toggle","tooltip","data-placement","top",3,"title"],[1,"fas","fa-exclamation-circle"],[1,"media"],["href","#",1,"pull-left"],["src","../../../../assets/img/logo-1.png","alt","",1,"img-circle"],[1,"media-body","ml-1"],[1,"text-muted","pull-right"],[1,"text-muted"],[1,"text-success"]],template:function(e,t){1&e&&(M.Vb(0,"ngx-spinner",0),M.Vb(1,"p",1),M.Lc(2,"Loading data..."),M.Ub(),M.Ub(),M.Vb(3,"div",2),M.Vb(4,"div",3),M.Vb(5,"div",4),M.Vb(6,"ejs-grid",5,6),M.fc("dataBound",function(){return t.dataBound()})("toolbarClick",function(e){return t.toolbarClick(e)})("actionBegin",function(e){return t.actionBegin(e)})("recordDoubleClick",function(e){return t.onDoubleClick(e)})("actionComplete",function(e){return t.actionComplete(e)})("created",function(e){return t.createdSearch(e)}),M.Vb(8,"e-columns"),M.Vb(9,"e-column",7),M.Jc(10,Bi,1,1,"ng-template",null,8,M.Kc),M.Ub(),M.Qb(12,"e-column",9),M.Qb(13,"e-column",10),M.Qb(14,"e-column",11),M.Qb(15,"e-column",12),M.Vb(16,"e-column",13),M.Jc(17,Ai,2,3,"ng-template",null,14,M.Kc),M.Ub(),M.Vb(19,"e-column",15),M.Jc(20,xi,2,3,"ng-template",null,14,M.Kc),M.Ub(),M.Vb(22,"e-column",16),M.Jc(23,Ui,2,3,"ng-template",null,14,M.Kc),M.Jc(25,Vi,2,2,"ng-template",null,8,M.Kc),M.Ub(),M.Vb(27,"e-column",17),M.Jc(28,Fi,2,3,"ng-template",null,14,M.Kc),M.Jc(30,Gi,3,3,"ng-template",null,8,M.Kc),M.Ub(),M.Vb(32,"e-column",18),M.Jc(33,Ti,2,3,"ng-template",null,14,M.Kc),M.Ub(),M.Vb(35,"e-column",19),M.Jc(36,Oi,2,3,"ng-template",null,14,M.Kc),M.Jc(38,ji,2,0,"ng-template",null,8,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Jc(40,Hi,57,6,"ng-template",null,20,M.Kc),M.Ub()),2&e&&(M.pc("fullScreen",!0),M.Cb(6),M.pc("searchSettings",t.searchSettings)("toolbar",t.toolbar)("dataSource",t.data)("allowExcelExport",!0)("pageSettings",t.pageSettings))},directives:[a.a,C.j,h.d,v.d,v.b,C.e,C.b,h.c,v.c,v.a,C.d,C.a,s.n,u.b,oi.a,l.a,l.f,l.i,s.m],pipes:[p.c],styles:["body[_ngcontent-%COMP%]{margin-top:20px}.comment-wrapper[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{max-height:650px;overflow:auto}.comment-wrapper[_ngcontent-%COMP%]   .media-list[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;border:2px solid #e5e7e8}.comment-wrapper[_ngcontent-%COMP%]   .media-list[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]{border-bottom:1px dashed #efefef;margin-bottom:25px}.e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}"]}),e})();const Wi=["doneSwitch"],qi=["approvalSwitch"],zi=["gridglue"],Xi=["grid2"],Yi=["modelNameDropdownlist"],Zi=["modelNoDropdownlist"],en=["chemicalDropdownlist"],tn=["grid"],nn=["positionDropdownlist"];function sn(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"GLUE")," ")}function ln(e,t){if(1&e&&(M.Vb(0,"div",30),M.Lc(1),M.Ub()),2&e){const e=t.$implicit;M.qc("title",e.name),M.Cb(1),M.Nc(" ",e.name," ")}}function an(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"CONSUMPTION")," ")}function on(e,t){if(1&e&&(M.Vb(0,"span"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(2);M.Eb(i.changeConsumptionColor(e)),M.Cb(1),M.Mc(""===e.consumption?"0":e.consumption)}}function rn(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"EXPIRED_TIME")," ")}function cn(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"KIND")," ")}function dn(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",31,32),M.fc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangeKindEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.kinds)("ngModel",e.kindName)("fields",i.fieldsKindEdit)("allowFiltering",!0)}}function hn(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"PART")," ")}function un(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",33,32),M.fc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangePartEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.parts)("ngModel",e.partName)("fields",i.fieldsPartEdit)("allowFiltering",!0)}}function gn(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"MATERIAL")," ")}function mn(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",33,32),M.fc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(t){return M.Ec(e),M.jc(2).onChangeMaterialEdit(t)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.pc("dataSource",i.materials)("ngModel",e.materialName)("fields",i.fieldsMaterialEdit)("allowFiltering",!0)}}function bn(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",18),M.Vb(1,"ejs-grid",19,20),M.fc("rowDeselected",function(t){return M.Ec(e),M.jc().rowDeselected(t)})("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginGlue(t)})("rowSelected",function(t){return M.Ec(e),M.jc().rowSelected(t)})("created",function(){return M.Ec(e),M.jc().onCreatedGridGlue()})("toolbarClick",function(t){return M.Ec(e),M.jc().toolbarClick(t)})("dataBound",function(){return M.Ec(e),M.jc().dataBoundGlue()}),M.Vb(3,"e-columns"),M.Vb(4,"e-column",21),M.Jc(5,sn,2,3,"ng-template",null,22,M.Kc),M.Jc(7,ln,2,2,"ng-template",null,23,M.Kc),M.Ub(),M.Vb(9,"e-column",24),M.Jc(10,an,2,3,"ng-template",null,22,M.Kc),M.Jc(12,on,2,3,"ng-template",null,23,M.Kc),M.Ub(),M.Vb(14,"e-column",25),M.Jc(15,rn,2,3,"ng-template",null,22,M.Kc),M.Ub(),M.Vb(17,"e-column",26),M.Jc(18,cn,2,3,"ng-template",null,22,M.Kc),M.Jc(20,dn,2,4,"ng-template",null,27,M.Kc),M.Ub(),M.Vb(22,"e-column",28),M.Jc(23,hn,2,3,"ng-template",null,22,M.Kc),M.Jc(25,un,2,4,"ng-template",null,27,M.Kc),M.Ub(),M.Vb(27,"e-column",29),M.Jc(28,gn,2,3,"ng-template",null,22,M.Kc),M.Jc(30,mn,2,4,"ng-template",null,27,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(1),M.pc("dataSource",e.glues)("editSettings",e.editSettings)("toolbar",e.toolbar)("allowSorting",!0)("selectedRowIndex",e.rowIndex)}}function pn(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",34),M.Vb(1,"button",35),M.fc("click",function(){return M.Ec(e),M.jc().back()}),M.Qb(2,"i",36),M.Lc(3),M.kc(4,"translate"),M.Ub(),M.Vb(5,"button",37),M.Qb(6,"i",38),M.Lc(7," Reset "),M.Ub(),M.Vb(8,"ejs-switch",39,40),M.fc("click",function(){return M.Ec(e),M.jc().done()})("checkedChange",function(t){return M.Ec(e),M.jc().createdStatus=t}),M.kc(10,"translate"),M.kc(11,"translate"),M.Ub(),M.Vb(12,"ejs-switch",41,42),M.fc("click",function(){return M.Ec(e),M.jc().approval()})("checkedChange",function(t){return M.Ec(e),M.jc().approvalStatus=t}),M.kc(14,"translate"),M.Ub(),M.Vb(15,"button",43),M.fc("click",function(){return M.Ec(e),M.jc().finished()}),M.Qb(16,"i",44),M.Lc(17),M.kc(18,"translate"),M.Ub(),M.Vb(19,"button",45),M.fc("click",function(){M.Ec(e);const t=M.jc(),i=M.Bc(44);return t.openModalHistory(i)}),M.Qb(20,"i",46),M.Lc(21," History"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(3),M.Nc(" ",M.lc(4,8,"Back")," "),M.Cb(5),M.qc("onLabel",M.lc(10,10,"DONE")),M.qc("offLabel",M.lc(11,12,"UNDONE")),M.pc("disabled",e.approvalStatus)("checked",e.createdStatus),M.Cb(4),M.qc("offLabel",M.lc(14,14,"NOT_APPROVED")),M.pc("checked",e.approvalStatus),M.Cb(5),M.Nc(" ",M.lc(18,16,"FINISHED")," ")}}function fn(e,t){if(1&e&&(M.Vb(0,"li",56),M.Vb(1,"a"),M.Lc(2),M.Vb(3,"span",57),M.Lc(4),M.Ub(),M.Ub(),M.Ub()),2&e){const e=t.$implicit;M.Cb(2),M.Oc(" ",e.position,". ",e.ingredientName," "),M.Cb(2),M.Nc("(",e.percentage,"%)")}}function Dn(e,t){if(1&e&&(M.Vb(0,"ul"),M.Vb(1,"span",53),M.Lc(2),M.Ub(),M.Vb(3,"li",54),M.Lc(4),M.Vb(5,"ul"),M.Jc(6,fn,5,3,"li",55),M.Ub(),M.Ub(),M.Ub()),2&e){const e=M.jc(2);M.Cb(2),M.Mc(e.formulaTamp()),M.Cb(2),M.Nc(" ",e.formula()," "),M.Cb(2),M.pc("ngForOf",e.renderchemical())}}function In(e,t){if(1&e){const e=M.Wb();M.Vb(0,"button",58),M.fc("click",function(){M.Ec(e);const i=t.$implicit;return M.jc(2).sortBySup(i.id)}),M.Qb(1,"i",59),M.Lc(2),M.Ub()}if(2&e){const e=t.$implicit;M.Cb(2),M.Nc(" ",e.name," ")}}function Cn(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"ITEM")," ")}function Nn(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",67,68),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(3).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(3);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Sn(e,t){if(1&e){const e=M.Wb();M.Vb(0,"ejs-dropdownlist",67,68),M.fc("change",function(i){M.Ec(e);const n=t.$implicit;return M.jc(3).onChangePosition(i,n,n.index)}),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(3);M.pc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function vn(e,t){1&e&&(M.Lc(0),M.kc(1,"translate")),2&e&&M.Nc(" ",M.lc(1,1,"INGREDIENT_NAME")," ")}function yn(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function wn(e,t){1&e&&M.Lc(0),2&e&&M.Nc(" ",t.$implicit.name," ")}function Pn(e,t){if(1&e&&(M.Vb(0,"div"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(3);M.Eb(i.changePercentageColor(e)),M.Cb(1),M.Mc(e.percentage)}}function Bn(e,t){1&e&&(M.Vb(0,"div"),M.Qb(1,"i",69),M.Ub())}function An(e,t){if(1&e&&(M.Vb(0,"div"),M.Lc(1),M.Ub()),2&e){const e=t.$implicit,i=M.jc(3);M.Eb(i.changeAllowColor(e)),M.Cb(1),M.Nc("\xb1 ",e.allow,"")}}function xn(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",60),M.Vb(1,"div",9),M.Vb(2,"div",18),M.Vb(3,"ejs-grid",61,62),M.fc("actionComplete",function(t){return M.Ec(e),M.jc(2).actionCompleteIngredient(t)})("recordDoubleClick",function(t){return M.Ec(e),M.jc(2).onDoubleClickIngredient(t)})("actionBegin",function(t){return M.Ec(e),M.jc(2).actionBeginIngredient(t)})("toolbarClick",function(t){return M.Ec(e),M.jc(2).toolbarClickIngredient(t)})("rowSelected",function(t){return M.Ec(e),M.jc(2).rowSelectedIngredient(t)}),M.Vb(5,"e-columns"),M.Vb(6,"e-column",63),M.Jc(7,Cn,2,3,"ng-template",null,22,M.Kc),M.Jc(9,Nn,2,4,"ng-template",null,23,M.Kc),M.Jc(11,Sn,2,4,"ng-template",null,27,M.Kc),M.Ub(),M.Vb(13,"e-column",64),M.Jc(14,vn,2,3,"ng-template",null,22,M.Kc),M.Jc(16,yn,1,1,"ng-template",null,27,M.Kc),M.Jc(18,wn,1,1,"ng-template",null,23,M.Kc),M.Ub(),M.Vb(20,"e-column",65),M.Jc(21,Pn,2,3,"ng-template",null,23,M.Kc),M.Ub(),M.Vb(23,"e-column",66),M.Jc(24,Bn,2,0,"ng-template",null,22,M.Kc),M.Jc(26,An,2,3,"ng-template",null,23,M.Kc),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub()}if(2&e){const e=t.$implicit,i=M.jc(2);M.Cb(3),M.pc("dataSource",e)("allowSorting",!0)("allowSorting",!0)("editSettings",i.editSettings)("toolbar",i.toolbarOptions2)}}function Un(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",47),M.Jc(1,Dn,7,3,"ul",48),M.Vb(2,"div",0),M.Vb(3,"div",49),M.Vb(4,"button",50),M.fc("click",function(){return M.Ec(e),M.jc().sortBySup(0)}),M.Lc(5),M.kc(6,"translate"),M.Ub(),M.Jc(7,In,3,1,"button",51),M.Ub(),M.Ub(),M.Vb(8,"div",0),M.Jc(9,xn,28,5,"div",52),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(1),M.pc("ngIf",e.renderchemical().length>0),M.Cb(4),M.Nc(" ",M.lc(6,4,"DEFAULT")," "),M.Cb(2),M.pc("ngForOf",e.supplier),M.Cb(2),M.pc("ngForOf",e.ingredientGroupData)}}function En(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",70),M.Vb(1,"h4",71),M.Qb(2,"i",72),M.Lc(3," Clone Article "),M.Ub(),M.Vb(4,"button",73),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",74),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",75),M.Vb(8,"div",0),M.Vb(9,"div",76),M.Vb(10,"div",77),M.Vb(11,"label",78),M.Lc(12,"Article Name"),M.Ub(),M.Vb(13,"span",79),M.Lc(14,"(*)"),M.Ub(),M.Vb(15,"input",80),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc().articleName=t}),M.Ub(),M.Ub(),M.Ub(),M.Vb(16,"div",76),M.Vb(17,"div",77),M.Vb(18,"label",78),M.Lc(19,"Process"),M.Ub(),M.Vb(20,"ejs-dropdownlist",81,82),M.fc("change",function(t){return M.Ec(e),M.jc().onChangeProcessCloneModal(t)}),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(22,"div",83),M.Vb(23,"button",84),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(24,"Close"),M.Ub(),M.Vb(25,"button",85),M.fc("click",function(){return M.Ec(e),M.jc().cloneArticleModelname()}),M.Lc(26,"Clone"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(15),M.pc("ngModel",e.articleName),M.Cb(5),M.pc("value",e.valueProcess)("dataSource",e.processData)("allowFiltering",!0)("fields",e.processfields)}}function kn(e,t){1&e&&(M.Lc(0),M.kc(1,"date")),2&e&&M.Nc(" ",M.mc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function Vn(e,t){if(1&e&&(M.Tb(0),M.Qb(1,"input",98),M.Sb()),2&e){const e=M.jc().$implicit;M.Cb(1),M.pc("value",e.remark)}}function Fn(e,t){if(1&e&&M.Qb(0,"input",99),2&e){const e=M.jc().$implicit;M.pc("value",e.remark)}}function Mn(e,t){if(1&e&&(M.Vb(0,"span",95),M.Jc(1,Vn,2,1,"ng-container",96),M.Jc(2,Fn,1,1,"ng-template",null,97,M.Kc),M.Ub()),2&e){const e=t.$implicit,i=M.Bc(3);M.pc("ngClass","Improve"==e.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),M.Cb(1),M.pc("ngIf","Improve"==e.action)("ngIfElse",i)}}function Ln(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",70),M.Vb(1,"h4",71),M.Qb(2,"i",72),M.Lc(3," BPFC History "),M.Ub(),M.Vb(4,"button",73),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",74),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",75),M.Vb(8,"ejs-grid",86,87),M.fc("actionBegin",function(t){return M.Ec(e),M.jc().actionBeginHistory(t)}),M.Vb(10,"e-columns"),M.Vb(11,"e-column",88),M.Jc(12,kn,2,4,"ng-template",null,23,M.Kc),M.Ub(),M.Qb(14,"e-column",89),M.Qb(15,"e-column",90),M.Qb(16,"e-column",91),M.Vb(17,"e-column",92),M.Jc(18,Mn,4,3,"ng-template",null,27,M.Kc),M.Ub(),M.Qb(20,"e-column",93),M.Ub(),M.Ub(),M.Ub(),M.Vb(21,"div",83),M.Vb(22,"button",94),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(23,"Close"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(8),M.pc("dataSource",e.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettingsHis)("toolbar",e.toolbarOptionsHistory),M.Cb(9),M.pc("edit",e.editparamsHis)}}function $n(e,t){if(1&e){const e=M.Wb();M.Vb(0,"div",70),M.Vb(1,"h4",71),M.Qb(2,"i",72),M.Lc(3," Clone BPFC "),M.Ub(),M.Vb(4,"button",73),M.fc("click",function(){return t.$implicit.dismiss("Cross click")}),M.Vb(5,"span",74),M.Lc(6,"\xd7"),M.Ub(),M.Ub(),M.Ub(),M.Vb(7,"div",75),M.Vb(8,"div",0),M.Vb(9,"div",76),M.Vb(10,"div",77),M.Vb(11,"label",78),M.Lc(12,"Model Name"),M.Ub(),M.Vb(13,"span",79),M.Lc(14,"(*)"),M.Ub(),M.Qb(15,"input",6),M.Ub(),M.Ub(),M.Vb(16,"div",76),M.Vb(17,"div",77),M.Vb(18,"label",78),M.Lc(19,"Model NO"),M.Ub(),M.Vb(20,"span",79),M.Lc(21,"(*)"),M.Ub(),M.Qb(22,"input",6),M.Ub(),M.Ub(),M.Vb(23,"div",76),M.Vb(24,"div",77),M.Vb(25,"label",78),M.Lc(26,"Article NO"),M.Ub(),M.Vb(27,"span",79),M.Lc(28,"(*)"),M.Ub(),M.Vb(29,"input",100),M.fc("ngModelChange",function(t){return M.Ec(e),M.jc().articleNoNewLeo=t}),M.Ub(),M.Ub(),M.Ub(),M.Vb(30,"div",76),M.Vb(31,"div",77),M.Vb(32,"label",78),M.Lc(33,"Process"),M.Ub(),M.Vb(34,"span",79),M.Lc(35,"(*)"),M.Ub(),M.Qb(36,"input",6),M.Ub(),M.Ub(),M.Ub(),M.Ub(),M.Vb(37,"div",83),M.Vb(38,"button",84),M.fc("click",function(){return t.$implicit.close("Close click")}),M.Lc(39,"Close"),M.Ub(),M.Vb(40,"button",85),M.fc("click",function(){return M.Ec(e),M.jc().onClickClone()}),M.Lc(41,"Clone"),M.Ub(),M.Ub()}if(2&e){const e=M.jc();M.Cb(15),M.pc("value",e.modelNameLeo),M.Cb(7),M.pc("value",e.modelNoLeo),M.Cb(7),M.pc("ngModel",e.articleNoNewLeo)("value",e.articleNoLeo),M.Cb(7),M.pc("value",e.artProcessLeo)}}let Gn=(()=>{class e{constructor(e,t,i,n,s,l,a,o,r,c,d,h,u,g,m,b,p,f){this.glueIngredientService=e,this.modalNameService=t,this.glueService=i,this.alertify=n,this.modalService=s,this.route=l,this.router=a,this.authService=o,this.bPFCEstablishService=r,this.modelNoService=c,this.articleNoService=d,this.kindService=h,this.partService=u,this.materialService=g,this.buildingUserService=m,this.artProcessService=b,this.ingredientService=p,this.dataService=f,this.positions=["B","C","D","E"],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={id:0,name:"",gluename:"",code:"",createdDate:"",partID:0,kindID:0,materialID:0,BPFCEstablishID:0,consumption:"",expiredTime:0,createdBy:0,glueNameID:0,glueIngredients:[]},this.ingredient={id:0,name:"",code:"",percentage:0,createdDate:new Date,supplierID:0,position:0,allow:0,voc:0,expiredTime:0,daysToExpiration:0,materialNO:"",unit:0,real:0,cbd:0},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.modelNameLeo=null,this.modelNoLeo=null,this.articleNoLeo=null,this.articleNoNewLeo=null,this.artProcessLeo=null,this.modelNameIDLeo=0,this.modelNoIDLeo=0,this.articleNoIDLeo=0,this.artProcessIDLeo=0,this.BPFCIDLeo=0,this.textSearch=null,this.ingredientGroupData=[[],[]],this.onFiltering=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelName=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringModelNameClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringArtProcessClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.artProcessDataClone,t)},this.dataSearch=this.dataService.currentMessage.subscribe(e=>{this.textSearch=e})}ngOnInit(){this.BPFCID=this.route.snapshot.params.id,this.tab=this.route.snapshot.params.tab,this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.GetDetailBPFC(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(e=>{200===e&&this.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}back(){this.router.navigate([`/ec/establish/bpfc-schedule/${this.tab}/${this.articleNoLeo}`])}ngOnDestroy(){this.dataService.changeMessages(this.textSearch),this.dataSearch.unsubscribe()}GetDetailBPFC(){this.BPFCID=this.route.snapshot.params.id,this.bPFCEstablishService.getDetailBPFC(this.BPFCID).subscribe(e=>{var t;const i=e[0];this.BPFCIDLeo=i.id,this.modelNameLeo=i.modelName,this.modelNoLeo=i.modelNo,this.articleNoLeo=i.articleNo,this.artProcessLeo=i.artProcess,this.articleNoNewLeo=i.articleNo,this.modelNameID=i.modelNameID,this.modelNoID=i.modelNoID,this.articleNoID=i.articleNoID,this.artProcessIDLeo="ASY"===i.artProcess?1:2,this.modelNameDetail=e[0].modelName,this.modelNameID=e[0].modelNameID,this.modelNoDetail=e[0].modelNo,this.articleNoDetail=e[0].articleNo,this.artProcessDetail=e[0].artProcess,this.modelNameIDClone=e[0].modelNameID,this.value=e[0].modelNameID,this.valuemodelNo=e[0].modelNoID,this.articleNoID=e[0].articleNoID,this.resetLifeCycleBPFC(),this.BPFCID=null===(t=e[0])||void 0===t?void 0:t.id,this.approvalStatus=e[0].approvalStatus,this.createdStatus=e[0].finishedStatus,localStorage.removeItem("details"),this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}onChangeProcessCloneModal(e){e.itemData&&(this.processID=e.itemData.id)}resetLifeCycleBPFC(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}onCreatedGridGlue(){}ngAfterViewInit(){$('[data-toggle="tooltip"]').tooltip();const e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}onChangeKindEdit(e){this.kindEdit=e.value,this.kindID=e.itemData.id}onChangePartEdit(e){this.partEdit=e.value,this.partID=e.itemData.id}onChangeMaterialEdit(e){this.kindEdit=e.value,this.materialID=e.itemData.id}dataBoundGlue(){this.gridglue.selectRows(this.selectedRow.length?this.selectedRow:this.selIndex)}actionBeginGlue(e){"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":`Consumption ${e.rowData.consumption}`,this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=`Consumption ${e.data.consumption}`,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{this.glueService.delete(e.data[0].id).subscribe(()=>{this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.removeLocalStore("details"),this.glueIngredientDetail=[],this.oldDetail=[],this.alertify.success("Glue has been deleted")},e=>{this.alertify.error("Failed to delete the Glue")})}))}rowDeselected(e){const t=e.rowIndex,i=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,i)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(e=>{if(this.modified=!0,this.gridglue.getSelectedRowIndexes().length){const e=this.gridglue.dataSource[t];e.name=e.chemical.name,this.gridglue.refresh()}}).catch(e=>{this.gridglue.selectRows([t])})}rowSelected(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);const t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}onChangePosition(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;const n=e.value;let s=this.getLocalStore("details");if(""===e.value);else{if(0!==s.length){let t="";switch(s[s.length-1].position){case"A":t="B";break;case"B":t="C";break;case"C":t="D";break;case"D":t="E"}if(n!==t)return this.alertify.warning(`H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 ${t}`,!0),this.grid.toArray().forEach(e=>e.refresh()),void(e.cancel=!0)}if(0===s.filter(t=>t.position===e.value).length&&null!==e.value)if(s=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==s.filter(e=>e.ingredientName===t.name&&e.position===t.position).length){const i=s.findIndex(e=>e.ingredientName===t.name);s[i].position=e.value,this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.toArray().forEach(e=>e.refresh())}else{s=this.getLocalStore("details");const i={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(i.percentage=100,i.expiredTime=t.expiredTime),s.push(i),this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.toArray().forEach(e=>e.refresh())}}}recordDoubleClick(e){this.modifiedGlue=!0}toolbarClickIngredient(e){e.item.id.includes("add")&&(e.cancel=!0,this.openIngredientModalComponent())}onDoubleClickIngredient(e){this.setFocus=e.column}rowSelectedIngredient(e){this.ingridientID=e.data.id}genaratorGlueCode(){this.glue.code=this.makeid(8)}makeid(e){let t="";const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length;for(let s=0;s<e;s++)t+=i.charAt(Math.floor(Math.random()*n));return t}compareArray(e,t){return JSON.stringify(e)===JSON.stringify(t)}setLocalStore(e,t){localStorage.removeItem(e);const i=JSON.stringify(t);localStorage.setItem(e,i)}getLocalStore(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}removeLocalStore(e){localStorage.removeItem(e)}dynamicSort(e){let t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),(i,n)=>-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}checkColorCode(e){return!0===e.approvalStatus&&!0===e.finishedStatus}checkDone(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}checkStatus(e,t){return!0===e&&!0===t?"Done":"Undone"}renderchemical(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}makeFormula(){var e,t;const i=this.getLocalStore("details").filter(e=>"A"===e.position)||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);const n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}formula(){return this.B&&this.C&&this.D&&this.E?`{[ (${this.nameGlue}+ ${this.B}) + ${this.C} ] + ${this.D}}+ ${this.E}`:this.B&&this.C&&this.D?`[(${this.nameGlue} + ${this.B}) + ${this.C}] + ${this.D}`:this.B&&this.C?`(${this.nameGlue} + ${this.B}) + ${this.C}`:this.B?`${this.nameGlue} + ${this.B}`:`${this.nameGlue}`}formulaTamp(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName=`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`,`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`):this.BB&&this.CC&&this.DD?(this.glueNewName=`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`,`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`):this.BB&&this.CC?(this.glueNewName=`(${this.nameGlues} + ${this.BB}) + ${this.CC}`,`(${this.nameGlues} + ${this.BB}) + ${this.CC}`):this.BB?(this.glueNewName=`${this.nameGlues} + ${this.BB}`,`${this.nameGlues} + ${this.BB}`):`${this.nameGlues}`}getDetail(e){this.glueIngredientService.getDetail(e).subscribe(e=>{var t,i,n,s;this.glueIngredientDetail=e.glueIngredients,this.setLocalStore("details",this.glueIngredientDetail),this.setLocalStore("detailsTamp",this.glueIngredientDetail),this.glueIngredientDetail=this.renderchemical(),this.oldDetail=this.renderchemical();const l=this.glueIngredientDetail.filter(e=>"A"===e.position)||[];this.nameGlue=(null===(t=l[0])||void 0===t?void 0:t.ingredientName)||"",this.nameGlues=(null===(i=l[0])||void 0===i?void 0:i.ingredientName)+"^"+(null===(n=this.glueIngredientDetail[0])||void 0===n?void 0:n.allow)+"%"||!1,this.A=(null===(s=l[0])||void 0===s?void 0:s.ingredientName)||"",void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCount.join("+"),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0)})}updateChemicalList(){const e=this.getLocalStore("details");for(const t of this.ingredientGroupData)for(const i of e){const e=t.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(t[e].position=i.position,t[e].percentage=i.percentage,t[e].allow=i.allow)}}actionBeginIngredient(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){const t=e.previousData,i=e.data;this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;const n=t.allow!==i.allow;if(t.percentage!==i.percentage){this.modified=!1;const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);if(t[i].percentage=e.data.percentage,this.setLocalStore("details",t),this.updateChemicalsV2(),this.gridglue.getSelectedRecords().length>0){const t=this.gridglue.getSelectedRecords()[0].glueIngredients;if(t.length>0){const i=t.findIndex(t=>t.ingredientID===e.data.id);t[i].percentage=e.data.percentage}}}if(n){const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);if(t[i].allow=e.data.allow,this.setLocalStore("details",t),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicalsV2(),this.gridglue.getSelectedRecords().length>0){const t=this.gridglue.getSelectedRecords()[0].glueIngredients;if(t.length>0){const i=t.findIndex(t=>t.ingredientID===e.data.id);t[i].allow=e.data.allow}}}}"delete"===e.requestType&&this.deleteIngredient()}updateGlueIngredient(){}loadPreview(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}resolver(){this.route.data.subscribe(e=>{this.glues=e.glues.result,this.paginationG=e.glues.pagination})}onService(){this.ingredientService.currentIngredient.subscribe(e=>{300===e&&(this.getIngredients(),this.updateChemicalList(),this.ingredientService.changeIngredient(0))})}mapGlue(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}getIngredients(){this.glueIngredientService.getIngredients(this.glueid).subscribe(e=>{this.ingredients1=e.result.list1,this.ingredients2=e.result.list2,this.ingredientGroupData=[],this.ingredientGroupData.push(e.result.list1,e.result.list2)},e=>{this.alertify.error(e)})}getGlues(){this.glueService.getAllGlue().subscribe(e=>{this.glues=e},e=>{this.alertify.error(e)})}mapGlueIngredients(e){this.glueIngredientService.mapGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid))})}mapGlueIngredient(e){this.glueIngredientService.mappGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.getAllGluesByBPFCID(this.BPFCID),this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid),this.getAllGluesByBPFCID(this.BPFCID))})}openIngredientModalComponent(){const e=this.modalService.open(X.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(e=>{},e=>{})}actionCompleteIngredient(e){}openPopupDropdownlist(){$('[data-toggle="tooltip"]').tooltip()}toolbarClick(e){switch(e.item.text){case"Add New":const t=this.getLocalStore("details").sort(this.dynamicSort("position"));if(!1===this.compareArray(this.oldDetail,t)&&t.length>0&&this.oldDetail.length>0)this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(e=>{const t={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=t,this.saveGlue()}).catch(t=>{e.cancel=!0});else{const e={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=e,this.saveGlue()}}}openModal(e){this.modalReference=this.modalService.open(e)}openModalHistory(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}LoadHistoryBPFC(){this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(e=>{this.historyData=e.map(e=>({id:e.id,glueID:e.glueID,createdTime:e.createdTime,bpfcEstablishID:e.bpfcEstablishID,before:e.before,after:e.after,action:e.action,remark:e.remark,userID:e.userID,createdBy:this.createdBy(e.userID)}))})}actionBeginHistory(e){"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(e=>{e&&this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}getAllUsers(){this.buildingUserService.getAllUsers(1,1e3).subscribe(e=>{this.userData=e.result})}createdBy(e){if(0===e)return"#N/A";const t=this.userData.filter(t=>t.ID===e)[0];return void 0!==t?t.Username:"#N/A"}cloneModelname(){this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",()=>{this.modalNameService.cloneModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.valueProcess).subscribe(e=>{this.alertify.success("the model name has been cloned"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}cloneArticleModelname(){this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",()=>{this.modalNameService.cloneArticleModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.articleName,this.processID).subscribe(e=>{this.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}delete(e,t){this.glueIngredientService.delete(e,t).subscribe(t=>{this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),this.getIngredients(),this.getDetail(e)})}deleteGlue(e){this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.glueService.delete(e.id).subscribe(()=>{this.getGlues(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}deleteIngridient(e){this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.ingredientService.delete(e.id).subscribe(()=>{this.getIngredients(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}getAllGluesByBPFCID(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{this.glues=e})}getAllGluesByBPFCID2(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{void 0===this.ingredientID?(this.glues=e,e.length>0&&(this.detailGlue=!0)):(this.glueid=e[0].id,this.glueIngredient2.ingredientID=this.ingredientID,this.glueIngredient2.percentage=100,this.glueIngredient2.glueID=this.glueid,this.glueIngredient2.position="A",this.mapGlueIngredient(this.glueIngredient2))})}updateChemicals(){this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2;const t=this.getLocalStore("details");for(const i of t){const e=this.ingredients1.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients1[e].position=i.position,this.ingredients1[e].percentage=i.percentage,this.ingredients1[e].allow=i.allow)}for(const i of t){const e=this.ingredients2.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients2[e].position=i.position,this.ingredients2[e].percentage=i.percentage,this.ingredients2[e].allow=i.allow)}this.glueIngredientDetail=t,this.makeFormula()})}updateChemicalsV2(){this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(e=>{const t=e.list1,i=e.list2,n=this.getLocalStore("details");for(const s of n){const e=t.findIndex(e=>e.name===s.ingredientName&&e.id===s.ingredientID);-1!==e&&(t[e].position=s.position,t[e].percentage=s.percentage,t[e].allow=s.allow)}for(const s of n){const e=i.findIndex(e=>e.name===s.ingredientName&&e.id===s.ingredientID);-1!==e&&(i[e].position=s.position,i[e].percentage=s.percentage,i[e].allow=s.allow)}this.ingredientGroupData=[],this.ingredientGroupData.push(t,i),this.glueIngredientDetail=n,this.makeFormula()})}sortBySup(e){0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(t=>{let i=t.list1;const n=t.list2;if(this.ingredientGroupData=[],this.ingredientGroupData.push(i,n),0===e){const e=this.getLocalStore("details");i=e.map(e=>({id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,cbd:e.cbd})),this.ingredientGroupData=[],this.ingredientGroupData.push(i),this.glueIngredientDetail=e}else this.updateChemicalList()}))}saveGlue(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}getBuilding(){JSON.parse(localStorage.getItem("user"))}getAllIngredient(){this.ingredientService.getAllIngredient().subscribe(e=>{this.ingrediented=e})}createGlue(){this.glueService.create(this.glue).subscribe(()=>{this.alertify.success("\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.clearGlueForm(),this.genaratorGlueCode(),this.expiredTime=0},e=>{this.alertify.error(e),this.genaratorGlueCode()})}finished(){const e=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=e,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{});const t=this.getLocalStore("details"),i=this.gridglue.getSelectedRecords()[0];i.expiredTime=t.filter(e=>"A"===e.position)[0].expiredTime,i.kindID=0===i.kindID?null:i.kindID,i.partID=0===i.partID?null:i.partID,i.materialID=0===i.materialID?null:i.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),this.glueService.update(i).subscribe(e=>{this.alertify.success("Update sucessfully!<br>C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!0,this.modified=!0}),t.length>0&&(this.mapGlueIngredients(t),this.modified=!0)}}clearGlueForm(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}update(){this.glueService.update(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.history.Action="Created",this.expiredTime=0})}updateChemical(){this.glueService.updateChemical(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.onChangeChemical=!1,this.history.Action="Created"})}deleteIngredient(){this.ingredientService.delete(this.ingridientID).subscribe(()=>{const e=this.getLocalStore("details").filter(e=>e.ingredientID!==this.ingridientID);this.setLocalStore("details",e),this.glueIngredientDetail=e,this.getIngredients(),this.makeFormula(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}approval(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const l of e){if("STF"===this.artProcessDetail&&null===l.kindID)return this.alertify.warning("Please maintain the kind!<br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind!<br>\n          <br>\n              ",!0),void(this.approvalStatus=!this.approvalStatus);if(l.glueIngredients.length>0){const e=l.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0&&"A"!==n.position)return t=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The allowance of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);if(n.percentage<=0&&"A"!==n.position)return i=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);t=!0,i=!0}}if(+l.consumption<=0)return n=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The consumption of glue name ${l.name} must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${l.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${l.name} <br>\n          `,!0);n=!0}const s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(e=>{this.alertify.success("The BPFC has been approved!"),this.createdStatus=this.approvalStatus;const t=this.modelNameDropdownlist.getDataByValue(this.modelNameDropdownlist.value);this.modelNameDropdownlist.valueTemplate=`(${this.checkStatus(this.approvalStatus,this.createdStatus)}) ${t.name}`})}}done(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const s of e){if("STF"===this.artProcessDetail&&null===s.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.createdStatus=!this.createdStatus);if(s.glueIngredients.length>0){const e=s.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0)return t=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The allow of checmical name ${n.ingredient.name} is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);if(n.percentage<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);t=!0,i=!0}0===e.length&&(t=!0,i=!0)}if(+s.consumption<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The consumption of glue name ${s.name} is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${s.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${s.name} <br>\n          `,!0);n=!0}if(t&&i&&n){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,e).subscribe(e=>{!0===e.status?(this.alertify.success(e.message),this.createdStatus=this.createdStatus):this.alertify.success(e.message)})}}}getModelNames(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameData=e.map(e=>({id:e.id,name:e.name}))})}getArticleNoByModelNameID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNoData=e})}getModelNoByModelNameID(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNoData=e})}getArtProcessByArticleNoID(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessData=e.map(e=>({id:e.id,name:1===e.processID?"ASY":"STF"}))})}getAllProcess(){this.artProcessService.GetAllProcess().subscribe(e=>{this.artProcessDataClone2=e})}getAllKind(){this.kindService.getAllKind().subscribe(e=>{this.kinds=e})}getAllPart(){this.partService.getAllPart().subscribe(e=>{this.parts=e})}getAllMaterial(){this.materialService.getAllMaterial().subscribe(e=>{this.materials=e})}getIngredientsByGlueID(){this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2})}getAllSupllier(){this.ingredientService.getAllSupplier().subscribe(e=>{this.supplier=e})}getArticleNoByModelNoID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosData=e})}getBPFCID(e){this.bPFCEstablishService.getBPFCID(e).subscribe(e=>{this.resetLifeCycleBPFC(),this.BPFCID=null==e?void 0:e.id,this.approvalStatus=e.approvalStatus,this.createdStatus=e.finishedStatus,this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}OndataBound(e){}getModelNamesClone(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameDataClone=e.map(e=>({id:e.id,name:e.name})),this.getModelNoByModelNameIDClone(this.modelNameIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]})}getArticleNoByModelNameIDClone(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosDataClone=e})}getModelNoByModelNameIDClone(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}getArtProcessByArticleNoIDClone(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessDataClone=e.map(e=>({id:e.id,name:1===e.ProcessID?"ASY":"STF"}))})}onChangeModelName(e){this.resetLifeCycleBPFC(),this.modelNameID=e.value,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}onChangeModelNo(e){e.isInteracted&&(this.modelNoID=e.value,this.valuemodelNo=e.value,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}onChangeArticleNo(e){e.isInteracted&&(this.articleNoID=e.value,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}onClickProcess(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue))}ClickProcessData(e){}clearFormClone(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}onClickClone(){const e={modelNameID:this.modelNameIDLeo,modelNOID:this.modelNoIDLeo,articleNOID:this.articleNoIDLeo,artProcessID:Number(this.artProcessIDLeo),bpfcID:this.BPFCIDLeo,name:this.articleNoNewLeo,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}clone(e){this.articleNoNewLeo!==this.articleNoLeo?this.modalNameService.cloneBPFC(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalService.dismissAll(),this.getAllUsers()):this.alertify.error("The BPFC exists!")}):this.alertify.error("The BPFC exists!")}onChangeModelNameClone(e){this.value!==e.value&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}onChangeModelNoClone(e){this.modelNOIDClone=e.value,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}onChangeArticleNoClone(e){e.isInteracted&&(this.articleNOIDClone=e.value,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}onChangeProcessClone(e){e.isInteracted&&(this.artProcessIDClone=e.value)}changeAllowColor(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changePercentageColor(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changeConsumptionColor(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}return e.\u0275fac=function(t){return new(t||e)(M.Pb(J),M.Pb(U.a),M.Pb(R.a),M.Pb(E.a),M.Pb(c.b),M.Pb(B.a),M.Pb(B.c),M.Pb(Q.a),M.Pb(F.a),M.Pb(H),M.Pb(K),M.Pb(W.a),M.Pb(q.a),M.Pb(z.a),M.Pb(k.a),M.Pb(_),M.Pb(L.a),M.Pb(x.a))},e.\u0275cmp=M.Jb({type:e,selectors:[["app-bpfc-detailv2"]],viewQuery:function(e,t){if(1&e&&(M.Rc(Wi,1),M.Rc(qi,1),M.Rc(zi,1),M.Rc(Xi,1),M.Rc(Yi,1),M.Rc(Zi,1),M.Rc(en,1),M.Rc(tn,1),M.Rc(nn,1)),2&e){let e;M.Ac(e=M.gc())&&(t.doneSwitch=e.first),M.Ac(e=M.gc())&&(t.approvalSwitch=e.first),M.Ac(e=M.gc())&&(t.gridglue=e.first),M.Ac(e=M.gc())&&(t.grid2=e.first),M.Ac(e=M.gc())&&(t.modelNameDropdownlist=e.first),M.Ac(e=M.gc())&&(t.modelNoDropdownlist=e.first),M.Ac(e=M.gc())&&(t.chemicalDropdownlist=e.first),M.Ac(e=M.gc())&&(t.grid=e),M.Ac(e=M.gc())&&(t.positionDropdownlist=e)}},features:[M.Bb([C.n,C.f,C.k])],decls:47,vars:10,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["type","text","name","","disabled","","title","",1,"form-control",3,"value"],[1,"col-md-1","mt-2"],["type","button",1,"btn","btn-danger","rounded-pill"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],["class","card-header-actions",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["HistoryModal",""],["cloneModal",""],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],[1,"card-header-actions"],["type","button","ejs-button","","cssClass","e-small e-primary mr-2",3,"click"],[1,"fas","fa-backward"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],["appPermission","","appFunction","BPFC Schedule","appAction","DONE",2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","checked","click","checkedChange"],["doneSwitch",""],["appPermission","","appFunction","BPFC Schedule","appAction","APPROVAL","onLabel","Approved",2,"width","120px",3,"offLabel","checked","click","checkedChange"],["approvalSwitch",""],["type","button","appPermission","","appFunction","BPFC Schedule","appAction","FINISH","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[4,"ngIf"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","bg-gradient-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],["class","col-md-6",4,"ngFor","ngForOf"],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","","title","",1,"form-control",3,"ngModel","value","ngModelChange"]],template:function(e,t){1&e&&(M.Vb(0,"div",0),M.Vb(1,"div",1),M.Vb(2,"div",2),M.Vb(3,"div",3),M.Vb(4,"div",0),M.Vb(5,"div",4),M.Vb(6,"label"),M.Lc(7,"Model Name: "),M.Ub(),M.Ub(),M.Vb(8,"div",5),M.Qb(9,"input",6),M.Ub(),M.Ub(),M.Vb(10,"div",0),M.Vb(11,"div",4),M.Vb(12,"label"),M.Lc(13,"Model NO: "),M.Ub(),M.Ub(),M.Vb(14,"div",5),M.Qb(15,"input",6),M.Ub(),M.Ub(),M.Vb(16,"div",0),M.Vb(17,"div",4),M.Vb(18,"label"),M.Lc(19,"Article NO: "),M.Ub(),M.Ub(),M.Vb(20,"div",5),M.Qb(21,"input",6),M.Ub(),M.Qb(22,"div",7),M.Ub(),M.Vb(23,"div",0),M.Vb(24,"div",4),M.Vb(25,"label"),M.Lc(26,"Process: "),M.Ub(),M.Ub(),M.Vb(27,"div",5),M.Vb(28,"button",8),M.Lc(29),M.Ub(),M.Ub(),M.Qb(30,"div",7),M.Ub(),M.Ub(),M.Ub(),M.Vb(31,"div",2),M.Vb(32,"div",9),M.Jc(33,bn,32,5,"div",10),M.Ub(),M.Ub(),M.Ub(),M.Vb(34,"div",11),M.Vb(35,"div",2),M.Vb(36,"div",12),M.Lc(37),M.kc(38,"translate"),M.Jc(39,pn,22,18,"div",13),M.Ub(),M.Jc(40,Un,10,6,"div",14),M.Ub(),M.Ub(),M.Jc(41,En,27,5,"ng-template",null,15,M.Kc),M.Jc(43,Ln,24,6,"ng-template",null,16,M.Kc),M.Ub(),M.Jc(45,$n,42,5,"ng-template",null,17,M.Kc)),2&e&&(M.Cb(9),M.pc("value",t.modelNameDetail),M.Cb(6),M.pc("value",t.modelNoDetail),M.Cb(6),M.pc("value",t.articleNoDetail),M.Cb(8),M.Mc(t.artProcessDetail),M.Cb(4),M.pc("ngIf",t.existGlue),M.Cb(4),M.Nc(" ",M.lc(38,8,"PREVIEW")," "),M.Cb(2),M.pc("ngIf",t.existGlue),M.Cb(1),M.pc("ngIf",t.existGlue))},directives:[s.n,C.j,h.d,v.d,v.b,C.e,C.b,h.c,v.c,v.a,C.d,C.a,r.c,l.f,l.i,u.b,u.k,oi.a,s.m,l.a,s.l],pipes:[p.c,s.e],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{animation:warning-frames .5s infinite;color:#000}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),e})();const Tn=[{path:"",children:[{path:"bpfc-schedule",data:{title:"bpfc-schedule",breadcrumb:"BPFC Schedule",functionCode:"BPFC Schedule"},canActivate:[A.a],children:[{path:"",component:vi},{path:":tab",data:{title:"bpfc-schedule",breadcrumb:"BPFC Schedule",functionCode:"BPFC Schedule"},component:vi},{path:":tab/:keySearch",data:{title:"bpfc-schedule",breadcrumb:"BPFC Schedule",functionCode:"BPFC Schedule"},component:vi},{path:":tab/detail",data:{title:"Detail",breadcrumb:"Detail",functionCode:"BPFC Schedule"},children:[{path:"",component:ii},{path:":id",component:ii}]},{path:":tab/detailv2",data:{title:"Detail",breadcrumb:"Detail",functionCode:"BPFC Schedule"},children:[{path:"",component:Gn},{path:":id",component:Gn}]}]},{path:"bpfc-status",component:_i,data:{title:"BPFC Status",breadcrumb:"BPFC Status",functionCode:"BPFC Status"},canActivate:[A.a]},{path:"bpfc-1",component:tt,data:{title:"BPFC ",breadcrumb:"BPFC",functionCode:"BPFC"},canActivate:[A.a]}]}];let On,jn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=M.Nb({type:e}),e.\u0275inj=M.Mb({imports:[[B.g.forChild(Tn)],B.g]}),e})();function Jn(e){return new f.a(e,"./assets/i18n/",".json")}const Rn=localStorage.getItem("lang");Object(N.bb)(i("2PVe"),i("GFvd"),i("GFWS"),i("0zpJ"),i("LRxf")),Object(N.bb)(i("2PVe"),i("oP7I"),i("Joj5"),i("3JeS"),i("LRxf")),On="vi"===Rn?Rn:"en";let Kn=(()=>{class e{constructor(){"vi"===Rn?(On="vi",setTimeout(()=>{N.p.load(i("+7Wi")),Object(N.nb)("vi")})):(On="en",setTimeout(()=>{N.p.load(i("7j5C")),Object(N.nb)("en")}))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=M.Nb({type:e}),e.\u0275inj=M.Mb({providers:[s.e],imports:[[P.b,u.c,s.c,l.b,l.l,a.b,jn,o.a,r.d,c.c,h.b,h.a,h.e,d.a,d.c,d.b,u.l,m.a,g.b,v.h,C.i,u.i,D.d,w.b,I.a,g.d,y.a,S.e,u.f,r.g,n.a,p.b.forChild({loader:{provide:p.a,useFactory:Jn,deps:[b.b]},defaultLanguage:On})]]}),e})()},NkNT:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("x+4Q"),s=i("8Y7J"),l=i("iInd");let a=(()=>{class e{constructor(e,t,i){this.el=e,this.route=t,this.authService=i}ngOnInit(){if(this.authService.loggedIn()){const e=JSON.parse(localStorage.getItem("functions")).map(e=>e.childrens),t=this.route.snapshot.data.functionCode,i=[].concat.apply([],e).filter(e=>e.functionCode===t);this.el.nativeElement.style.display=i&&i.filter(e=>e.functionCode===this.appFunction&&e.code===this.appAction).length>0?"":"none"}else this.el.nativeElement.style.display="none"}}return e.\u0275fac=function(t){return new(t||e)(s.Pb(s.l),s.Pb(l.a),s.Pb(n.a))},e.\u0275dir=s.Kb({type:e,selectors:[["","appPermission",""]],inputs:{appFunction:"appFunction",appAction:"appAction"}}),e})()},dQqK:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("iStF");class s{constructor(){this.editSettingsTree={allowEditing:!1,allowAdding:!1,allowDeleting:!1,newRowPosition:"Child",mode:"Row"},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=["ExcelExport","Add","Edit","Delete","Cancel","Search"],this.toolbarOptionsTree=["Add","Delete","Search","ExpandAll","CollapseAll","ExcelExport"],this.contextMenuItems=[{text:"Add Child",iconCss:" e-icons e-add",target:".e-content",id:"Add-Sub-Item"},{text:"Delete",iconCss:" e-icons e-delete",target:".e-content",id:"DeleteOC"}]}Permission(e){const t=e.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(e=>e.functionCode===t)||[];for(const i of this.functions){const e=[];for(const n of i.childrens){const t=this.makeAction(n.code);e.push(...t.filter(Boolean))}e.push("Search");const t=e.filter((e,t,i)=>t===i.indexOf(e));this.toolbarOptions=t}}PermissionForTreeGrid(e){this.contextMenuItems=[],this.functions=JSON.parse(localStorage.getItem("functions"));for(const t of this.functions)if(e.snapshot.data.functionCode.includes(t.functionCode)){const e=[];for(const n of t.childrens){const t=this.makeActionTreeGrid(n.code);e.push(...t.filter(Boolean))}e.push("Search","ExpandAll","CollapseAll","ExcelExport");const i=e.filter((e,t,i)=>t===i.indexOf(e));this.toolbarOptionsTree=i;break}}makeAction(e){switch(e){case n.a.CREATE:return this.editSettings.allowAdding=!0,["Add","Cancel"];case n.a.EDIT:return this.editSettings.allowEditing=!0,["Edit","Update","Cancel"];case n.a.DELETE:return this.editSettings.allowDeleting=!0,["Delete"];case n.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}makeActionTreeGrid(e){switch(e){case n.a.EXCEL_EXPORT:return["ExcelExport"];case n.a.CREATE:return this.editSettingsTree.allowAdding=!0,this.contextMenuItems.push({text:"Add Child",iconCss:" e-icons e-add",target:".e-content",id:"Add-Sub-Item"}),["Add"];case n.a.EDIT:return this.editSettingsTree.allowEditing=!0,[void 0];case n.a.DELETE:return this.editSettingsTree.allowDeleting=!0,this.contextMenuItems.push({text:"Delete",iconCss:" e-icons e-delete",target:".e-content",id:"DeleteOC"}),[void 0];default:return[void 0]}}}},"h9f+":function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("2Vo4"),s=i("lJxs"),l=i("IheW"),a=i("AytR"),o=i("2zK7"),r=i("8Y7J");new l.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});let c=(()=>{class e{constructor(e){this.http=e,this.baseUrl=a.a.apiUrlEC,this.authUrl=a.a.apiUrl,this.messageSource=new n.a(0),this.currentMessage=this.messageSource.asObservable()}changeMessage(e){this.messageSource.next(e)}getBuildingsAsTreeView(){return this.http.get(`${this.baseUrl}Building/GetAllAsTreeView`)}mappingUserWithBuilding(e){return this.http.post(`${this.baseUrl}BuildingUser/MappingUserWithBuilding`,e)}removeBuildingUser(e){return this.http.post(`${this.baseUrl}BuildingUser/RemoveBuildingUser`,e)}getAllUsers(e,t){const i=new o.a;return this.http.get(`${this.authUrl}Users/GetAllUsers/${a.a.systemCode}/${e}/${t}`,{observe:"response"}).pipe(Object(s.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}deleteUser(e){return this.http.delete(`${this.authUrl}Users/Delete/${e}`)}updateUser(e){return this.http.post(`${this.authUrl}Users/Update`,e)}createUser(e){return this.http.post(`${this.authUrl}Users/Create`,e)}getAllBuildingUsers(){return this.http.get(`${this.baseUrl}BuildingUser/getAllBuildingUsers`)}getBuildingUserByBuildingID(e){return this.http.get(`${this.baseUrl}BuildingUser/GetBuildingUserByBuildingID/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(r.cc(l.b))},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},vrRs:function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("IheW"),s=i("2Vo4"),l=i("lJxs"),a=i("AytR"),o=i("2zK7"),r=i("8Y7J");new n.e({"Content-Type":"application/json"});let c=(()=>{class e{constructor(e){this.http=e,this.baseUrl=a.a.apiUrlEC,this.ingredientSource=new s.a(0),this.currentIngredient=this.ingredientSource.asObservable()}getIngredients(e,t){const i=new o.a;let s=new n.f;return null!=e&&null!=t&&(s=s.append("pageNumber",e),s=s.append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/getingredients",{observe:"response",params:s}).pipe(Object(l.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}search(e,t,i){const s=new o.a;let a=new n.f;return null!=e&&null!=t&&(a=a.append("pageNumber",e),a=a.append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/Search/"+i,{observe:"response",params:a}).pipe(Object(l.a)(e=>(s.result=e.body,null!=e.headers.get("Pagination")&&(s.pagination=JSON.parse(e.headers.get("Pagination"))),s)))}getAllIngredient(){return this.http.get(this.baseUrl+"ingredient/GetAll",{})}rate(){return this.http.get(this.baseUrl+"ingredient/Rate",{})}getAllGlueType(){return this.http.get(this.baseUrl+"ingredient/GetAllGlueType",{})}getByID(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/"+e,{})}scanQRCode(e){return this.http.get(this.baseUrl+"ingredient/ScanQRCode/"+e,{})}scanQRCodeFromChemicalWareHouse(e,t,i){return this.http.get(`${this.baseUrl}ingredient/ScanQRCodeFromChemialWareHouse/${e}/${t}/${i}`,{})}scanQRCodeOutput(e,t,i){return this.http.get(`${this.baseUrl}ingredient/ScanQRCodeOutput/${e}/${t}/${i}`,{})}getAllSupplier(){return this.http.get(this.baseUrl+"Suppier/GetAll",{})}getAllIngredientInfo(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfo",{})}getAllIngredientInfoOutput(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutPut",{})}getAllIngredientInfoByBuildingName(e){return this.http.get(this.baseUrl+`ingredient/GetAllIngredientInfoByBuildingName/${e}`,{})}getAllIngredientInfoReport(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReport",{})}getAllIngredientInfoReportByBuildingName(e){return this.http.get(this.baseUrl+`ingredient/GetAllIngredientInfoReportByBuildingName/${e}`,{})}searchInventory(e,t){return this.http.get(`${this.baseUrl}ingredient/Search/${e}/${t}`,{})}searchInventoryByBuildingName(e,t,i){return this.http.get(`${this.baseUrl}ingredient/SearchWithBuildingName/${e}/${t}/${i}`,{})}deleteIngredientInfo(e,t,i,n){return this.http.delete(this.baseUrl+`ingredient/DeleteIngredientInfo/${e}/${t}/${i}/${n}`)}UpdateConsumption(e,t,i){return this.http.post(this.baseUrl+`ingredient/UpdateConsumptionIngredientReport/${e}/${t}/${i}`,{})}UpdateConsumptionOfBuilding(e){return this.http.post(this.baseUrl+"ingredient/UpdateConsumptionOfBuildingIngredientReport",e)}createSub(e){return this.http.post(this.baseUrl+"suppier/create",e)}updateSub(e){return this.http.put(this.baseUrl+"suppier/update",e)}deleteSub(e){return this.http.delete(this.baseUrl+"suppier/delete/"+e)}sortBySup(e,t){return this.http.get(this.baseUrl+`GlueIngredient/GetIngredientsByGlueID/${e}/${t}`)}getIngredientsByGlueID(e){return this.http.get(this.baseUrl+`GlueIngredient/GetIngredientsByGlueID/${e}`)}create(e){return this.http.post(this.baseUrl+"ingredient/create1",e)}update(e){return this.http.put(this.baseUrl+"ingredient/update",e)}delete(e){return this.http.delete(this.baseUrl+"ingredient/delete/"+e)}changeIngredient(e){this.ingredientSource.next(e)}import(e,t){const i=new FormData;return i.append("UploadedFile",e),i.append("CreatedBy",t),this.http.post(this.baseUrl+"ingredient/Import",i)}downloadFile(){return this.http.post(this.baseUrl+"ingredient/ExcelExport",{})}GetQrcodeByid(e){return this.http.get(this.baseUrl+`ingredient/GetbyID/${e}`)}UpdatePrint(e){return this.http.put(this.baseUrl+"ingredient/UpdatePrint",e)}checkIncoming(e,t,i){return this.http.get(`${this.baseUrl}ingredient/CheckIncoming/${e}/${t}/${i}`,{})}getAllIngredientInfoByBuilding(e){return this.http.get(this.baseUrl+`ingredient/GetAllIngredientInfoByBuilding/${e}`,{})}getAllIngredientInfoOutputByBuilding(e){return this.http.get(this.baseUrl+`ingredient/GetAllIngredientInfoOutputByBuilding/${e}`,{})}}return e.\u0275fac=function(t){return new(t||e)(r.cc(n.b))},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);