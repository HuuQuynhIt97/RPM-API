!function(){function e(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==i.return||i.return()}finally{if(c)throw o}}}}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=d(e);if(t){var a=d(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{bBuA:function(n,i,r){"use strict";r.r(i),r.d(i,"HttpLoaderFactory",function(){return rt}),r.d(i,"ReportModule",function(){return ct});var c=r("xxV/"),s=r("SVse"),d=r("s7LF"),g=r("7g+E"),h=r("wTG2"),f=r("PDtH"),p=r("G0yt"),b=r("wpBH"),m=r("WWtw"),v=r("sWsm"),y=r("10VE"),D=r("Uc7L"),C=r("IheW"),w=r("TSSN"),k=r("k5Gf"),S=r("e7Im"),x=r("KeVr"),U=r("emFE"),I=r("4SUy"),B=r("BrIm"),A=r("4DqM"),E=r("pQl/"),N=r("OoJn"),L=r("bwdU"),M=r("iInd"),T=r("vpVc"),V=r("mrSG"),O=r("dQqK"),P=r("0go6"),R=r("h9f+"),j=r("iStF"),F=r("8Y7J"),J=["grid"];function Q(e,t){if(1&e&&F.Lc(0),2&e){var n=t.$implicit,i=F.jc();F.Nc(" ",i.NO(n.index)," ")}}function _(e,t){1&e&&F.Lc(0),2&e&&F.Nc("",t.$implicit.qty," kg")}var Y,G=((Y=function(n){l(r,n);var i=u(r);function r(e,t,n){var o;return a(this,r),(o=i.call(this)).makeGlueService=e,o.buildingUserService=t,o.route=n,o.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},o}return o(r,[{key:"ngOnInit",value:function(){this.Permission(this.route),this.filterSettings={type:"Excel"},this.loadData()}},{key:"Permission",value:function(n){var i=n.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var a,r=t(this.functions);try{for(r.s();!(a=r.n()).done;){var o,l=a.value,c=[],u=t(l.childrens);try{for(u.s();!(o=u.n()).done;){var s=o.value,d=this.makeAction(s.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(h){u.e(h)}finally{u.f()}c.push("Search");var g=c.filter(function(e,t,n){return t===n.indexOf(e)});this.toolbarOptions=g}}catch(h){r.e(h)}finally{r.f()}}},{key:"makeAction",value:function(e){switch(e){case j.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}},{key:"toolbarClick",value:function(e){switch(e.item.id){case"grid_excelexport":this.grid.excelExport()}}},{key:"getUsers",value:function(){var e=this;return new Promise(function(t,n){e.buildingUserService.getAllUsers(1,1e3).subscribe(function(n){var i=n.result.map(function(e){return{ID:e.ID,EmployeeID:e.EmployeeID,Email:e.Email}});e.users=i,t(!0)},function(e){n(!1)})})}},{key:"username",value:function(e){var t;return(null===(t=this.users.find(function(t){return t.ID===e}))||void 0===t?void 0:t.EmployeeID)||"#N/A"}},{key:"loadData",value:function(){return Object(V.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getUsers();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.deliveredHistory();case 6:e.next=10;break;case 8:e.prev=8,e.t1=e.catch(0);case 10:case"end":return e.stop()}},e,this,[[0,8]])}))}},{key:"deliveredHistory",value:function(){var e=this;this.makeGlueService.deliveredHistory().subscribe(function(t){e.data=t.map(function(t){return{glueName:t.glueName,buildingName:t.buildingName,qty:t.qty,deliveredBy:e.username(t.createdBy),createdDate:new Date(t.createdDate)}})},function(){console.log("500 (Internal Server Error)")})}},{key:"NO",value:function(e){return(this.grid.pageSettings.currentPage-1)*this.grid.pageSettings.pageSize+Number(e)+1}}]),r}(O.a)).\u0275fac=function(e){return new(e||Y)(F.Pb(P.a),F.Pb(R.a),F.Pb(M.a))},Y.\u0275cmp=F.Jb({type:Y,selectors:[["app-delivered-history"]],viewQuery:function(e,t){var n;1&e&&F.Rc(J,1),2&e&&F.Ac(n=F.gc())&&(t.grid=n.first)},features:[F.Bb([U.g]),F.zb],decls:15,vars:6,consts:[[1,"card"],[1,"card-body"],["gridLines","Both","id","grid","allowFiltering","true","allowPaging","true","allowResizing","true","showColumnMenu","true",3,"dataSource","allowSorting","allowExcelExport","filterSettings","pageSettings","toolbar","toolbarClick"],["grid",""],["field","#","textAlign","Center","headerText","#","width","40"],["template",""],["field","glueName","textAlign","Center","headerText","Glue","width","100"],["field","buildingName","textAlign","Center","headerText","Line","width","130"],["field","qty","textAlign","Center","headerText","Qty","width","100"],["field","deliveredBy","textAlign","Center","headerText","Delivered By","width","150"],["field","createdDate","textAlign","Center","type","dateTime","format","d MMM, yyyy HH:mm","headerText","Delivered Date","width","150"]],template:function(e,t){1&e&&(F.Vb(0,"div",0),F.Vb(1,"div",1),F.Vb(2,"ejs-grid",2,3),F.fc("toolbarClick",function(e){return t.toolbarClick(e)}),F.Vb(4,"e-columns"),F.Vb(5,"e-column",4),F.Jc(6,Q,1,1,"ng-template",null,5,F.Kc),F.Ub(),F.Qb(8,"e-column",6),F.Qb(9,"e-column",7),F.Vb(10,"e-column",8),F.Jc(11,_,1,1,"ng-template",null,5,F.Kc),F.Ub(),F.Qb(13,"e-column",9),F.Qb(14,"e-column",10),F.Ub(),F.Ub(),F.Ub(),F.Ub()),2&e&&(F.Cb(2),F.pc("dataSource",t.data)("allowSorting",!0)("allowExcelExport",!0)("filterSettings",t.filterSettings)("pageSettings",t.pageSettings)("toolbar",t.toolbarOptions))},directives:[U.j,m.d,A.d,A.b,U.e,U.b,m.c,A.c,A.a,U.d,U.a],styles:[""]}),Y),q=r("HJFG"),K=r("vrRs"),z=r("H552"),H=r("wsp1"),W=r("XNiG"),$=r("j7qE"),X=["ingredientinforeportGrid"];function Z(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"TIME_LABEL")," ")}function ee(e,t){1&e&&(F.Lc(0),F.kc(1,"date")),2&e&&F.Nc(" ",F.mc(1,1,t.$implicit.createdTime,"dd MMM, yyyy , HH:mm")," ")}function te(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"SUPPLIER")," ")}function ne(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"INGREDIENT_LABEL")," ")}function ie(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"PRODUCTION_DATE_LABEL")," ")}function ae(e,t){1&e&&(F.Lc(0),F.kc(1,"date")),2&e&&F.Nc(" ",F.mc(1,1,t.$implicit.manufacturingDate,"dd MMM, yyyy")," ")}function re(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"BATCH_LABEL")," ")}function oe(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"EXPIRED_DATE_LABEL")," ")}function le(e,t){1&e&&(F.Lc(0),F.kc(1,"date")),2&e&&F.Nc(" ",F.mc(1,1,t.$implicit.expiredTime,"dd MMM, yyyy")," ")}function ce(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"QTY_LABEL")," ")}function ue(e,t){1&e&&F.Lc(0),2&e&&F.Nc(" ",t.$implicit.qty," Kg ")}function se(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"CONSUMPTION_LABEL")," ")}function de(e,t){1&e&&F.Lc(0),2&e&&F.Nc(" ",t.$implicit.consumption," Kg ")}var ge,he=((ge=function(n){l(r,n);var i=u(r);function r(e,t,n,o,l,c){var u;return a(this,r),(u=i.call(this)).modalService=e,u.ingredientService=t,u.buildingService=n,u.authService=o,u.alertify=l,u.route=c,u.startDate=new Date,u.endDate=new Date,u.role=JSON.parse(localStorage.getItem("level")),u.building=JSON.parse(localStorage.getItem("building")),u.pageSettings={pageCount:20,pageSizes:!0,pageSize:20},u.filterSettings={type:"Excel"},u.fieldsBuildings={text:"name",value:"id"},u.data=[],u.ingredients=[],u.IsAdmin=!1,u.subject=new W.a,u.subscription=[],u.onFilteringBuilding=function(e){var t=new z.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(u.buildings,t)},u}return o(r,[{key:"ngOnInit",value:function(){this.Permission(this.route),this.checkRole()}},{key:"checkRole",value:function(){var e=this,t=+localStorage.getItem("buildingID");this.getBuilding(0===t?function(){e.alertify.message("Please select a building! <br> Vui l\xf2ng ch\u1ecdn 1 t\xf2a nh\xe0!",!0)}:function(){e.buildingID=t})}},{key:"getBuilding",value:function(e){var t=this,n=+JSON.parse(localStorage.getItem("user")).user.id;this.authService.getBuildingUserByUserID(n).subscribe(function(n){t.buildings=n.data,e()})}},{key:"Permission",value:function(n){var i=n.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var a,r=t(this.functions);try{for(r.s();!(a=r.n()).done;){var o,l=a.value,c=[],u=t(l.childrens);try{for(u.s();!(o=u.n()).done;){var s=o.value,d=this.makeAction(s.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(h){u.e(h)}finally{u.f()}c.push("Search");var g=c.filter(function(e,t,n){return t===n.indexOf(e)});this.toolbarOptions=g}}catch(h){r.e(h)}finally{r.f()}}},{key:"makeAction",value:function(e){switch(e){case j.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}},{key:"onChangeBuilding",value:function(e){this.buildingID=e.itemData.id,this.buildingName=e.itemData.name,localStorage.setItem("buildingID",e.itemData.id),this.searchWithBuilding(this.startDate,this.endDate)}},{key:"resetSearch",value:function(){this.searchText=null}},{key:"toolbarClick",value:function(e){switch(e.item.text){case"ExcelExport":this.ingredientinforeportGrid.excelExport()}}},{key:"getIngredientInfoReport",value:function(){var e=this;this.ingredientService.getAllIngredientInfo().subscribe(function(t){e.data=t})}},{key:"getIngredientInfoReportByBuilding",value:function(){var e=this;this.ingredientService.getAllIngredientInfoReportByBuildingName(this.buildingName).subscribe(function(t){e.data=t})}},{key:"startDateOnchange",value:function(e){this.startDate=e.value,this.searchWithBuilding(this.startDate,this.endDate)}},{key:"endDateOnchange",value:function(e){this.endDate=e.value,this.searchWithBuilding(this.startDate,this.endDate)}},{key:"onClickDefault",value:function(){this.startDate=new Date,this.endDate=new Date,this.searchWithBuilding(this.startDate,this.endDate)}},{key:"searchWithBuilding",value:function(e,t){var n=this;this.ingredientService.searchInventoryByBuildingName(e.toDateString(),t.toDateString(),this.buildingName).subscribe(function(e){n.data=e})}}]),r}(O.a)).\u0275fac=function(e){return new(e||ge)(F.Pb(p.b),F.Pb(K.a),F.Pb(H.a),F.Pb($.a),F.Pb(q.a),F.Pb(M.a))},ge.\u0275cmp=F.Jb({type:ge,selectors:[["app-inventory"]],viewQuery:function(e,t){var n;1&e&&F.Rc(X,1),2&e&&F.Ac(n=F.gc())&&(t.ingredientinforeportGrid=n.first)},features:[F.Bb([s.e,s.f]),F.zb],decls:57,vars:17,consts:[[1,"card"],[1,"card-body"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-2"],[3,"value","ngModel","change","ngModelChange"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","value","filtering","change"],["modelNameDropdownlist",""],[1,"btn","btn-sm","btn-default",3,"click"],[1,"fa","fa-times"],[1,"col-md-12"],["allowFiltering","true","showColumnMenu","true","allowPaging","true","gridLines","Both",3,"dataSource","allowExcelExport","allowSorting","filterSettings","toolbar","pageSettings","toolbarClick"],["ingredientinforeportGrid",""],["field","createdTime","textAlign","Center","headerText","Time","width","150"],["headerTemplate",""],["template",""],["field","supplierName","textAlign","Center","headerText","Supplier","width","100"],["field","name","textAlign","Center","headerText","Ingredient","width","100"],["field","manufacturingDate","textAlign","Center","headerText","Production date","width","130"],["field","batch","textAlign","Center","headerText","Batch","width","100"],["field","expiredTime","textAlign","Center","headerText","Expired Date","width","130"],["field","qty","textAlign","Center","headerText","Recieve Qty (Kg)","width","130"],["field","consumption","textAlign","Center","headerText","Consumption","width","100"]],template:function(e,t){1&e&&(F.Vb(0,"div",0),F.Vb(1,"div",1),F.Vb(2,"div",2),F.Vb(3,"div",3),F.Vb(4,"div",4),F.Lc(5),F.kc(6,"translate"),F.Ub(),F.Ub(),F.Vb(7,"div",5),F.Vb(8,"ejs-datepicker",6),F.fc("change",function(e){return t.startDateOnchange(e)})("ngModelChange",function(e){return t.startDate=e}),F.Ub(),F.Ub(),F.Vb(9,"div",5),F.Vb(10,"ejs-datepicker",6),F.fc("change",function(e){return t.endDateOnchange(e)})("ngModelChange",function(e){return t.endDate=e}),F.Ub(),F.Ub(),F.Vb(11,"div",5),F.Vb(12,"ejs-dropdownlist",7,8),F.fc("filtering",function(e){return t.onFilteringBuilding(e)})("change",function(e){return t.onChangeBuilding(e)}),F.Ub(),F.Ub(),F.Vb(14,"div",5),F.Vb(15,"button",9),F.fc("click",function(){return t.onClickDefault()}),F.Qb(16,"i",10),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Vb(17,"div",1),F.Vb(18,"div",2),F.Vb(19,"div",11),F.Vb(20,"ejs-grid",12,13),F.fc("toolbarClick",function(e){return t.toolbarClick(e)}),F.Vb(22,"e-columns"),F.Vb(23,"e-column",14),F.Jc(24,Z,2,3,"ng-template",null,15,F.Kc),F.Jc(26,ee,2,4,"ng-template",null,16,F.Kc),F.Ub(),F.Vb(28,"e-column",17),F.Jc(29,te,2,3,"ng-template",null,15,F.Kc),F.Ub(),F.Vb(31,"e-column",18),F.Jc(32,ne,2,3,"ng-template",null,15,F.Kc),F.Ub(),F.Vb(34,"e-column",19),F.Jc(35,ie,2,3,"ng-template",null,15,F.Kc),F.Jc(37,ae,2,4,"ng-template",null,16,F.Kc),F.Ub(),F.Vb(39,"e-column",20),F.Jc(40,re,2,3,"ng-template",null,15,F.Kc),F.Ub(),F.Vb(42,"e-column",21),F.Jc(43,oe,2,3,"ng-template",null,15,F.Kc),F.Jc(45,le,2,4,"ng-template",null,16,F.Kc),F.Ub(),F.Vb(47,"e-column",22),F.Jc(48,ce,2,3,"ng-template",null,15,F.Kc),F.Jc(50,ue,1,1,"ng-template",null,16,F.Kc),F.Ub(),F.Vb(52,"e-column",23),F.Jc(53,se,2,3,"ng-template",null,15,F.Kc),F.Jc(55,de,1,1,"ng-template",null,16,F.Kc),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub()),2&e&&(F.Cb(5),F.Nc("",F.lc(6,15,"FILTER_LABEL"),":"),F.Cb(3),F.pc("value",t.startDate)("ngModel",t.startDate),F.Cb(2),F.pc("value",t.endDate)("ngModel",t.endDate),F.Cb(2),F.pc("dataSource",t.buildings)("fields",t.fieldsBuildings)("allowFiltering",!0)("value",t.buildingID),F.Cb(8),F.pc("dataSource",t.data)("allowExcelExport",!0)("allowSorting",!0)("filterSettings",t.filterSettings)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings))},directives:[y.a,d.f,d.i,f.c,U.j,m.d,A.d,A.b,U.e,U.b,m.c,A.c,A.a,U.d,U.a],pipes:[w.c,s.e],styles:[".search-hero[_ngcontent-%COMP%]{max-width:500px;padding-bottom:50px;margin:auto}.form-control[_ngcontent-%COMP%]{box-shadow:0 10px 40px 0 #b0c1d9}.form-control[_ngcontent-%COMP%]:-ms-input-placeholder{font-family:FontAwesome}.form-control[_ngcontent-%COMP%]::placeholder{font-family:FontAwesome}"]}),ge),fe=r("0WEV"),pe=["cloneModal"],be=["planForm"],me=["grid"];function ve(e,t){if(1&e&&(F.Lc(0),F.kc(1,"date")),2&e){var n=t.$implicit;F.Nc(" ","0001-01-01T00:00:00"===n.mixingDate?"N/A":F.mc(1,1,n.mixingDate,"dd/MM/yyyy")," ")}}function ye(e,t){1&e&&F.Lc(0),2&e&&F.Nc("",t.$implicit.percentage," %")}var De,Ce=JSON.parse(localStorage.getItem("level")),we=((De=function(n){l(r,n);var i=u(r);function r(e,t,n,o,l,c,u){var s;return a(this,r),(s=i.call(this)).alertify=e,s.modalService=t,s.planService=n,s.datePipe=o,s.spinner=l,s.buildingService=c,s.route=u,s.searchSettings={hierarchyMode:"Parent"},s.fieldsBuildings={text:"name",value:"id"},s.sortSettings={columns:[{field:"percentage",direction:"Descending"}]},s.queryCellInfoEvent=function(e){e.data.percentage>0&&(e.cell.style.backgroundColor="#FFFF66")},s.onFilteringBuilding=function(e){var t=new z.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(s.buildings,t)},s.buildingID=+localStorage.getItem("buildingID"),s}return o(r,[{key:"dataBound",value:function(){this.grid.autoFitColumns()}},{key:"ngOnInit",value:function(){var e=this;this.Permission(this.route),this.startDate=new Date,this.endDate=new Date,this.role=Ce,this.level=JSON.parse(localStorage.getItem("level")).level,this.pageSettings={pageCount:20,pageSizes:["All",100],pageSize:100},this.getBuilding(0===this.buildingID?function(){e.alertify.message("Please select a building!",!0)}:function(){e.consumptionByLineCase1()})}},{key:"Permission",value:function(n){var i=n.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var a,r=t(this.functions);try{for(r.s();!(a=r.n()).done;){var o,l=a.value,c=[],u=t(l.childrens);try{for(u.s();!(o=u.n()).done;){var s=o.value,d=this.makeAction(s.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(h){u.e(h)}finally{u.f()}c.push("Search");var g=c.filter(function(e,t,n){return t===n.indexOf(e)});this.toolbarOptions=g}}catch(h){r.e(h)}finally{r.f()}}},{key:"makeAction",value:function(e){switch(e){case j.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}},{key:"headerCellInfo",value:function(e){"totalConsumption"===e.cell.column.field&&new S.b({content:"Total Consumption (kg)"}).appendTo(e.node),"realConsumption"===e.cell.column.field&&new S.b({content:"Real Consumption (g) pr."}).appendTo(e.node),"mixingDate"===e.cell.column.field&&new S.b({content:"Mixing Date Of Glue"}).appendTo(e.node)}},{key:"onChangeBuilding",value:function(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.consumptionByLineCase1()}},{key:"onSelectBuilding",value:function(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.consumptionByLineCase1()}},{key:"getBuilding",value:function(e){var t=this;this.buildingService.getBuildings().subscribe(function(n){return Object(V.a)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.buildings=n.filter(function(e){return 2===e.level}),e();case 1:case"end":return t.stop()}},t,this)}))})}},{key:"consumptionByLineCase1",value:function(){var e=this;this.planService.consumptionByLineCase1(this.buildingID,this.startDate,this.endDate).subscribe(function(t){e.data=t})}},{key:"startDateOnchange",value:function(e){e.isInteracted&&(this.startDate=e.value,this.consumptionByLineCase1())}},{key:"endDateOnchange",value:function(e){e.isInteracted&&(this.endDate=e.value,this.consumptionByLineCase1())}},{key:"onClickDefault",value:function(){this.startDate=new Date,this.endDate=new Date,this.consumptionByLineCase1()}},{key:"toolbarClick",value:function(e){switch(e.item.id){case"grid_excelexport":this.reportConsumptionCase1()}}},{key:"tooltip",value:function(e){return e?e.join("<br>"):""}},{key:"reportConsumptionCase1",value:function(){var e=this;Math.floor((this.endDate.getTime()-this.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.reportConsumptionCase1(this.buildingID,this.startDate,this.endDate).subscribe(function(t){new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n;var a=e.datePipe.transform(e.startDate,"YYYYMMdd"),r=e.datePipe.transform(e.endDate,"YYYYMMdd");i.download="".concat(a,"-").concat(r,"_Consumption1.xlsx"),i.click(),e.spinner.hide()}))}}]),r}(O.a)).\u0275fac=function(e){return new(e||De)(F.Pb(q.a),F.Pb(p.b),F.Pb(fe.a),F.Pb(s.e),F.Pb(g.c),F.Pb(H.a),F.Pb(M.a))},De.\u0275cmp=F.Jb({type:De,selectors:[["app-consumption-1"]],viewQuery:function(e,t){var n;1&e&&(F.Rc(pe,1),F.Rc(be,1),F.Rc(me,1)),2&e&&(F.Ac(n=F.gc())&&(t.cloneModal=n.first),F.Ac(n=F.gc())&&(t.orderForm=n.first),F.Ac(n=F.gc())&&(t.grid=n.first))},features:[F.zb],decls:44,vars:21,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row","pt-2"],[1,"col-md-12"],[1,"card"],[1,"card-body","p-0"],[1,"row","my-3"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-3"],[3,"value","ngModel","change","ngModelChange"],[1,"col-md-2"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","value","filtering","change"],["modelNameDropdownlist",""],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fa","fa-times"],["id","grid","gridLines","Both",3,"dataSource","searchSettings","showColumnMenu","allowPaging","allowSorting","allowResizing","toolbar","sortSettings","pageSettings","dataBound","queryCellInfo","headerCellInfo","toolbarClick"],["grid",""],["field","modelName","headerText","Model Name","width","100","textAlign","Center"],["field","modelNo","headerText","Model No.","width","100","textAlign","Center"],["field","articleNo","headerText","Article No.","width","100","textAlign","Center"],["field","process","headerText","Process","width","100","textAlign","Center"],["field","glue","headerText","Glue","width","100","textAlign","Center"],["field","std","headerText","Std.(g)","width","100","textAlign","Center"],["field","mixingDate","headerText","Mixing Date","type","date","format","dd/MM/yyyy","width","100","textAlign","Center"],["template",""],["field","line","headerText","Line","width","100","textAlign","Center"],["field","qty","headerText","Qty","width","100","textAlign","Center"],["field","totalConsumption","headerText","\u2211 Con. (kg)","width","100","textAlign","Center"],["field","realConsumption","headerText","Real Con. (g) pr.","width","100","textAlign","Center"],["field","diff","headerText","Diff.","width","100","textAlign","Center"],["field","percentage","headerText","%","width","100","textAlign","Center"]],template:function(e,t){1&e&&(F.Vb(0,"ngx-spinner",0),F.Vb(1,"p",1),F.Lc(2,"Loading data..."),F.Ub(),F.Ub(),F.Vb(3,"div",2),F.Vb(4,"div",3),F.Vb(5,"div",4),F.Vb(6,"div",5),F.Vb(7,"div",6),F.Vb(8,"div",3),F.Vb(9,"div",7),F.Vb(10,"div",8),F.Vb(11,"div",9),F.Lc(12),F.kc(13,"translate"),F.Ub(),F.Ub(),F.Vb(14,"div",10),F.Vb(15,"ejs-datepicker",11),F.fc("change",function(e){return t.startDateOnchange(e)})("ngModelChange",function(e){return t.startDate=e}),F.Ub(),F.Ub(),F.Vb(16,"div",10),F.Vb(17,"ejs-datepicker",11),F.fc("change",function(e){return t.endDateOnchange(e)})("ngModelChange",function(e){return t.endDate=e}),F.Ub(),F.Ub(),F.Vb(18,"div",12),F.Vb(19,"ejs-dropdownlist",13,14),F.fc("filtering",function(e){return t.onFilteringBuilding(e)})("change",function(e){return t.onChangeBuilding(e)}),F.Ub(),F.Ub(),F.Vb(21,"div",12),F.Vb(22,"button",15),F.fc("click",function(){return t.onClickDefault()}),F.Qb(23,"i",16),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Vb(24,"ejs-grid",17,18),F.fc("dataBound",function(){return t.dataBound()})("queryCellInfo",function(e){return t.queryCellInfoEvent(e)})("headerCellInfo",function(e){return t.headerCellInfo(e)})("toolbarClick",function(e){return t.toolbarClick(e)}),F.Vb(26,"e-columns"),F.Qb(27,"e-column",19),F.Qb(28,"e-column",20),F.Qb(29,"e-column",21),F.Qb(30,"e-column",22),F.Qb(31,"e-column",23),F.Qb(32,"e-column",24),F.Vb(33,"e-column",25),F.Jc(34,ve,2,4,"ng-template",null,26,F.Kc),F.Ub(),F.Qb(36,"e-column",27),F.Qb(37,"e-column",28),F.Qb(38,"e-column",29),F.Qb(39,"e-column",30),F.Qb(40,"e-column",31),F.Vb(41,"e-column",32),F.Jc(42,ye,1,1,"ng-template",null,26,F.Kc),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub()),2&e&&(F.pc("fullScreen",!1),F.Cb(12),F.Nc("",F.lc(13,19,"FILTER_LABEL"),":"),F.Cb(3),F.pc("value",t.startDate)("ngModel",t.startDate),F.Cb(2),F.pc("value",t.endDate)("ngModel",t.endDate),F.Cb(2),F.pc("dataSource",t.buildings)("fields",t.fieldsBuildings)("allowFiltering",!0)("value",t.buildingID),F.Cb(5),F.pc("dataSource",t.data)("searchSettings",t.searchSettings)("showColumnMenu",!0)("allowPaging",!0)("allowSorting",!0)("allowResizing",!0)("toolbar",t.toolbarOptions)("sortSettings",t.sortSettings)("pageSettings",t.pageSettings))},directives:[g.a,y.a,d.f,d.i,f.c,U.j,m.d,A.d,A.b,U.e,U.b,m.c,A.c,A.a,U.d,U.a],pipes:[w.c,s.e],styles:[".bgcolor[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#ff6!important}"]}),De),ke=["cloneModal"],Se=["planForm"],xe=["grid"];function Ue(e,t){if(1&e&&(F.Lc(0),F.kc(1,"date")),2&e){var n=t.$implicit;F.Nc(" ","0001-01-01T00:00:00"===n.mixingDate?"N/A":F.mc(1,1,n.mixingDate,"dd/MM/yyyy")," ")}}function Ie(e,t){1&e&&F.Lc(0),2&e&&F.Nc("",t.$implicit.percentage," %")}var Be,Ae=JSON.parse(localStorage.getItem("level")),Ee=((Be=function(n){l(r,n);var i=u(r);function r(e,t,n,o,l,c,u){var s;return a(this,r),(s=i.call(this)).alertify=e,s.modalService=t,s.planService=n,s.datePipe=o,s.spinner=l,s.buildingService=c,s.route=u,s.searchSettings={hierarchyMode:"Parent"},s.fieldsBuildings={text:"name",value:"id"},s.queryCellInfoEvent=function(e){var t=e.data,n=["modelName","modelNo","articleNo","process","qty","line"];n.includes(e.column.field)&&(e.rowSpan=s.data.filter(function(e){return e.id===t.id&&e.modelName===t.modelName&&e.modelNo===t.modelNo&&e.articleNo===t.articleNo&&e.process===t.process&&e.line===t.line&&e.dueDate===t.dueDate&&e.qty===t.qty}).length),n.includes(e.column.field)||t.percentage>0&&(e.cell.style.backgroundColor="#FFFF66")},s.onFilteringBuilding=function(e){var t=new z.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(s.buildings,t)},s.buildingID=+localStorage.getItem("buildingID"),s}return o(r,[{key:"dataBound",value:function(){}},{key:"ngOnInit",value:function(){var e=this;this.Permission(this.route),this.role=Ae,this.startDate=new Date,this.endDate=new Date,this.level=JSON.parse(localStorage.getItem("level")).level,this.gridConfig(),this.getBuilding(0===this.buildingID?function(){e.alertify.message("Please select a building!",!0)}:function(){e.consumptionByLineCase2()})}},{key:"Permission",value:function(n){var i=n.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var a,r=t(this.functions);try{for(r.s();!(a=r.n()).done;){var o,l=a.value,c=[],u=t(l.childrens);try{for(u.s();!(o=u.n()).done;){var s=o.value,d=this.makeAction(s.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(h){u.e(h)}finally{u.f()}c.push("Search");var g=c.filter(function(e,t,n){return t===n.indexOf(e)});this.toolbarOptions=g}}catch(h){r.e(h)}finally{r.f()}}},{key:"makeAction",value:function(e){switch(e){case j.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}},{key:"gridConfig",value:function(){this.pageSettings={pageCount:20,pageSizes:["All",100],pageSize:100}}},{key:"onChangeBuilding",value:function(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.consumptionByLineCase2()}},{key:"getBuilding",value:function(e){var t=this;this.buildingService.getBuildings().subscribe(function(n){return Object(V.a)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.buildings=n.filter(function(e){return 2===e.level}),e();case 1:case"end":return t.stop()}},t,this)}))})}},{key:"consumptionByLineCase2",value:function(){var e=this;this.planService.consumptionByLineCase2(this.buildingID,this.startDate,this.endDate).subscribe(function(t){e.data=t})}},{key:"startDateOnchange",value:function(e){e.isInteracted&&(this.startDate=e.value,this.consumptionByLineCase2())}},{key:"endDateOnchange",value:function(e){e.isInteracted&&(this.endDate=e.value,this.consumptionByLineCase2())}},{key:"onClickDefault",value:function(){this.startDate=new Date,this.endDate=new Date,this.consumptionByLineCase2()}},{key:"toolbarClick",value:function(e){switch(e.item.id){case"grid_excelexport":this.reportConsumptionCase2()}}},{key:"tooltip",value:function(e){return e?e.join("<br>"):""}},{key:"reportConsumptionCase2",value:function(){var e=this;Math.floor((this.endDate.getTime()-this.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.reportConsumptionCase2(this.buildingID,this.startDate,this.endDate).subscribe(function(t){new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n;var a=e.datePipe.transform(e.startDate,"YYYYMMdd"),r=e.datePipe.transform(e.endDate,"YYYYMMdd");i.download="".concat(a,"-").concat(r,"_Consumption2.xlsx"),i.click(),e.spinner.hide()}))}}]),r}(O.a)).\u0275fac=function(e){return new(e||Be)(F.Pb(q.a),F.Pb(p.b),F.Pb(fe.a),F.Pb(s.e),F.Pb(g.c),F.Pb(H.a),F.Pb(M.a))},Be.\u0275cmp=F.Jb({type:Be,selectors:[["app-consumption-2"]],viewQuery:function(e,t){var n;1&e&&(F.Rc(ke,1),F.Rc(Se,1),F.Rc(xe,1)),2&e&&(F.Ac(n=F.gc())&&(t.cloneModal=n.first),F.Ac(n=F.gc())&&(t.orderForm=n.first),F.Ac(n=F.gc())&&(t.grid=n.first))},features:[F.zb],decls:43,vars:16,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row","pt-2"],[1,"col-md-12"],[1,"card"],[1,"card-body","p-0"],[1,"row","my-3"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-3"],[3,"value","ngModel","change","ngModelChange"],[1,"col-md-2"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","value","filtering","change"],["modelNameDropdownlist",""],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fa","fa-times"],["id","grid","showColumnMenu","true","allowPaging","true","allowResizing","true","gridLines","Both",3,"dataSource","searchSettings","toolbar","pageSettings","dataBound","queryCellInfo","toolbarClick"],["grid",""],["field","line","headerText","Line","width","80","textAlign","Center"],["field","modelName","headerText","ModelName","width","120","textAlign","Center"],["field","modelNo","headerText","ModelNo","width","100","textAlign","Center"],["field","articleNo","headerText","ArticleNo","width","100","textAlign","Center"],["field","process","headerText","Process","width","100","textAlign","Center"],["field","qty","headerText","Qty","width","100","textAlign","Center"],["field","glue","headerText","Glue","width","150","textAlign","Center"],["field","std","headerText","Std.(g)","width","100","textAlign","Center"],["field","mixingDate","headerText","Mixing Date","type","date","format","dd/MM/yyyy","width","100","textAlign","Center"],["template",""],["field","realConsumption","headerText","Real Consumption (g) pr.","width","100","textAlign","Center"],["field","diff","headerText","Diff","width","100","textAlign","Center"],["field","percentage","headerText","%","width","100","textAlign","Center"]],template:function(e,t){1&e&&(F.Vb(0,"ngx-spinner",0),F.Vb(1,"p",1),F.Lc(2,"Loading data..."),F.Ub(),F.Ub(),F.Vb(3,"div",2),F.Vb(4,"div",3),F.Vb(5,"div",4),F.Vb(6,"div",5),F.Vb(7,"div",6),F.Vb(8,"div",3),F.Vb(9,"div",7),F.Vb(10,"div",8),F.Vb(11,"div",9),F.Lc(12),F.kc(13,"translate"),F.Ub(),F.Ub(),F.Vb(14,"div",10),F.Vb(15,"ejs-datepicker",11),F.fc("change",function(e){return t.startDateOnchange(e)})("ngModelChange",function(e){return t.startDate=e}),F.Ub(),F.Ub(),F.Vb(16,"div",10),F.Vb(17,"ejs-datepicker",11),F.fc("change",function(e){return t.endDateOnchange(e)})("ngModelChange",function(e){return t.endDate=e}),F.Ub(),F.Ub(),F.Vb(18,"div",12),F.Vb(19,"ejs-dropdownlist",13,14),F.fc("filtering",function(e){return t.onFilteringBuilding(e)})("change",function(e){return t.onChangeBuilding(e)}),F.Ub(),F.Ub(),F.Vb(21,"div",12),F.Vb(22,"button",15),F.fc("click",function(){return t.onClickDefault()}),F.Qb(23,"i",16),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Vb(24,"ejs-grid",17,18),F.fc("dataBound",function(){return t.dataBound()})("queryCellInfo",function(e){return t.queryCellInfoEvent(e)})("toolbarClick",function(e){return t.toolbarClick(e)}),F.Vb(26,"e-columns"),F.Qb(27,"e-column",19),F.Qb(28,"e-column",20),F.Qb(29,"e-column",21),F.Qb(30,"e-column",22),F.Qb(31,"e-column",23),F.Qb(32,"e-column",24),F.Qb(33,"e-column",25),F.Qb(34,"e-column",26),F.Vb(35,"e-column",27),F.Jc(36,Ue,2,4,"ng-template",null,28,F.Kc),F.Ub(),F.Qb(38,"e-column",29),F.Qb(39,"e-column",30),F.Vb(40,"e-column",31),F.Jc(41,Ie,1,1,"ng-template",null,28,F.Kc),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub()),2&e&&(F.pc("fullScreen",!1),F.Cb(12),F.Nc("",F.lc(13,14,"FILTER_LABEL"),":"),F.Cb(3),F.pc("value",t.startDate)("ngModel",t.startDate),F.Cb(2),F.pc("value",t.endDate)("ngModel",t.endDate),F.Cb(2),F.pc("dataSource",t.buildings)("fields",t.fieldsBuildings)("allowFiltering",!0)("value",t.buildingID),F.Cb(5),F.pc("dataSource",t.data)("searchSettings",t.searchSettings)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings))},directives:[g.a,y.a,d.f,d.i,f.c,U.j,m.d,A.d,A.b,U.e,U.b,m.c,A.c,A.a,U.d,U.a],pipes:[w.c,s.e],styles:[".bgcolor[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#ff6!important}"]}),Be),Ne=r("t0UR"),Le=["cloneModal"],Me=["planForm"],Te=["grid"];function Ve(e,t){if(1&e){var n=F.Wb();F.Vb(0,"div",18),F.Vb(1,"div",3),F.Vb(2,"div",19),F.Vb(3,"div",20),F.Vb(4,"div",21),F.Vb(5,"div",22),F.Lc(6),F.kc(7,"translate"),F.Ub(),F.Ub(),F.Vb(8,"div",23),F.Vb(9,"ejs-datepicker",24),F.fc("change",function(e){return F.Ec(n),F.jc().startDateOnchange(e)})("ngModelChange",function(e){return F.Ec(n),F.jc().startDate=e}),F.Ub(),F.Ub(),F.Vb(10,"div",23),F.Vb(11,"ejs-datepicker",24),F.fc("change",function(e){return F.Ec(n),F.jc().endDateOnchange(e)})("ngModelChange",function(e){return F.Ec(n),F.jc().endDate=e}),F.Ub(),F.Ub(),F.Vb(12,"div",25),F.Vb(13,"ejs-dropdownlist",26,27),F.fc("filtering",function(e){return F.Ec(n),F.jc().onFilteringBuilding(e)})("change",function(e){return F.Ec(n),F.jc().onChangeBuilding(e)}),F.Ub(),F.Ub(),F.Vb(15,"div",25),F.Vb(16,"button",28),F.fc("click",function(){return F.Ec(n),F.jc().onClickDefault()}),F.Qb(17,"i",29),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub()}if(2&e){var i=F.jc();F.Cb(6),F.Nc("",F.lc(7,9,"FILTER_LABEL"),":"),F.Cb(3),F.pc("value",i.startDate)("ngModel",i.startDate),F.Cb(2),F.pc("value",i.endDate)("ngModel",i.endDate),F.Cb(2),F.pc("dataSource",i.buildings)("fields",i.fieldsBuildings)("allowFiltering",!0)("value",i.buildingID)}}function Oe(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"LINE_LABEL")," ")}function Pe(e,t){1&e&&F.Lc(0),2&e&&F.Nc(" ",t.$implicit.buildingName," ")}function Re(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"BPFC_NAME_LABEL")," ")}function je(e,t){1&e&&F.Lc(0),2&e&&F.Nc(" ",t.$implicit.bpfcName," ")}function Fe(e,t){if(1&e&&(F.Vb(0,"ejs-tooltip",30),F.Lc(1),F.Ub()),2&e){var n=t.$implicit,i=F.jc();F.pc("content",i.tooltip(n.glues)),F.Cb(1),F.Nc(" ",n.bpfcName||"#N/A"," ")}}function Je(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"OUTPUT_QUANTITY")," ")}function Qe(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"DUE_DATE_LABEL")," ")}function _e(e,t){1&e&&(F.Lc(0),F.kc(1,"date")),2&e&&F.Nc(" ",F.mc(1,1,t.$implicit.dueDate,"dd MMM, yyyy")," ")}function Ye(e,t){1&e&&(F.Lc(0),F.kc(1,"translate")),2&e&&F.Nc(" ",F.lc(1,1,"CREATED_DATE_LABEL")," ")}function Ge(e,t){1&e&&(F.Lc(0),F.kc(1,"date")),2&e&&F.Nc(" ",F.mc(1,1,t.$implicit.createdDate,"dd MMM, yyyy HH:mm")," ")}function qe(e,t){if(1&e){var n=F.Wb();F.Vb(0,"div",31),F.Vb(1,"h4",32),F.Qb(2,"i",33),F.Lc(3," Clone Work Plan "),F.Ub(),F.Vb(4,"button",34),F.fc("click",function(){return t.$implicit.dismiss("Cross click")}),F.Vb(5,"span",35),F.Lc(6,"\xd7"),F.Ub(),F.Ub(),F.Ub(),F.Vb(7,"div",36),F.Vb(8,"div",20),F.Vb(9,"div",3),F.Vb(10,"div",37),F.Vb(11,"label",38),F.Lc(12,"DueDate"),F.Ub(),F.Vb(13,"span",39),F.Lc(14,"(*)"),F.Ub(),F.Vb(15,"ejs-datepicker",40),F.fc("change",function(e){return F.Ec(n),F.jc().onChangeDueDateClone(e)}),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Vb(16,"div",41),F.Vb(17,"button",42),F.fc("click",function(){return t.$implicit.close("Close click")}),F.Lc(18,"Close"),F.Ub(),F.Vb(19,"button",43),F.fc("click",function(){return F.Ec(n),F.jc().onClickClone()}),F.Lc(20,"Clone"),F.Ub(),F.Ub()}if(2&e){var i=F.jc();F.Cb(15),F.pc("value",i.date)}}var Ke,ze=((Ke=function(n){l(r,n);var i=u(r);function r(e,t,n,o,l,c,u,s){var d;return a(this,r),(d=i.call(this)).alertify=e,d.modalService=t,d.planService=n,d.bPFCEstablishService=o,d.datePipe=l,d.buildingService=c,d.spinner=u,d.route=s,d.startDate=new Date,d.endDate=new Date,d.sortSettings={columns:[{field:"dueDate",direction:"Ascending"}]},d.date=new Date,d.role=JSON.parse(localStorage.getItem("level")),d.building=JSON.parse(localStorage.getItem("building")),d.searchSettings={hierarchyMode:"Parent"},d.modalPlan={id:0,buildingID:0,BPFCEstablishID:0,BPFCName:"",hourlyOutput:0,workingHour:0,dueDate:new Date,startWorkingTime:new Date,finishWorkingTime:new Date,startTime:{hour:7,minute:0},endTime:{hour:16,minute:30}},d.textLine="Select a line name",d.fieldsGlue={text:"name",value:"name"},d.fieldsLine={text:"name",value:"name"},d.fieldsBPFC={text:"name",value:"name"},d.fieldsBuildings={text:"name",value:"id"},d.buildingID=0,d.onFilteringBuilding=function(e){var t=new z.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(d.buildings,t)},d.buildingID=+localStorage.getItem("buildingID"),d}return o(r,[{key:"ngOnInit",value:function(){this.Permission(this.route),new Date,this.endDate=new Date,this.level=JSON.parse(localStorage.getItem("level")).level,this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editparams={params:{popupHeight:"300px"}},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.getAll(this.startDate,this.endDate),this.getAllBPFC();var e=JSON.parse(localStorage.getItem("level")).id;this.getAllLine(e),this.getBuilding(),this.ClearForm()}},{key:"Permission",value:function(n){var i=n.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var a,r=t(this.functions);try{for(r.s();!(a=r.n()).done;){var o,l=a.value,c=[],u=t(l.childrens);try{for(u.s();!(o=u.n()).done;){var s=o.value,d=this.makeAction(s.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(h){u.e(h)}finally{u.f()}c.push("Search");var g=c.filter(function(e,t,n){return t===n.indexOf(e)});this.toolbarOptions=g}}catch(h){r.e(h)}finally{r.f()}}},{key:"makeAction",value:function(e){switch(e){case j.a.EXCEL_EXPORT:return[{text:"Report",tooltipText:"Report",prefixIcon:"e-excelexport",id:"report"},{text:"Report(new)",tooltipText:"Report(new)",prefixIcon:"e-excelexport",id:"newReport"}];default:return[void 0]}}},{key:"onChangeBuilding",value:function(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.getAll(this.startDate,this.endDate)}},{key:"getBuilding",value:function(){var e=this;this.buildingService.getBuildings().subscribe(function(t){return Object(V.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.buildings=t.filter(function(e){return 2===e.level});case 1:case"end":return e.stop()}},e,this)}))})}},{key:"count",value:function(e){return Number(e)+1}},{key:"getAllLine",value:function(e){var t=this;this.planService.getLines(e).subscribe(function(e){t.buildingName=e})}},{key:"getReport",value:function(e){var t=this;Math.floor((e.endDate.getTime()-e.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.getReport(e).subscribe(function(e){new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var n=window.URL.createObjectURL(e),i=document.createElement("a");i.href=n,new Date;var a=t.datePipe.transform(t.startDate,"YYYYMMdd"),r=t.datePipe.transform(t.endDate,"YYYYMMdd");i.download="".concat(a,"-").concat(r,"_Cost.xlsx"),i.click(),t.spinner.hide()}))}},{key:"getReportByBuilding",value:function(){var e=this,t={startDate:this.startDate,endDate:this.endDate,buildingID:this.buildingID};Math.floor((t.endDate.getTime()-t.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.getReportByBuilding(t).subscribe(function(t){new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,new Date;var a=e.datePipe.transform(e.startDate,"YYYYMMdd"),r=e.datePipe.transform(e.endDate,"YYYYMMdd");i.download="".concat(a,"-").concat(r,"_Cost.xlsx"),i.click(),e.spinner.hide()}))}},{key:"downLoadFile",value:function(e,t){var n=new Blob([e],{type:t}),i=window.URL.createObjectURL(n),a=window.open(i);a&&!a.closed&&void 0!==a.closed||this.alertify.error("Please disable your Pop-up blocker and try again."),this.spinner.hide()}},{key:"onChangeBuildingNameEdit",value:function(e){this.buildingNameEdit=e.itemData.id}},{key:"onChangeDueDateEdit",value:function(e){this.dueDate=e.value.toDateString()}},{key:"onChangeDueDateClone",value:function(e){this.date=e.value}},{key:"onChangeBPFCEdit",value:function(e){this.bpfcEdit=e.itemData.id}},{key:"actionComplete",value:function(e){"beginEdit"===e.requestType&&e.form.elements.namedItem(this.setFocus.field).focus()}},{key:"onDoubleClick",value:function(e){this.setFocus=e.column}},{key:"actionBegin",value:function(e){var t=this;"cancel"===e.requestType&&this.ClearForm(),"save"===e.requestType&&"edit"===e.action&&this.planService.editQuantity(e.data.id||0,e.data.quantity).subscribe(function(e){t.alertify.success("Updated succeeded!"),t.ClearForm(),t.getAll(t.startDate,t.endDate)})}},{key:"ClearForm",value:function(){this.bpfcEdit=0,this.hourlyOutput=0,this.workHour=0,this.dueDate=new Date}},{key:"validForm",value:function(){return[this.bpfcEdit].every(function(e){return e>0})}},{key:"onChangeWorkingHour",value:function(e){this.workHour=e}},{key:"onChangeHourlyOutput",value:function(e){this.hourlyOutput=e}},{key:"rowSelected",value:function(e){}},{key:"openaddModalPlan",value:function(e){this.modalReference=this.modalService.open(e)}},{key:"getAllBPFC",value:function(){var e=this;this.bPFCEstablishService.filterByApprovedStatus().subscribe(function(t){e.BPFCs=t.map(function(e){return{id:e.id,name:"".concat(e.modelName," - ").concat(e.modelNo," - ").concat(e.articleNo," - ").concat(e.artProcess)}})})}},{key:"getAll",value:function(e,t){var n=this;this.planService.search(this.buildingID,e.toDateString(),t.toDateString()).subscribe(function(e){n.data=e.map(function(e){return{id:e.id,bpfcName:"".concat(e.modelName," - ").concat(e.modelNoName," - ").concat(e.articleName," - ").concat(e.processName),dueDate:e.dueDate,createdDate:e.createdDate,workingHour:e.workingHour,hourlyOutput:e.hourlyOutput,buildingName:e.buildingName,buildingID:e.buildingID,quantity:e.quantity,bpfcEstablishID:e.bpfcEstablishID,glues:e.glues||[]}})})}},{key:"deleteRange",value:function(e){var t=this;this.alertify.confirm("Delete Plan","Are you sure you want to delete this Plans ?",function(){t.planService.deleteRange(e).subscribe(function(){t.getAll(t.startDate,t.endDate),t.alertify.success("Plans has been deleted")},function(e){t.alertify.error("Failed to delete the Modal Name")})})}},{key:"openModal",value:function(e){var t=this.grid.getSelectedRecords();0!==t.length?(this.plansSelected=t.map(function(e){return{id:0,bpfcEstablishID:e.bpfcEstablishID,workingHour:e.workingHour,hourlyOutput:e.hourlyOutput,dueDate:e.dueDate,buildingID:e.buildingID}}),this.modalReference=this.modalService.open(e)):this.alertify.warning("Please select the plan")}},{key:"toolbarClick",value:function(e){switch(e.item.id){case"grid_excelexport":this.getReport({startDate:this.startDate,endDate:this.endDate});break;case"Clone":this.openModal(this.cloneModal);break;case"Delete Range":if(0===this.grid.getSelectedRecords().length)this.alertify.warning("Please select the plans!!");else{var t=this.grid.getSelectedRecords().map(function(e){return e.id});this.deleteRange(t)}break;case"report":this.getReportByBuilding();break;case"newReport":this.getNewReportByBuilding()}}},{key:"getNewReportByBuilding",value:function(){var e=this,t={startDate:this.startDate,endDate:this.endDate,buildingID:this.buildingID};Math.floor((t.endDate.getTime()-t.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.getNewReportByBuilding(t).subscribe(function(t){new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n;var a=e.datePipe.transform(e.startDate,"YYYYMMdd"),r=e.datePipe.transform(e.endDate,"YYYYMMdd");i.download="".concat(a,"-").concat(r,"_Cost(new).xlsx"),i.click(),e.spinner.hide()}))}},{key:"onClickClone",value:function(){var e=this;this.plansSelected.map(function(t){t.dueDate=e.date}),this.planService.clonePlan(this.plansSelected).subscribe(function(t){t?(e.alertify.success("Successfully!"),e.startDate=e.date,e.endDate=e.date,e.getAll(e.date,e.date),e.modalService.dismissAll()):(e.alertify.warning("the plans have already existed!"),e.modalService.dismissAll())})}},{key:"search",value:function(e,t){var n=this;this.planService.search(this.building.id,e.toDateString(),t.toDateString()).subscribe(function(e){n.data=e.map(function(e){return{id:e.id,bpfcName:"".concat(e.modelName," - ").concat(e.modelNoName," - ").concat(e.articleName," - ").concat(e.processName),dueDate:e.dueDate,createdDate:e.createdDate,workingHour:e.workingHour,hourlyOutput:e.hourlyOutput,buildingName:e.buildingName,buildingID:e.buildingID,bpfcEstablishID:e.bpfcEstablishID,quantity:e.quantity,glues:e.glues||[]}})})}},{key:"onClickDefault",value:function(){this.startDate=new Date,this.endDate=new Date,this.getAll(this.startDate,this.endDate)}},{key:"startDateOnchange",value:function(e){this.startDate=e.value,this.getAll(this.startDate,this.endDate)}},{key:"endDateOnchange",value:function(e){this.endDate=e.value,this.getAll(this.startDate,this.endDate)}},{key:"tooltip",value:function(e){return e?e.join("<br>"):""}},{key:"editQuantity",value:function(e,t){this.planService.editQuantity(e,t)}},{key:"onClickFilter",value:function(){this.getAll(this.startDate,this.endDate)}}]),r}(O.a)).\u0275fac=function(e){return new(e||Ke)(F.Pb(q.a),F.Pb(p.b),F.Pb(fe.a),F.Pb(Ne.a),F.Pb(s.e),F.Pb(H.a),F.Pb(g.c),F.Pb(M.a))},Ke.\u0275cmp=F.Jb({type:Ke,selectors:[["app-consumption"]],viewQuery:function(e,t){var n;1&e&&(F.Rc(Le,1),F.Rc(Me,1),F.Rc(Te,1)),2&e&&(F.Ac(n=F.gc())&&(t.cloneModal=n.first),F.Ac(n=F.gc())&&(t.orderForm=n.first),F.Ac(n=F.gc())&&(t.grid=n.first))},features:[F.zb],decls:38,vars:9,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row","pt-2"],[1,"col-md-12"],[1,"card"],[1,"card-body","table-responsive","p-0"],["class","row my-3",4,"ngIf"],["id","grid","showColumnMenu","true","allowPaging","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","searchSettings","allowExcelExport","sortSettings","toolbar","pageSettings","editSettings","actionBegin","actionComplete","recordDoubleClick","rowSelected","toolbarClick"],["grid",""],["field","buildingName","headerText","Line","width","100","textAlign","Center"],["headerTemplate",""],["editTemplate",""],["field","bpfcName","headerText","BPFC Name","width","290","textAlign","Center"],["template",""],["field","quantity","headerText","Quantity","width","170","textAlign","Center"],["field","dueDate","type","date","format","dd MMM, yyyy","headerText","Due Date","width","160","textAlign","Center"],["field","createdDate","isPrimaryKey","true","type","date","format","dd MMM, yyyy HH:mm","headerText","Created Date","width","200","textAlign","Center"],["cloneModal",""],[1,"row","my-3"],[1,"col-md-8"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-3"],[3,"value","ngModel","change","ngModelChange"],[1,"col-md-2"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","value","filtering","change"],["modelNameDropdownlist",""],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fa","fa-times"],[3,"content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],["for","Name"],[2,"color","red"],["format","dd MMM, yyyy",3,"value","change"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(F.Vb(0,"ngx-spinner",0),F.Vb(1,"p",1),F.Lc(2,"Loading data..."),F.Ub(),F.Ub(),F.Vb(3,"div",2),F.Vb(4,"div",3),F.Vb(5,"div",4),F.Vb(6,"div",5),F.Jc(7,Ve,18,11,"div",6),F.Vb(8,"ejs-grid",7,8),F.fc("actionBegin",function(e){return t.actionBegin(e)})("actionComplete",function(e){return t.actionComplete(e)})("recordDoubleClick",function(e){return t.onDoubleClick(e)})("rowSelected",function(e){return t.rowSelected(e)})("toolbarClick",function(e){return t.toolbarClick(e)}),F.Vb(10,"e-columns"),F.Vb(11,"e-column",9),F.Jc(12,Oe,2,3,"ng-template",null,10,F.Kc),F.Jc(14,Pe,1,1,"ng-template",null,11,F.Kc),F.Ub(),F.Vb(16,"e-column",12),F.Jc(17,Re,2,3,"ng-template",null,10,F.Kc),F.Jc(19,je,1,1,"ng-template",null,11,F.Kc),F.Jc(21,Fe,2,2,"ng-template",null,13,F.Kc),F.Ub(),F.Vb(23,"e-column",14),F.Jc(24,Je,2,3,"ng-template",null,10,F.Kc),F.Ub(),F.Vb(26,"e-column",15),F.Jc(27,Qe,2,3,"ng-template",null,10,F.Kc),F.Jc(29,_e,2,4,"ng-template",null,11,F.Kc),F.Ub(),F.Vb(31,"e-column",16),F.Jc(32,Ye,2,3,"ng-template",null,10,F.Kc),F.Jc(34,Ge,2,4,"ng-template",null,11,F.Kc),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Jc(36,qe,21,1,"ng-template",null,17,F.Kc)),2&e&&(F.pc("fullScreen",!1),F.Cb(7),F.pc("ngIf",!t.hasWorker),F.Cb(1),F.pc("dataSource",t.data)("searchSettings",t.searchSettings)("allowExcelExport",!0)("sortSettings",t.sortSettings)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("editSettings",t.editSettings))},directives:[g.a,s.n,U.j,m.d,A.d,A.b,U.e,U.b,m.c,A.c,A.a,U.d,U.a,y.a,d.f,d.i,f.c,S.c],pipes:[w.c,s.e],styles:[""]}),Ke),He=["cloneModal"],We=["planForm"],$e=["grid"];function Xe(e,t){if(1&e&&(F.Lc(0),F.kc(1,"date")),2&e){var n=t.$implicit;F.Nc(" ","0001-01-01T00:00:00"===n.dueDate?"N/A":F.mc(1,1,n.dueDate,"dd/MM/yyyy")," ")}}var Ze,et,tt,nt=JSON.parse(localStorage.getItem("level")),it=[{path:"",data:{title:"Report",breadcrumb:"Report"},children:[{path:"consumption",component:ze,data:{title:"Cost",breadcrumb:"Cost",functionCode:"Cost"},canActivate:[T.a]},{path:"consumption-1",component:we,data:{title:"Consumption 1",breadcrumb:"Consumption 1",functionCode:"Consumption 1"},canActivate:[T.a]},{path:"consumption-2",component:Ee,data:{title:"Consumption 2",breadcrumb:"Consumption 2",functionCode:"Consumption 2"},canActivate:[T.a]},{path:"consumption-3",component:(Ze=function(n){l(r,n);var i=u(r);function r(e,t,n,o,l,c,u){var s;return a(this,r),(s=i.call(this)).alertify=e,s.modalService=t,s.planService=n,s.datePipe=o,s.spinner=l,s.buildingService=c,s.route=u,s.searchSettings={hierarchyMode:"Parent"},s.fieldsBuildings={text:"name",value:"id"},s.queryCellInfoEvent=function(e){var t=e.data,n=["modelName","modelNo","articleNo","process","line"];n.includes(e.column.field)&&(e.rowSpan=s.data.filter(function(e){return e.id===t.id&&e.modelName===t.modelName&&e.modelNo===t.modelNo&&e.articleNo===t.articleNo&&e.process===t.process&&e.line===t.line&&e.dueDate===t.dueDate}).length),n.includes(e.column.field)||t.percentage>0&&(e.cell.style.backgroundColor="#FFFF66")},s.onFilteringBuilding=function(e){var t=new z.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(s.buildings,t)},s.buildingID=+localStorage.getItem("buildingID"),s}return o(r,[{key:"dataBound",value:function(){}},{key:"ngOnInit",value:function(){var e=this;this.Permission(this.route),this.role=nt,this.startDate=new Date,this.endDate=new Date,this.level=JSON.parse(localStorage.getItem("level")).level,this.gridConfig(),this.getBuilding(0===this.buildingID?function(){e.alertify.message("Please select a building!",!0)}:function(){e.consumptionByLineCase3()})}},{key:"Permission",value:function(n){var i=n.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var a,r=t(this.functions);try{for(r.s();!(a=r.n()).done;){var o,l=a.value,c=[],u=t(l.childrens);try{for(u.s();!(o=u.n()).done;){var s=o.value,d=this.makeAction(s.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(h){u.e(h)}finally{u.f()}c.push("Search");var g=c.filter(function(e,t,n){return t===n.indexOf(e)});this.toolbarOptions=g}}catch(h){r.e(h)}finally{r.f()}}},{key:"makeAction",value:function(e){switch(e){case j.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}},{key:"gridConfig",value:function(){this.pageSettings={pageCount:20,pageSizes:["All",100],pageSize:100}}},{key:"onChangeBuilding",value:function(e){this.buildingID=e.itemData.id,localStorage.setItem("buildingID",e.itemData.id),this.consumptionByLineCase3()}},{key:"getBuilding",value:function(e){var t=this;this.buildingService.getBuildings().subscribe(function(n){return Object(V.a)(t,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.buildings=n.filter(function(e){return 2===e.level}),e();case 1:case"end":return t.stop()}},t,this)}))})}},{key:"consumptionByLineCase3",value:function(){var e=this;this.planService.consumptionByLineCase3(this.buildingID,this.startDate,this.endDate).subscribe(function(t){e.data=t})}},{key:"startDateOnchange",value:function(e){e.isInteracted&&(this.startDate=e.value,this.consumptionByLineCase3())}},{key:"endDateOnchange",value:function(e){e.isInteracted&&(this.endDate=e.value,this.consumptionByLineCase3())}},{key:"onClickDefault",value:function(){this.startDate=new Date,this.endDate=new Date,this.consumptionByLineCase3()}},{key:"toolbarClick",value:function(e){switch(e.item.id){case"grid_excelexport":this.reportConsumptionCase3()}}},{key:"tooltip",value:function(e){return e?e.join("<br>"):""}},{key:"reportConsumptionCase3",value:function(){var e=this;Math.floor((this.endDate.getTime()-this.startDate.getTime())/864e5)>31?this.alertify.error("Ch\u1ec9 \u0111\u01b0\u1ee3c xu\u1ea5t d\u1eef li\u1ec7u b\xe1o c\xe1o trong 30 ng\xe0y!!!<br>The report data can only be exported for 30 days!!!",!0):(this.spinner.show(),this.planService.reportConsumptionCase3(this.buildingID,this.startDate,this.endDate).subscribe(function(t){new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n;var a=e.datePipe.transform(e.startDate,"YYYYMMdd"),r=e.datePipe.transform(e.endDate,"YYYYMMdd");i.download="".concat(a,"-").concat(r,"_Consumption3.xlsx"),i.click(),e.spinner.hide()}))}}]),r}(O.a),Ze.\u0275fac=function(e){return new(e||Ze)(F.Pb(q.a),F.Pb(p.b),F.Pb(fe.a),F.Pb(s.e),F.Pb(g.c),F.Pb(H.a),F.Pb(M.a))},Ze.\u0275cmp=F.Jb({type:Ze,selectors:[["app-consumption-3"]],viewQuery:function(e,t){var n;1&e&&(F.Rc(He,1),F.Rc(We,1),F.Rc($e,1)),2&e&&(F.Ac(n=F.gc())&&(t.cloneModal=n.first),F.Ac(n=F.gc())&&(t.orderForm=n.first),F.Ac(n=F.gc())&&(t.grid=n.first))},features:[F.zb],decls:37,vars:17,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"row","pt-2"],[1,"col-md-12"],[1,"card"],[1,"card-body","p-0"],[1,"row","my-3"],[1,"row"],[1,"col-md-1"],[1,"font-weight-bold"],[1,"col-md-3"],[3,"value","ngModel","change","ngModelChange"],[1,"col-md-2"],["placeholder","Select a building",3,"dataSource","fields","allowFiltering","value","filtering","change"],["modelNameDropdownlist",""],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fa","fa-times"],["id","grid","showColumnMenu","true","allowPaging","true","allowResizing","true","gridLines","Both",3,"dataSource","searchSettings","allowExcelExport","toolbar","pageSettings","dataBound","queryCellInfo","toolbarClick"],["grid",""],["field","line","headerText","Line","width","80","textAlign","Center"],["field","modelName","headerText","ModelName","width","120","textAlign","Center"],["field","modelNo","headerText","ModelNo","width","100","textAlign","Center"],["field","articleNo","headerText","ArticleNo","width","100","textAlign","Center"],["field","process","headerText","Process","width","100","textAlign","Center"],["field","glue","headerText","Glue","width","150","textAlign","Center"],["field","std","headerText","Qty (g)","width","100","textAlign","Center"],["field","dueDate","headerText","Addition Date","type","date","format","dd/MM/yyyy","width","100","textAlign","Center"],["template",""]],template:function(e,t){1&e&&(F.Vb(0,"ngx-spinner",0),F.Vb(1,"p",1),F.Lc(2,"Loading data..."),F.Ub(),F.Ub(),F.Vb(3,"div",2),F.Vb(4,"div",3),F.Vb(5,"div",4),F.Vb(6,"div",5),F.Vb(7,"div",6),F.Vb(8,"div",3),F.Vb(9,"div",7),F.Vb(10,"div",8),F.Vb(11,"div",9),F.Lc(12),F.kc(13,"translate"),F.Ub(),F.Ub(),F.Vb(14,"div",10),F.Vb(15,"ejs-datepicker",11),F.fc("change",function(e){return t.startDateOnchange(e)})("ngModelChange",function(e){return t.startDate=e}),F.Ub(),F.Ub(),F.Vb(16,"div",10),F.Vb(17,"ejs-datepicker",11),F.fc("change",function(e){return t.endDateOnchange(e)})("ngModelChange",function(e){return t.endDate=e}),F.Ub(),F.Ub(),F.Vb(18,"div",12),F.Vb(19,"ejs-dropdownlist",13,14),F.fc("filtering",function(e){return t.onFilteringBuilding(e)})("change",function(e){return t.onChangeBuilding(e)}),F.Ub(),F.Ub(),F.Vb(21,"div",12),F.Vb(22,"button",15),F.fc("click",function(){return t.onClickDefault()}),F.Qb(23,"i",16),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Vb(24,"ejs-grid",17,18),F.fc("dataBound",function(){return t.dataBound()})("queryCellInfo",function(e){return t.queryCellInfoEvent(e)})("toolbarClick",function(e){return t.toolbarClick(e)}),F.Vb(26,"e-columns"),F.Qb(27,"e-column",19),F.Qb(28,"e-column",20),F.Qb(29,"e-column",21),F.Qb(30,"e-column",22),F.Qb(31,"e-column",23),F.Qb(32,"e-column",24),F.Qb(33,"e-column",25),F.Vb(34,"e-column",26),F.Jc(35,Xe,2,4,"ng-template",null,27,F.Kc),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub(),F.Ub()),2&e&&(F.pc("fullScreen",!1),F.Cb(12),F.Nc("",F.lc(13,15,"FILTER_LABEL"),":"),F.Cb(3),F.pc("value",t.startDate)("ngModel",t.startDate),F.Cb(2),F.pc("value",t.endDate)("ngModel",t.endDate),F.Cb(2),F.pc("dataSource",t.buildings)("fields",t.fieldsBuildings)("allowFiltering",!0)("value",t.buildingID),F.Cb(5),F.pc("dataSource",t.data)("searchSettings",t.searchSettings)("allowExcelExport",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings))},directives:[g.a,y.a,d.f,d.i,f.c,U.j,m.d,A.d,A.b,U.e,U.b,m.c,A.c,A.a,U.d,U.a],pipes:[w.c,s.e],styles:[""]}),Ze),data:{title:"Consumption 3",breadcrumb:"Consumption 3",functionCode:"Consumption 3"},canActivate:[T.a]},{path:"delivered-history",component:G,data:{title:"Delivered History",breadcrumb:"Delivered History",functionCode:"Delivered History"},canActivate:[T.a]},{path:"inventory",component:he,data:{title:"Inventory",breadcrumb:"Inventory",functionCode:"Inventory"},canActivate:[T.a]}]}],at=((tt=function e(){a(this,e)}).\u0275fac=function(e){return new(e||tt)},tt.\u0275mod=F.Nb({type:tt}),tt.\u0275inj=F.Mb({imports:[[M.g.forChild(it)],M.g]}),tt);function rt(e){return new k.a(e,"./assets/i18n/",".json")}var ot=localStorage.getItem("lang");Object(I.bb)(r("2PVe"),r("GFvd"),r("GFWS"),r("0zpJ"),r("LRxf")),Object(I.bb)(r("2PVe"),r("oP7I"),r("Joj5"),r("3JeS"),r("LRxf")),et="vi"===ot?ot:"en";var lt,ct=((lt=function e(){a(this,e),"vi"===ot?(et="vi",setTimeout(function(){I.p.load(r("+7Wi")),Object(I.nb)("vi")})):(et="en",setTimeout(function(){I.p.load(r("7j5C")),Object(I.nb)("en")}))}).\u0275fac=function(e){return new(e||lt)},lt.\u0275mod=F.Nb({type:lt}),lt.\u0275inj=F.Mb({providers:[s.e],imports:[[L.b,v.c,s.c,d.b,d.l,g.b,at,h.a,f.d,p.c,m.b,m.a,m.e,b.a,b.c,b.b,v.l,D.a,y.b,A.h,U.i,v.i,S.d,N.b,x.a,y.d,E.a,B.e,v.f,f.g,c.a,w.b.forChild({loader:{provide:w.a,useFactory:rt,deps:[C.b]},defaultLanguage:et})]]}),lt)},dQqK:function(n,i,r){"use strict";r.d(i,"a",function(){return c});var l=r("iStF"),c=function(){function n(){a(this,n),this.editSettingsTree={allowEditing:!1,allowAdding:!1,allowDeleting:!1,newRowPosition:"Child",mode:"Row"},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=["ExcelExport","Add","Edit","Delete","Cancel","Search"],this.toolbarOptionsTree=["Add","Delete","Search","ExpandAll","CollapseAll","ExcelExport"],this.contextMenuItems=[{text:"Add Child",iconCss:" e-icons e-add",target:".e-content",id:"Add-Sub-Item"},{text:"Delete",iconCss:" e-icons e-delete",target:".e-content",id:"DeleteOC"}]}return o(n,[{key:"Permission",value:function(n){var i=n.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(function(e){return e.functionCode===i})||[];var a,r=t(this.functions);try{for(r.s();!(a=r.n()).done;){var o,l=a.value,c=[],u=t(l.childrens);try{for(u.s();!(o=u.n()).done;){var s=o.value,d=this.makeAction(s.code);c.push.apply(c,e(d.filter(Boolean)))}}catch(h){u.e(h)}finally{u.f()}c.push("Search");var g=c.filter(function(e,t,n){return t===n.indexOf(e)});this.toolbarOptions=g}}catch(h){r.e(h)}finally{r.f()}}},{key:"PermissionForTreeGrid",value:function(n){this.contextMenuItems=[],this.functions=JSON.parse(localStorage.getItem("functions"));var i,a=t(this.functions);try{for(a.s();!(i=a.n()).done;){var r=i.value;if(n.snapshot.data.functionCode.includes(r.functionCode)){var o,l=[],c=t(r.childrens);try{for(c.s();!(o=c.n()).done;){var u=o.value,s=this.makeActionTreeGrid(u.code);l.push.apply(l,e(s.filter(Boolean)))}}catch(g){c.e(g)}finally{c.f()}l.push("Search","ExpandAll","CollapseAll","ExcelExport");var d=l.filter(function(e,t,n){return t===n.indexOf(e)});this.toolbarOptionsTree=d;break}}}catch(g){a.e(g)}finally{a.f()}}},{key:"makeAction",value:function(e){switch(e){case l.a.CREATE:return this.editSettings.allowAdding=!0,["Add","Cancel"];case l.a.EDIT:return this.editSettings.allowEditing=!0,["Edit","Update","Cancel"];case l.a.DELETE:return this.editSettings.allowDeleting=!0,["Delete"];case l.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}},{key:"makeActionTreeGrid",value:function(e){switch(e){case l.a.EXCEL_EXPORT:return["ExcelExport"];case l.a.CREATE:return this.editSettingsTree.allowAdding=!0,this.contextMenuItems.push({text:"Add Child",iconCss:" e-icons e-add",target:".e-content",id:"Add-Sub-Item"}),["Add"];case l.a.EDIT:return this.editSettingsTree.allowEditing=!0,[void 0];case l.a.DELETE:return this.editSettingsTree.allowDeleting=!0,this.contextMenuItems.push({text:"Delete",iconCss:" e-icons e-delete",target:".e-content",id:"DeleteOC"}),[void 0];default:return[void 0]}}}]),n}()},"h9f+":function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("2Vo4"),r=n("lJxs"),l=n("IheW"),c=n("AytR"),u=n("2zK7"),s=n("8Y7J");new l.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});var d=function(){var e=function(){function e(t){a(this,e),this.http=t,this.baseUrl=c.a.apiUrlEC,this.authUrl=c.a.apiUrl,this.messageSource=new i.a(0),this.currentMessage=this.messageSource.asObservable()}return o(e,[{key:"changeMessage",value:function(e){this.messageSource.next(e)}},{key:"getBuildingsAsTreeView",value:function(){return this.http.get("".concat(this.baseUrl,"Building/GetAllAsTreeView"))}},{key:"mappingUserWithBuilding",value:function(e){return this.http.post("".concat(this.baseUrl,"BuildingUser/MappingUserWithBuilding"),e)}},{key:"removeBuildingUser",value:function(e){return this.http.post("".concat(this.baseUrl,"BuildingUser/RemoveBuildingUser"),e)}},{key:"getAllUsers",value:function(e,t){var n=new u.a;return this.http.get("".concat(this.authUrl,"Users/GetAllUsers/").concat(c.a.systemCode,"/").concat(e,"/").concat(t),{observe:"response"}).pipe(Object(r.a)(function(e){return n.result=e.body,null!=e.headers.get("Pagination")&&(n.pagination=JSON.parse(e.headers.get("Pagination"))),n}))}},{key:"deleteUser",value:function(e){return this.http.delete("".concat(this.authUrl,"Users/Delete/").concat(e))}},{key:"updateUser",value:function(e){return this.http.post("".concat(this.authUrl,"Users/Update"),e)}},{key:"createUser",value:function(e){return this.http.post("".concat(this.authUrl,"Users/Create"),e)}},{key:"getAllBuildingUsers",value:function(){return this.http.get("".concat(this.baseUrl,"BuildingUser/getAllBuildingUsers"))}},{key:"getBuildingUserByBuildingID",value:function(e){return this.http.get("".concat(this.baseUrl,"BuildingUser/GetBuildingUserByBuildingID/").concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.cc(l.b))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},vrRs:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("IheW"),r=n("2Vo4"),l=n("lJxs"),c=n("AytR"),u=n("2zK7"),s=n("8Y7J");new i.e({"Content-Type":"application/json"});var d=function(){var e=function(){function e(t){a(this,e),this.http=t,this.baseUrl=c.a.apiUrlEC,this.ingredientSource=new r.a(0),this.currentIngredient=this.ingredientSource.asObservable()}return o(e,[{key:"getIngredients",value:function(e,t){var n=new u.a,a=new i.f;return null!=e&&null!=t&&(a=(a=a.append("pageNumber",e)).append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/getingredients",{observe:"response",params:a}).pipe(Object(l.a)(function(e){return n.result=e.body,null!=e.headers.get("Pagination")&&(n.pagination=JSON.parse(e.headers.get("Pagination"))),n}))}},{key:"search",value:function(e,t,n){var a=new u.a,r=new i.f;return null!=e&&null!=t&&(r=(r=r.append("pageNumber",e)).append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/Search/"+n,{observe:"response",params:r}).pipe(Object(l.a)(function(e){return a.result=e.body,null!=e.headers.get("Pagination")&&(a.pagination=JSON.parse(e.headers.get("Pagination"))),a}))}},{key:"getAllIngredient",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAll",{})}},{key:"rate",value:function(){return this.http.get(this.baseUrl+"ingredient/Rate",{})}},{key:"getAllGlueType",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAllGlueType",{})}},{key:"getByID",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/"+e,{})}},{key:"scanQRCode",value:function(e){return this.http.get(this.baseUrl+"ingredient/ScanQRCode/"+e,{})}},{key:"scanQRCodeFromChemicalWareHouse",value:function(e,t,n){return this.http.get("".concat(this.baseUrl,"ingredient/ScanQRCodeFromChemialWareHouse/").concat(e,"/").concat(t,"/").concat(n),{})}},{key:"scanQRCodeOutput",value:function(e,t,n){return this.http.get("".concat(this.baseUrl,"ingredient/ScanQRCodeOutput/").concat(e,"/").concat(t,"/").concat(n),{})}},{key:"getAllSupplier",value:function(){return this.http.get(this.baseUrl+"Suppier/GetAll",{})}},{key:"getAllIngredientInfo",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfo",{})}},{key:"getAllIngredientInfoOutput",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutPut",{})}},{key:"getAllIngredientInfoByBuildingName",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoByBuildingName/".concat(e),{})}},{key:"getAllIngredientInfoReport",value:function(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReport",{})}},{key:"getAllIngredientInfoReportByBuildingName",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReportByBuildingName/".concat(e),{})}},{key:"searchInventory",value:function(e,t){return this.http.get("".concat(this.baseUrl,"ingredient/Search/").concat(e,"/").concat(t),{})}},{key:"searchInventoryByBuildingName",value:function(e,t,n){return this.http.get("".concat(this.baseUrl,"ingredient/SearchWithBuildingName/").concat(e,"/").concat(t,"/").concat(n),{})}},{key:"deleteIngredientInfo",value:function(e,t,n,i){return this.http.delete(this.baseUrl+"ingredient/DeleteIngredientInfo/".concat(e,"/").concat(t,"/").concat(n,"/").concat(i))}},{key:"UpdateConsumption",value:function(e,t,n){return this.http.post(this.baseUrl+"ingredient/UpdateConsumptionIngredientReport/".concat(e,"/").concat(t,"/").concat(n),{})}},{key:"UpdateConsumptionOfBuilding",value:function(e){return this.http.post(this.baseUrl+"ingredient/UpdateConsumptionOfBuildingIngredientReport",e)}},{key:"createSub",value:function(e){return this.http.post(this.baseUrl+"suppier/create",e)}},{key:"updateSub",value:function(e){return this.http.put(this.baseUrl+"suppier/update",e)}},{key:"deleteSub",value:function(e){return this.http.delete(this.baseUrl+"suppier/delete/"+e)}},{key:"sortBySup",value:function(e,t){return this.http.get(this.baseUrl+"GlueIngredient/GetIngredientsByGlueID/".concat(e,"/").concat(t))}},{key:"getIngredientsByGlueID",value:function(e){return this.http.get(this.baseUrl+"GlueIngredient/GetIngredientsByGlueID/".concat(e))}},{key:"create",value:function(e){return this.http.post(this.baseUrl+"ingredient/create1",e)}},{key:"update",value:function(e){return this.http.put(this.baseUrl+"ingredient/update",e)}},{key:"delete",value:function(e){return this.http.delete(this.baseUrl+"ingredient/delete/"+e)}},{key:"changeIngredient",value:function(e){this.ingredientSource.next(e)}},{key:"import",value:function(e,t){var n=new FormData;return n.append("UploadedFile",e),n.append("CreatedBy",t),this.http.post(this.baseUrl+"ingredient/Import",n)}},{key:"downloadFile",value:function(){return this.http.post(this.baseUrl+"ingredient/ExcelExport",{})}},{key:"GetQrcodeByid",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/".concat(e))}},{key:"UpdatePrint",value:function(e){return this.http.put(this.baseUrl+"ingredient/UpdatePrint",e)}},{key:"checkIncoming",value:function(e,t,n){return this.http.get("".concat(this.baseUrl,"ingredient/CheckIncoming/").concat(e,"/").concat(t,"/").concat(n),{})}},{key:"getAllIngredientInfoByBuilding",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoByBuilding/".concat(e),{})}},{key:"getAllIngredientInfoOutputByBuilding",value:function(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutputByBuilding/".concat(e),{})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.cc(i.b))},e.\u0275prov=s.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},wsp1:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("2Vo4"),r=n("IheW"),l=n("AytR"),c=n("8Y7J");new r.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});var u=function(){var e=function(){function e(t){a(this,e),this.http=t,this.baseUrl=l.a.apiUrlEC,this.messageSource=new i.a(0),this.currentMessage=this.messageSource.asObservable()}return o(e,[{key:"changeMessage",value:function(e){this.messageSource.next(e)}},{key:"delete",value:function(e){return this.http.delete("".concat(this.baseUrl,"Building/Delete/").concat(e))}},{key:"rename",value:function(e){return this.http.put("".concat(this.baseUrl,"Building/Update"),e)}},{key:"getBuildingsAsTreeView",value:function(){return this.http.get("".concat(this.baseUrl,"Building/GetAllAsTreeView"))}},{key:"getBuildings",value:function(){return this.http.get("".concat(this.baseUrl,"Building/GetBuildings"))}},{key:"getAllBuildingType",value:function(){return this.http.get("".concat(this.baseUrl,"Building/getAllBuildingType"))}},{key:"getBuildingsForSetting",value:function(){return this.http.get("".concat(this.baseUrl,"Building/GetBuildingsForSetting"))}},{key:"addOrUpdateLunchTime",value:function(e){return this.http.post("".concat(this.baseUrl,"Building/AddOrUpdateLunchTime"),e)}},{key:"createMainBuilding",value:function(e){return this.http.post("".concat(this.baseUrl,"Building/CreateMainBuilding"),e)}},{key:"createSubBuilding",value:function(e){return this.http.post("".concat(this.baseUrl,"Building/CreateSubBuilding"),e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(c.cc(r.b))},e.\u0275prov=c.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()}}])}();